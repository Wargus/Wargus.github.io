<!DOCTYPE html>
        <html>
        <head>
        <title>TOC</title>
		<link rel="stylesheet" href="css/lua_bindings.css">
        </head>
        <body>
        <hr>/pathfinder/script_pathfinder.cpp<hr>
                        <details>
                        <summary>AStar</summary>
                        <p><br>  Enable a*.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/pathfinder/script_pathfinder.cpp:101 CclAStar</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclAStar</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">value</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">j</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">args</span><span class="p">;</span>

	<span class="n">args</span> <span class="o">=</span> <span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">args</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;fixed-unit-cost&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="o">++</span><span class="n">j</span><span class="p">;</span>
			<span class="n">i</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">PrintFunction</span><span class="p">();</span>
				<span class="n">fprintf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="s">&quot;Fixed unit crossing cost must be strictly &gt; 3</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="n">AStarFixedUnitCrossingCost</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;moving-unit-cost&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="o">++</span><span class="n">j</span><span class="p">;</span>
			<span class="n">i</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">PrintFunction</span><span class="p">();</span>
				<span class="n">fprintf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="s">&quot;Moving unit crossing cost must be strictly &gt; 3</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="n">AStarMovingUnitCrossingCost</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;know-unseen-terrain&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">AStarKnowUnseenTerrain</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;dont-know-unseen-terrain&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">AStarKnowUnseenTerrain</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;unseen-terrain-cost&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="o">++</span><span class="n">j</span><span class="p">;</span>
			<span class="n">i</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">PrintFunction</span><span class="p">();</span>
				<span class="n">fprintf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="s">&quot;Unseen Terrain Cost must be non-negative</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="n">AStarUnknownTerrainCost</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Unsupported tag: %s&quot;</span> <span class="n">_C_</span> <span class="n">value</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        <hr>/missile/script_missile.cpp<hr>
                        <details>
                        <summary>DefineMissileType</summary>
                        <p><br>  Parse missile-type.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/missile/script_missile.cpp:234 CclDefineMissileType</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclDefineMissileType</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="c1">// Slot identifier</span>
	<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">str</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">MissileType</span> <span class="o">*</span><span class="n">mtype</span> <span class="o">=</span> <span class="n">MissileTypeByIdent</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">mtype</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">DebugPrint</span><span class="p">(</span><span class="s">&quot;Redefining missile-type &#39;%s&#39;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="n">_C_</span> <span class="n">str</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">mtype</span> <span class="o">=</span> <span class="n">NewMissileTypeSlot</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">mtype</span><span class="o">-&gt;</span><span class="n">Load</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>Missile</summary>
                        <p><br>  Create a missile.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/missile/script_missile.cpp:332 CclMissile</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclMissile</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">MissileType</span> <span class="o">*</span><span class="n">type</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
	<span class="n">PixelPos</span> <span class="nf">position</span><span class="p">(</span><span class="mi">-1</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
	<span class="n">PixelPos</span> <span class="nf">destination</span><span class="p">(</span><span class="mi">-1</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
	<span class="n">PixelPos</span> <span class="nf">source</span><span class="p">(</span><span class="mi">-1</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
	<span class="n">Missile</span> <span class="o">*</span><span class="n">missile</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>

	<span class="n">DebugPrint</span><span class="p">(</span><span class="s">&quot;FIXME: not finished</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>

	<span class="k">const</span> <span class="kt">int</span> <span class="n">args</span> <span class="o">=</span> <span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">args</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="o">++</span><span class="n">j</span><span class="p">;</span>

		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;type&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">type</span> <span class="o">=</span> <span class="n">MissileTypeByIdent</span><span class="p">(</span><span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">));</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;pos&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">CclGetPos</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">position</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">position</span><span class="p">.</span><span class="n">y</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;origin-pos&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">CclGetPos</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">source</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">source</span><span class="p">.</span><span class="n">y</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;goal&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">CclGetPos</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">destination</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">destination</span><span class="p">.</span><span class="n">y</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;local&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">Assert</span><span class="p">(</span><span class="n">type</span><span class="p">);</span>
			<span class="n">missile</span> <span class="o">=</span> <span class="n">MakeLocalMissile</span><span class="p">(</span><span class="o">*</span><span class="n">type</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">destination</span><span class="p">);</span>
			<span class="n">missile</span><span class="o">-&gt;</span><span class="n">Local</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="o">--</span><span class="n">j</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;global&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">Assert</span><span class="p">(</span><span class="n">type</span><span class="p">);</span>
			<span class="n">missile</span> <span class="o">=</span> <span class="n">MakeMissile</span><span class="p">(</span><span class="o">*</span><span class="n">type</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">destination</span><span class="p">);</span>
			<span class="n">missile</span><span class="o">-&gt;</span><span class="n">position</span> <span class="o">=</span> <span class="n">position</span><span class="p">;</span>
			<span class="n">missile</span><span class="o">-&gt;</span><span class="n">source</span> <span class="o">=</span> <span class="n">source</span><span class="p">;</span>
			<span class="n">missile</span><span class="o">-&gt;</span><span class="n">destination</span> <span class="o">=</span> <span class="n">destination</span><span class="p">;</span>
			<span class="n">missile</span><span class="o">-&gt;</span><span class="n">Local</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="o">--</span><span class="n">j</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;frame&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">Assert</span><span class="p">(</span><span class="n">missile</span><span class="p">);</span>
			<span class="n">missile</span><span class="o">-&gt;</span><span class="n">SpriteFrame</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;state&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">Assert</span><span class="p">(</span><span class="n">missile</span><span class="p">);</span>
			<span class="n">missile</span><span class="o">-&gt;</span><span class="n">State</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;anim-wait&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">Assert</span><span class="p">(</span><span class="n">missile</span><span class="p">);</span>
			<span class="n">missile</span><span class="o">-&gt;</span><span class="n">AnimWait</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;wait&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">Assert</span><span class="p">(</span><span class="n">missile</span><span class="p">);</span>
			<span class="n">missile</span><span class="o">-&gt;</span><span class="n">Wait</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;delay&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">Assert</span><span class="p">(</span><span class="n">missile</span><span class="p">);</span>
			<span class="n">missile</span><span class="o">-&gt;</span><span class="n">Delay</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;source&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">Assert</span><span class="p">(</span><span class="n">missile</span><span class="p">);</span>
			<span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="n">missile</span><span class="o">-&gt;</span><span class="n">SourceUnit</span> <span class="o">=</span> <span class="n">CclGetUnitFromRef</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
			<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;target&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">Assert</span><span class="p">(</span><span class="n">missile</span><span class="p">);</span>
			<span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="n">missile</span><span class="o">-&gt;</span><span class="n">TargetUnit</span> <span class="o">=</span> <span class="n">CclGetUnitFromRef</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
			<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;damage&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">Assert</span><span class="p">(</span><span class="n">missile</span><span class="p">);</span>
			<span class="n">missile</span><span class="o">-&gt;</span><span class="n">Damage</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;ttl&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">Assert</span><span class="p">(</span><span class="n">missile</span><span class="p">);</span>
			<span class="n">missile</span><span class="o">-&gt;</span><span class="n">TTL</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;hidden&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">Assert</span><span class="p">(</span><span class="n">missile</span><span class="p">);</span>
			<span class="n">missile</span><span class="o">-&gt;</span><span class="n">Hidden</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="o">--</span><span class="n">j</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;step&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">Assert</span><span class="p">(</span><span class="n">missile</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">||</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="n">missile</span><span class="o">-&gt;</span><span class="n">CurrentStep</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
			<span class="n">missile</span><span class="o">-&gt;</span><span class="n">TotalStep</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Unsupported tag: %s&quot;</span> <span class="n">_C_</span> <span class="n">value</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="c1">// we need to reinitialize position parameters - that&#39;s because of</span>
	<span class="c1">// the way InitMissile() (called from MakeLocalMissile()) computes</span>
	<span class="c1">// them - it works for creating a missile during a game but breaks</span>
	<span class="c1">// loading the missile from a file.</span>
	<span class="n">missile</span><span class="o">-&gt;</span><span class="n">position</span> <span class="o">=</span> <span class="n">position</span><span class="p">;</span>
	<span class="n">missile</span><span class="o">-&gt;</span><span class="n">source</span> <span class="o">=</span> <span class="n">source</span><span class="p">;</span>
	<span class="n">missile</span><span class="o">-&gt;</span><span class="n">destination</span> <span class="o">=</span> <span class="n">destination</span><span class="p">;</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>DefineBurningBuilding</summary>
                        <p><br>  Define burning building missiles.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/missile/script_missile.cpp:368 CclDefineBurningBuilding</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclDefineBurningBuilding</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">BurningBuildingFrame</span> <span class="o">*&gt;::</span><span class="n">iterator</span> <span class="n">i</span> <span class="o">=</span> <span class="n">BurningBuildingFrames</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span>
		 <span class="n">i</span> <span class="o">!=</span> <span class="n">BurningBuildingFrames</span><span class="p">.</span><span class="n">end</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">delete</span> <span class="o">*</span><span class="n">i</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">BurningBuildingFrames</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>

	<span class="k">const</span> <span class="kt">int</span> <span class="n">args</span> <span class="o">=</span> <span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">args</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="n">BurningBuildingFrame</span> <span class="o">*</span><span class="n">ptr</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BurningBuildingFrame</span><span class="p">;</span>
		<span class="k">const</span> <span class="kt">int</span> <span class="n">subargs</span> <span class="o">=</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>

		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">subargs</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="o">++</span><span class="n">k</span><span class="p">;</span>

			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;percent&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">ptr</span><span class="o">-&gt;</span><span class="n">Percent</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;missile&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">ptr</span><span class="o">-&gt;</span><span class="n">Missile</span> <span class="o">=</span> <span class="n">MissileTypeByIdent</span><span class="p">(</span><span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">));</span>
			<span class="p">}</span>
		<span class="p">}</span>
		<span class="n">BurningBuildingFrames</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">BurningBuildingFrames</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">ptr</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>CreateMissile</summary>
                        <p><br>  Create a missile on the map<br><br>  @param l  Lua state.<br></p>
                          <details>
                          <summary>/missile/script_missile.cpp:417 CclCreateMissile</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclCreateMissile</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">arg</span> <span class="o">=</span> <span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">arg</span> <span class="o">&lt;</span> <span class="mi">6</span> <span class="o">||</span> <span class="n">arg</span> <span class="o">&gt;</span> <span class="mi">7</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">name</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">const</span> <span class="n">MissileType</span> <span class="o">*</span><span class="n">mtype</span> <span class="o">=</span> <span class="n">MissileTypeByIdent</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">mtype</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Bad missile&quot;</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">PixelPos</span> <span class="n">startpos</span><span class="p">,</span> <span class="n">endpos</span><span class="p">;</span>
	<span class="n">CclGetPos</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">startpos</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">startpos</span><span class="p">.</span><span class="n">y</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="n">CclGetPos</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">endpos</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">endpos</span><span class="p">.</span><span class="n">y</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>

	<span class="k">const</span> <span class="kt">int</span> <span class="n">sourceUnitId</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">destUnitId</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>
	<span class="k">const</span> <span class="kt">bool</span> <span class="n">dealDamage</span> <span class="o">=</span> <span class="n">LuaToBoolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">6</span><span class="p">);</span>
	<span class="k">const</span> <span class="kt">bool</span> <span class="n">mapRelative</span> <span class="o">=</span> <span class="n">arg</span> <span class="o">==</span> <span class="mi">7</span> <span class="o">?</span> <span class="n">LuaToBoolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span> <span class="o">:</span> <span class="nb">false</span><span class="p">;</span>
	<span class="n">CUnit</span> <span class="o">*</span><span class="n">sourceUnit</span> <span class="o">=</span> <span class="n">sourceUnitId</span> <span class="o">!=</span> <span class="mi">-1</span> <span class="o">?</span> <span class="o">&amp;</span><span class="n">UnitManager</span><span class="p">.</span><span class="n">GetSlotUnit</span><span class="p">(</span><span class="n">sourceUnitId</span><span class="p">)</span> <span class="o">:</span> <span class="nb">NULL</span><span class="p">;</span>
	<span class="n">CUnit</span> <span class="o">*</span><span class="n">destUnit</span> <span class="o">=</span> <span class="n">destUnitId</span> <span class="o">!=</span> <span class="mi">-1</span> <span class="o">?</span> <span class="o">&amp;</span><span class="n">UnitManager</span><span class="p">.</span><span class="n">GetSlotUnit</span><span class="p">(</span><span class="n">destUnitId</span><span class="p">)</span> <span class="o">:</span> <span class="nb">NULL</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">mapRelative</span> <span class="o">==</span> <span class="nb">false</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">sourceUnit</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">startpos</span> <span class="o">+=</span> <span class="n">sourceUnit</span><span class="o">-&gt;</span><span class="n">GetMapPixelPosTopLeft</span><span class="p">();</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">destUnit</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">endpos</span> <span class="o">+=</span> <span class="n">destUnit</span><span class="o">-&gt;</span><span class="n">GetMapPixelPosTopLeft</span><span class="p">();</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="n">Missile</span> <span class="o">*</span><span class="n">missile</span> <span class="o">=</span> <span class="n">MakeMissile</span><span class="p">(</span><span class="o">*</span><span class="n">mtype</span><span class="p">,</span> <span class="n">startpos</span><span class="p">,</span> <span class="n">endpos</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">missile</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">dealDamage</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">missile</span><span class="o">-&gt;</span><span class="n">SourceUnit</span> <span class="o">=</span> <span class="n">sourceUnit</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">missile</span><span class="o">-&gt;</span><span class="n">TargetUnit</span> <span class="o">=</span> <span class="n">destUnit</span><span class="p">;</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        <hr>/video/shaders.cpp<hr>
                        <details>
                        <summary>GetShaderNames</summary>
                        <p>/video/shaders.cpp:396 CclGetShaderNames</p>
                        <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclGetShaderNames</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="n">lua_newtable</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">shaderNames</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">lua_pushstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">shaderNames</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
		<span class="n">lua_rawseti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-2</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                        </details>
                        
                        <details>
                        <summary>GetShader</summary>
                        <p>/video/shaders.cpp:365 CclGetShader</p>
                        <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclGetShader</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">shaderName</span> <span class="o">=</span> <span class="n">shaderNames</span><span class="p">[</span><span class="n">currentShaderIdx</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">shaderName</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">lua_pushstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">shaderName</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">lua_pushnil</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                        </details>
                        
                        <details>
                        <summary>SetShader</summary>
                        <p>/video/shaders.cpp:386 CclSetShader</p>
                        <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetShader</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">shaderName</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">MAX_SHADERS</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">n</span> <span class="o">=</span> <span class="n">shaderNames</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">shaderName</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">currentShaderIdx</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
				<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;SetShader: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">shaderNames</span><span class="p">[</span><span class="n">currentShaderIdx</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
				<span class="n">lua_pushboolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
				<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="n">currentShaderIdx</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">lua_pushboolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                        </details>
                        <hr>/video/cursor.cpp<hr>
                        <details>
                        <summary>DefineCursor</summary>
                        <p><br>  Define a cursor.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/video/cursor.cpp:423 CclDefineCursor</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclDefineCursor</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">name</span><span class="p">;</span>
	<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">race</span><span class="p">;</span>
	<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">file</span><span class="p">;</span>
	<span class="n">PixelPos</span> <span class="nf">hotpos</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="kt">int</span> <span class="n">w</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">h</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">rate</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">lua_pushnil</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="k">while</span> <span class="p">(</span><span class="n">lua_next</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
		<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-2</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Name&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">name</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Race&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">race</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;File&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">file</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;HotSpot&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">CclGetPos</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">hotpos</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">hotpos</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Size&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">CclGetPos</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">w</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">h</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Rate&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">rate</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Unsupported tag: %s&quot;</span> <span class="n">_C_</span> <span class="n">value</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="n">Assert</span><span class="p">(</span><span class="o">!</span><span class="n">name</span><span class="p">.</span><span class="n">empty</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">file</span><span class="p">.</span><span class="n">empty</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="n">w</span> <span class="o">&amp;&amp;</span> <span class="n">h</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">race</span> <span class="o">==</span> <span class="s">&quot;any&quot;</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">race</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
	<span class="p">}</span>

	<span class="c1">//</span>
	<span class="c1">//  Look if this kind of cursor already exists.</span>
	<span class="c1">//</span>
	<span class="n">CCursor</span> <span class="o">*</span><span class="n">ct</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">AllCursors</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
		<span class="c1">//  Race not same, not found.</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">AllCursors</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">Race</span> <span class="o">!=</span> <span class="n">race</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">continue</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">AllCursors</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">Ident</span> <span class="o">==</span> <span class="n">name</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">ct</span> <span class="o">=</span> <span class="n">AllCursors</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="c1">//</span>
	<span class="c1">//  Not found, make a new slot.</span>
	<span class="c1">//</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">ct</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">ct</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CCursor</span><span class="p">();</span>
		<span class="n">AllCursors</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">ct</span><span class="p">);</span>
		<span class="n">ct</span><span class="o">-&gt;</span><span class="n">Ident</span> <span class="o">=</span> <span class="n">name</span><span class="p">;</span>
		<span class="n">ct</span><span class="o">-&gt;</span><span class="n">Race</span> <span class="o">=</span> <span class="n">race</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">ct</span><span class="o">-&gt;</span><span class="n">G</span> <span class="o">=</span> <span class="n">CGraphic</span><span class="o">::</span><span class="n">New</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">);</span>
	<span class="n">ct</span><span class="o">-&gt;</span><span class="n">HotPos</span> <span class="o">=</span> <span class="n">hotpos</span><span class="p">;</span>
	<span class="n">ct</span><span class="o">-&gt;</span><span class="n">FrameRate</span> <span class="o">=</span> <span class="n">rate</span><span class="p">;</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SetGameCursor</summary>
                        <p><br>  Set the current game cursor.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/video/cursor.cpp:435 CclSetGameCursor</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetGameCursor</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">GameCursor</span> <span class="o">=</span> <span class="n">CursorByIdent</span><span class="p">(</span><span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">));</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        <hr>/video/video.cpp<hr>
                        <details>
                        <summary>SetVideoSyncSpeed</summary>
                        <p><br>  Set the video sync speed<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/video/video.cpp:353 CclSetVideoSyncSpeed</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetVideoSyncSpeed</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">VideoSyncSpeed</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        <hr>/game/trigger.cpp<hr>
                        <details>
                        <summary>AddTrigger</summary>
                        <p><br>  Add a trigger.</p>
                          <details>
                          <summary>/game/trigger.cpp:464 CclAddTrigger</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclAddTrigger</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_isfunction</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
		<span class="o">||</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_isfunction</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="c1">// Make a list of all triggers.</span>
	<span class="c1">// A trigger is a pair of condition and action</span>
	<span class="n">lua_getglobal</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;_triggers_&quot;</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">lua_isnil</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">DebugPrint</span><span class="p">(</span><span class="s">&quot;Trigger not set, defining trigger</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
		<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
		<span class="n">lua_newtable</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
		<span class="n">lua_setglobal</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;_triggers_&quot;</span><span class="p">);</span>
		<span class="n">lua_getglobal</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;_triggers_&quot;</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="k">const</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ActiveTriggers</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">ActiveTriggers</span><span class="p">[</span><span class="n">i</span> <span class="o">/</span> <span class="mi">2</span><span class="p">])</span> <span class="p">{</span>
		<span class="n">lua_pushnil</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
		<span class="n">lua_rawseti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-2</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="n">lua_pushnil</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
		<span class="n">lua_rawseti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-2</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
		<span class="n">lua_rawseti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-2</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="n">lua_newtable</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
		<span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
		<span class="n">lua_rawseti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-2</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
		<span class="n">lua_rawseti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-2</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SetActiveTriggers</summary>
                        <p><br>  Set the active triggers</p>
                          <details>
                          <summary>/game/trigger.cpp:486 CclSetActiveTriggers</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetActiveTriggers</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">args</span> <span class="o">=</span> <span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>

	<span class="n">ActiveTriggers</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">bool</span><span class="p">[</span><span class="n">args</span><span class="p">];</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">args</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">ActiveTriggers</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">LuaToBoolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>GetNumUnitsAt</summary>
                        <p><br>  Return the number of units of a given unit-type and player at a location.</p>
                          <details>
                          <summary>/game/trigger.cpp:196 CclGetNumUnitsAt</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclGetNumUnitsAt</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>

	<span class="kt">int</span> <span class="n">plynr</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="k">const</span> <span class="n">CUnitType</span> <span class="o">*</span><span class="n">unittype</span> <span class="o">=</span> <span class="n">TriggerGetUnitType</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

	<span class="n">Vec2i</span> <span class="n">minPos</span><span class="p">;</span>
	<span class="n">Vec2i</span> <span class="n">maxPos</span><span class="p">;</span>
	<span class="n">CclGetPos</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">minPos</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">minPos</span><span class="p">.</span><span class="n">y</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
	<span class="n">CclGetPos</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">maxPos</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">maxPos</span><span class="p">.</span><span class="n">y</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>

	<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">CUnit</span> <span class="o">*&gt;</span> <span class="n">units</span><span class="p">;</span>

	<span class="n">Select</span><span class="p">(</span><span class="n">minPos</span><span class="p">,</span> <span class="n">maxPos</span><span class="p">,</span> <span class="n">units</span><span class="p">);</span>

	<span class="kt">int</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">units</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">const</span> <span class="n">CUnit</span> <span class="o">&amp;</span><span class="n">unit</span> <span class="o">=</span> <span class="o">*</span><span class="n">units</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
		<span class="c1">// Check unit type</span>

		<span class="k">if</span> <span class="p">(</span><span class="n">unittype</span> <span class="o">==</span> <span class="n">ANY_UNIT</span>
			<span class="o">||</span> <span class="p">(</span><span class="n">unittype</span> <span class="o">==</span> <span class="n">ALL_FOODUNITS</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">unit</span><span class="p">.</span><span class="n">Type</span><span class="o">-&gt;</span><span class="n">Building</span><span class="p">)</span>
			<span class="o">||</span> <span class="p">(</span><span class="n">unittype</span> <span class="o">==</span> <span class="n">ALL_BUILDINGS</span> <span class="o">&amp;&amp;</span> <span class="n">unit</span><span class="p">.</span><span class="n">Type</span><span class="o">-&gt;</span><span class="n">Building</span><span class="p">)</span>
			<span class="o">||</span> <span class="p">(</span><span class="n">unittype</span> <span class="o">==</span> <span class="n">unit</span><span class="p">.</span><span class="n">Type</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">unit</span><span class="p">.</span><span class="n">Constructed</span><span class="p">))</span> <span class="p">{</span>

			<span class="c1">// Check the player</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">plynr</span> <span class="o">==</span> <span class="mi">-1</span> <span class="o">||</span> <span class="n">plynr</span> <span class="o">==</span> <span class="n">unit</span><span class="p">.</span><span class="n">Player</span><span class="o">-&gt;</span><span class="n">Index</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">unit</span><span class="p">.</span><span class="n">IsAlive</span><span class="p">())</span> <span class="p">{</span>
					<span class="o">++</span><span class="n">s</span><span class="p">;</span>
				<span class="p">}</span>
			<span class="p">}</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">s</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>IfNearUnit</summary>
                        <p><br>  Player has the quantity of unit-type near to unit-type.</p>
                          <details>
                          <summary>/game/trigger.cpp:258 CclIfNearUnit</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclIfNearUnit</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>
	<span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">plynr</span> <span class="o">=</span> <span class="n">TriggerGetPlayer</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">op</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">q</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
	<span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
	<span class="k">const</span> <span class="n">CUnitType</span> <span class="o">*</span><span class="n">unittype</span> <span class="o">=</span> <span class="n">TriggerGetUnitType</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">const</span> <span class="n">CUnitType</span> <span class="o">*</span><span class="n">ut2</span> <span class="o">=</span> <span class="n">CclGetUnitType</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">unittype</span> <span class="o">||</span> <span class="o">!</span><span class="n">ut2</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;CclIfNearUnit: not a unit-type valid&quot;</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">CompareFunction</span> <span class="n">compare</span> <span class="o">=</span> <span class="n">GetCompareFunction</span><span class="p">(</span><span class="n">op</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">compare</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Illegal comparison operation in if-near-unit: %s&quot;</span> <span class="n">_C_</span> <span class="n">op</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="c1">//</span>
	<span class="c1">// Get all unit types &#39;near&#39;.</span>
	<span class="c1">//</span>

	<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">CUnit</span> <span class="o">*&gt;</span> <span class="n">unitsOfType</span><span class="p">;</span>

	<span class="n">FindUnitsByType</span><span class="p">(</span><span class="o">*</span><span class="n">ut2</span><span class="p">,</span> <span class="n">unitsOfType</span><span class="p">);</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">unitsOfType</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">const</span> <span class="n">CUnit</span> <span class="o">&amp;</span><span class="n">centerUnit</span> <span class="o">=</span> <span class="o">*</span><span class="n">unitsOfType</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>

		<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">CUnit</span> <span class="o">*&gt;</span> <span class="n">around</span><span class="p">;</span>
		<span class="n">SelectAroundUnit</span><span class="p">(</span><span class="n">centerUnit</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">around</span><span class="p">);</span>

		<span class="c1">// Count the requested units</span>
		<span class="kt">int</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">around</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">const</span> <span class="n">CUnit</span> <span class="o">&amp;</span><span class="n">unit</span> <span class="o">=</span> <span class="o">*</span><span class="n">around</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>

			<span class="c1">// Check unit type</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">unittype</span> <span class="o">==</span> <span class="n">ANY_UNIT</span>
				<span class="o">||</span> <span class="p">(</span><span class="n">unittype</span> <span class="o">==</span> <span class="n">ALL_FOODUNITS</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">unit</span><span class="p">.</span><span class="n">Type</span><span class="o">-&gt;</span><span class="n">Building</span><span class="p">)</span>
				<span class="o">||</span> <span class="p">(</span><span class="n">unittype</span> <span class="o">==</span> <span class="n">ALL_BUILDINGS</span> <span class="o">&amp;&amp;</span> <span class="n">unit</span><span class="p">.</span><span class="n">Type</span><span class="o">-&gt;</span><span class="n">Building</span><span class="p">)</span>
				<span class="o">||</span> <span class="p">(</span><span class="n">unittype</span> <span class="o">==</span> <span class="n">unit</span><span class="p">.</span><span class="n">Type</span><span class="p">))</span> <span class="p">{</span>

				<span class="c1">// Check the player</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">plynr</span> <span class="o">==</span> <span class="mi">-1</span> <span class="o">||</span> <span class="n">plynr</span> <span class="o">==</span> <span class="n">unit</span><span class="p">.</span><span class="n">Player</span><span class="o">-&gt;</span><span class="n">Index</span><span class="p">)</span> <span class="p">{</span>
					<span class="o">++</span><span class="n">s</span><span class="p">;</span>
				<span class="p">}</span>
			<span class="p">}</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">compare</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">q</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">lua_pushboolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
			<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="n">lua_pushboolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>IfRescuedNearUnit</summary>
                        <p><br>  Player has the quantity of rescued unit-type near to unit-type.</p>
                          <details>
                          <summary>/game/trigger.cpp:320 CclIfRescuedNearUnit</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclIfRescuedNearUnit</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>

	<span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">plynr</span> <span class="o">=</span> <span class="n">TriggerGetPlayer</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">op</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">q</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
	<span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
	<span class="k">const</span> <span class="n">CUnitType</span> <span class="o">*</span><span class="n">unittype</span> <span class="o">=</span> <span class="n">TriggerGetUnitType</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">const</span> <span class="n">CUnitType</span> <span class="o">*</span><span class="n">ut2</span> <span class="o">=</span> <span class="n">CclGetUnitType</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">unittype</span> <span class="o">||</span> <span class="o">!</span><span class="n">ut2</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;CclIfRescuedNearUnit: not a unit-type valid&quot;</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="n">CompareFunction</span> <span class="n">compare</span> <span class="o">=</span> <span class="n">GetCompareFunction</span><span class="p">(</span><span class="n">op</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">compare</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Illegal comparison operation in if-rescued-near-unit: %s&quot;</span> <span class="n">_C_</span> <span class="n">op</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="c1">// Get all unit types &#39;near&#39;.</span>
	<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">CUnit</span> <span class="o">*&gt;</span> <span class="n">table</span><span class="p">;</span>
	<span class="n">FindUnitsByType</span><span class="p">(</span><span class="o">*</span><span class="n">ut2</span><span class="p">,</span> <span class="n">table</span><span class="p">);</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">table</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">CUnit</span> <span class="o">&amp;</span><span class="n">centerUnit</span> <span class="o">=</span> <span class="o">*</span><span class="n">table</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
		<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">CUnit</span> <span class="o">*&gt;</span> <span class="n">around</span><span class="p">;</span>

		<span class="n">SelectAroundUnit</span><span class="p">(</span><span class="n">centerUnit</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">around</span><span class="p">);</span>
		<span class="c1">// Count the requested units</span>
		<span class="kt">int</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">!=</span> <span class="n">around</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">CUnit</span> <span class="o">&amp;</span><span class="n">unit</span> <span class="o">=</span> <span class="o">*</span><span class="n">around</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>

			<span class="k">if</span> <span class="p">(</span><span class="n">unit</span><span class="p">.</span><span class="n">RescuedFrom</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// only rescued units</span>
				<span class="c1">// Check unit type</span>

				<span class="k">if</span> <span class="p">(</span><span class="n">unittype</span> <span class="o">==</span> <span class="n">ANY_UNIT</span>
					<span class="o">||</span> <span class="p">(</span><span class="n">unittype</span> <span class="o">==</span> <span class="n">ALL_FOODUNITS</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">unit</span><span class="p">.</span><span class="n">Type</span><span class="o">-&gt;</span><span class="n">Building</span><span class="p">)</span>
					<span class="o">||</span> <span class="p">(</span><span class="n">unittype</span> <span class="o">==</span> <span class="n">ALL_BUILDINGS</span> <span class="o">&amp;&amp;</span> <span class="n">unit</span><span class="p">.</span><span class="n">Type</span><span class="o">-&gt;</span><span class="n">Building</span><span class="p">)</span>
					<span class="o">||</span> <span class="p">(</span><span class="n">unittype</span> <span class="o">==</span> <span class="n">unit</span><span class="p">.</span><span class="n">Type</span><span class="p">))</span> <span class="p">{</span>

					<span class="c1">// Check the player</span>
					<span class="k">if</span> <span class="p">(</span><span class="n">plynr</span> <span class="o">==</span> <span class="mi">-1</span> <span class="o">||</span> <span class="n">plynr</span> <span class="o">==</span> <span class="n">unit</span><span class="p">.</span><span class="n">Player</span><span class="o">-&gt;</span><span class="n">Index</span><span class="p">)</span> <span class="p">{</span>
						<span class="o">++</span><span class="n">s</span><span class="p">;</span>
					<span class="p">}</span>
				<span class="p">}</span>
			<span class="p">}</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">compare</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">q</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">lua_pushboolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
			<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="n">lua_pushboolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        <hr>/game/replay.cpp<hr>
                        <details>
                        <summary>Log</summary>
                        <p><br> Parse log</p>
                          <details>
                          <summary>/game/replay.cpp:573 CclLog</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclLog</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LogEntry</span> <span class="o">*</span><span class="n">log</span><span class="p">;</span>
	<span class="n">LogEntry</span> <span class="o">**</span><span class="n">last</span><span class="p">;</span>
	<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">value</span><span class="p">;</span>

	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="n">Assert</span><span class="p">(</span><span class="n">CurrentReplay</span><span class="p">);</span>

	<span class="n">log</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LogEntry</span><span class="p">;</span>
	<span class="n">log</span><span class="o">-&gt;</span><span class="n">UnitNumber</span> <span class="o">=</span> <span class="mi">-1</span><span class="p">;</span>
	<span class="n">log</span><span class="o">-&gt;</span><span class="n">PosX</span> <span class="o">=</span> <span class="mi">-1</span><span class="p">;</span>
	<span class="n">log</span><span class="o">-&gt;</span><span class="n">PosY</span> <span class="o">=</span> <span class="mi">-1</span><span class="p">;</span>
	<span class="n">log</span><span class="o">-&gt;</span><span class="n">DestUnitNumber</span> <span class="o">=</span> <span class="mi">-1</span><span class="p">;</span>
	<span class="n">log</span><span class="o">-&gt;</span><span class="n">Num</span> <span class="o">=</span> <span class="mi">-1</span><span class="p">;</span>

	<span class="n">lua_pushnil</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="k">while</span> <span class="p">(</span><span class="n">lua_next</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-2</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;GameCycle&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">log</span><span class="o">-&gt;</span><span class="n">GameCycle</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;UnitNumber&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">log</span><span class="o">-&gt;</span><span class="n">UnitNumber</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;UnitIdent&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">log</span><span class="o">-&gt;</span><span class="n">UnitIdent</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Action&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">log</span><span class="o">-&gt;</span><span class="n">Action</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Flush&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">log</span><span class="o">-&gt;</span><span class="n">Flush</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;PosX&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">log</span><span class="o">-&gt;</span><span class="n">PosX</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;PosY&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">log</span><span class="o">-&gt;</span><span class="n">PosY</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;DestUnitNumber&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">log</span><span class="o">-&gt;</span><span class="n">DestUnitNumber</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Value&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">log</span><span class="o">-&gt;</span><span class="n">Value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Num&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">log</span><span class="o">-&gt;</span><span class="n">Num</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;SyncRandSeed&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">log</span><span class="o">-&gt;</span><span class="n">SyncRandSeed</span> <span class="o">=</span> <span class="n">LuaToUnsignedNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Unsupported key: %s&quot;</span> <span class="n">_C_</span> <span class="n">value</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="c1">// Append to linked list</span>
	<span class="n">last</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">CurrentReplay</span><span class="o">-&gt;</span><span class="n">Commands</span><span class="p">;</span>
	<span class="k">while</span> <span class="p">(</span><span class="o">*</span><span class="n">last</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">last</span> <span class="o">=</span> <span class="o">&amp;</span><span class="p">(</span><span class="o">*</span><span class="n">last</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">Next</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="o">*</span><span class="n">last</span> <span class="o">=</span> <span class="n">log</span><span class="p">;</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>ReplayLog</summary>
                        <p><br> Parse replay-log</p>
                          <details>
                          <summary>/game/replay.cpp:698 CclReplayLog</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclReplayLog</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">FullReplay</span> <span class="o">*</span><span class="n">replay</span><span class="p">;</span>
	<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">value</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">j</span><span class="p">;</span>

	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="n">Assert</span><span class="p">(</span><span class="n">CurrentReplay</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">);</span>

	<span class="n">replay</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FullReplay</span><span class="p">;</span>

	<span class="n">lua_pushnil</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="k">while</span> <span class="p">(</span><span class="n">lua_next</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-2</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Comment1&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">replay</span><span class="o">-&gt;</span><span class="n">Comment1</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Comment2&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">replay</span><span class="o">-&gt;</span><span class="n">Comment2</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Comment3&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">replay</span><span class="o">-&gt;</span><span class="n">Comment3</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Date&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">replay</span><span class="o">-&gt;</span><span class="n">Date</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Map&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">replay</span><span class="o">-&gt;</span><span class="n">Map</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;MapPath&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">replay</span><span class="o">-&gt;</span><span class="n">MapPath</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;MapId&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">replay</span><span class="o">-&gt;</span><span class="n">MapId</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Type&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">replay</span><span class="o">-&gt;</span><span class="n">Type</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Race&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">replay</span><span class="o">-&gt;</span><span class="n">Race</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;LocalPlayer&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">replay</span><span class="o">-&gt;</span><span class="n">LocalPlayer</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Players&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">)</span> <span class="o">||</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">)</span> <span class="o">!=</span> <span class="n">PlayerMax</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="k">for</span> <span class="p">(</span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">PlayerMax</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
				<span class="kt">int</span> <span class="n">top</span><span class="p">;</span>

				<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
				<span class="p">}</span>
				<span class="n">top</span> <span class="o">=</span> <span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
				<span class="n">lua_pushnil</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
				<span class="k">while</span> <span class="p">(</span><span class="n">lua_next</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">top</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-2</span><span class="p">);</span>
					<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Name&quot;</span><span class="p">))</span> <span class="p">{</span>
						<span class="n">replay</span><span class="o">-&gt;</span><span class="n">Players</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">Name</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
					<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;AIScript&quot;</span><span class="p">))</span> <span class="p">{</span>
						<span class="n">replay</span><span class="o">-&gt;</span><span class="n">Players</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">AIScript</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
					<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;PlayerColor&quot;</span><span class="p">))</span> <span class="p">{</span>
						<span class="n">replay</span><span class="o">-&gt;</span><span class="n">Players</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">PlayerColor</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
					<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Race&quot;</span><span class="p">))</span> <span class="p">{</span>
						<span class="n">replay</span><span class="o">-&gt;</span><span class="n">Players</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">Race</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
					<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Team&quot;</span><span class="p">))</span> <span class="p">{</span>
						<span class="n">replay</span><span class="o">-&gt;</span><span class="n">Players</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">Team</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
					<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Type&quot;</span><span class="p">))</span> <span class="p">{</span>
						<span class="n">replay</span><span class="o">-&gt;</span><span class="n">Players</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">Type</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
					<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
						<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Unsupported key: %s&quot;</span> <span class="n">_C_</span> <span class="n">value</span><span class="p">);</span>
					<span class="p">}</span>
					<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
				<span class="p">}</span>
				<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Resource&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">replay</span><span class="o">-&gt;</span><span class="n">Resource</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;NumUnits&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">replay</span><span class="o">-&gt;</span><span class="n">NumUnits</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Difficulty&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">replay</span><span class="o">-&gt;</span><span class="n">Difficulty</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;NoFow&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">replay</span><span class="o">-&gt;</span><span class="n">NoFow</span> <span class="o">=</span> <span class="n">LuaToBoolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Inside&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">replay</span><span class="o">-&gt;</span><span class="n">Inside</span> <span class="o">=</span> <span class="n">LuaToBoolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;RevealMap&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">replay</span><span class="o">-&gt;</span><span class="n">RevealMap</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;GameType&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">replay</span><span class="o">-&gt;</span><span class="n">GameType</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Opponents&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">replay</span><span class="o">-&gt;</span><span class="n">Opponents</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;MapRichness&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">replay</span><span class="o">-&gt;</span><span class="n">MapRichness</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Engine&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">)</span> <span class="o">||</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="n">replay</span><span class="o">-&gt;</span><span class="n">Engine</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
			<span class="n">replay</span><span class="o">-&gt;</span><span class="n">Engine</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
			<span class="n">replay</span><span class="o">-&gt;</span><span class="n">Engine</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Network&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">)</span> <span class="o">||</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="n">replay</span><span class="o">-&gt;</span><span class="n">Network</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
			<span class="n">replay</span><span class="o">-&gt;</span><span class="n">Network</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
			<span class="n">replay</span><span class="o">-&gt;</span><span class="n">Network</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Unsupported key: %s&quot;</span> <span class="n">_C_</span> <span class="n">value</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="n">CurrentReplay</span> <span class="o">=</span> <span class="n">replay</span><span class="p">;</span>

	<span class="c1">// Apply CurrentReplay settings.</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SaveGameLoading</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">ApplyReplaySettings</span><span class="p">();</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">CommandLogDisabled</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        <hr>/game/game.cpp<hr>
                        <details>
                        <summary>SetGameName</summary>
                        <p><br>  Return of game name.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/game/game.cpp:1125 CclSetGameName</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetGameName</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">args</span> <span class="o">=</span> <span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">args</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="o">||</span> <span class="p">(</span><span class="n">args</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_isnil</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">lua_isstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">))))</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">args</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">lua_isnil</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">GameName</span> <span class="o">=</span> <span class="n">lua_tostring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">GameName</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span> <span class="p">{</span>
		<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">path</span> <span class="o">=</span> <span class="n">Parameters</span><span class="o">::</span><span class="n">Instance</span><span class="p">.</span><span class="n">GetUserDirectory</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot;/&quot;</span> <span class="o">+</span> <span class="n">GameName</span><span class="p">;</span>
		<span class="n">makedir</span><span class="p">(</span><span class="n">path</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span> <span class="mo">0777</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SetFullGameName</summary>
                        <p>/game/game.cpp:1137 CclSetFullGameName</p>
                        <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetFullGameName</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">args</span> <span class="o">=</span> <span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">args</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="o">||</span> <span class="p">(</span><span class="n">args</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_isnil</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">lua_isstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">))))</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">args</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">lua_isnil</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">FullGameName</span> <span class="o">=</span> <span class="n">lua_tostring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                        </details>
                        
                        <details>
                        <summary>SetGodMode</summary>
                        <p><br>  Set God mode.<br><br>  @param l  Lua state.<br><br>  @return   The old mode.</p>
                          <details>
                          <summary>/game/game.cpp:1151 CclSetGodMode</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetGodMode</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">GodMode</span> <span class="o">=</span> <span class="n">LuaToBoolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>GetGodMode</summary>
                        <p><br>  Get God mode.<br><br>  @param l  Lua state.<br><br>  @return   God mode.</p>
                          <details>
                          <summary>/game/game.cpp:1165 CclGetGodMode</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclGetGodMode</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="n">lua_pushboolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">GodMode</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SetSpeedResourcesHarvest</summary>
                        <p><br>  Set resource harvesting speed (deprecated).<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/game/game.cpp:1182 CclSetSpeedResourcesHarvest</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetSpeedResourcesHarvest</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>

	<span class="k">const</span> <span class="kt">int</span> <span class="n">player</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">resource</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">resId</span> <span class="o">=</span> <span class="n">GetResourceIdByName</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">resource</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>

	<span class="n">Players</span><span class="p">[</span><span class="n">player</span><span class="p">].</span><span class="n">SpeedResourcesHarvest</span><span class="p">[</span><span class="n">resId</span><span class="p">]</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SetSpeedResourcesReturn</summary>
                        <p><br>  Set resource returning speed (deprecated).<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/game/game.cpp:1199 CclSetSpeedResourcesReturn</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetSpeedResourcesReturn</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>

	<span class="k">const</span> <span class="kt">int</span> <span class="n">player</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">resource</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">resId</span> <span class="o">=</span> <span class="n">GetResourceIdByName</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">resource</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>

	<span class="n">Players</span><span class="p">[</span><span class="n">player</span><span class="p">].</span><span class="n">SpeedResourcesReturn</span><span class="p">[</span><span class="n">resId</span><span class="p">]</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SetSpeedBuild</summary>
                        <p><br>  Set building speed (deprecated).<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/game/game.cpp:1212 CclSetSpeedBuild</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetSpeedBuild</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">player</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">Players</span><span class="p">[</span><span class="n">player</span><span class="p">].</span><span class="n">SpeedBuild</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>GetSpeedBuild</summary>
                        <p><br>  Get building speed (deprecated).<br><br>  @param l  Lua state.<br><br>  @return   Building speed.</p>
                          <details>
                          <summary>/game/game.cpp:1227 CclGetSpeedBuild</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclGetSpeedBuild</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">player</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">Players</span><span class="p">[</span><span class="n">player</span><span class="p">].</span><span class="n">SpeedBuild</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SetSpeedTrain</summary>
                        <p><br>  Set training speed (deprecated).<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/game/game.cpp:1240 CclSetSpeedTrain</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetSpeedTrain</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">player</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">Players</span><span class="p">[</span><span class="n">player</span><span class="p">].</span><span class="n">SpeedTrain</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>GetSpeedTrain</summary>
                        <p><br>  Get training speed (deprecated).<br><br>  @param l  Lua state.<br><br>  @return   Training speed.</p>
                          <details>
                          <summary>/game/game.cpp:1255 CclGetSpeedTrain</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclGetSpeedTrain</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">player</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">Players</span><span class="p">[</span><span class="n">player</span><span class="p">].</span><span class="n">SpeedTrain</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SetSpeedUpgrade</summary>
                        <p><br>  For debug increase upgrading speed (deprecated).<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/game/game.cpp:1270 CclSetSpeedUpgrade</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetSpeedUpgrade</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">player</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">Players</span><span class="p">[</span><span class="n">player</span><span class="p">].</span><span class="n">SpeedUpgrade</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>

	<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">Players</span><span class="p">[</span><span class="n">player</span><span class="p">].</span><span class="n">SpeedUpgrade</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SetSpeedResearch</summary>
                        <p><br>  For debug increase researching speed (deprecated).<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/game/game.cpp:1285 CclSetSpeedResearch</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetSpeedResearch</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">player</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">Players</span><span class="p">[</span><span class="n">player</span><span class="p">].</span><span class="n">SpeedResearch</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>

	<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">Players</span><span class="p">[</span><span class="n">player</span><span class="p">].</span><span class="n">SpeedResearch</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SetSpeeds</summary>
                        <p><br>  For debug increase all speeds (deprecated).<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/game/game.cpp:1306 CclSetSpeeds</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetSpeeds</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">speed</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">PlayerMax</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">MaxCosts</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">Players</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">SpeedResourcesHarvest</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">speed</span><span class="p">;</span>
			<span class="n">Players</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">SpeedResourcesReturn</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">speed</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="n">Players</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">SpeedBuild</span> <span class="o">=</span> <span class="n">Players</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">SpeedTrain</span> <span class="o">=</span> <span class="n">Players</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">SpeedUpgrade</span> <span class="o">=</span> <span class="n">Players</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">SpeedResearch</span> <span class="o">=</span> <span class="n">speed</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">speed</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>DefineDefaultIncomes</summary>
                        <p><br>  Define default incomes for a new player.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/game/game.cpp:1320 CclDefineDefaultIncomes</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclDefineDefaultIncomes</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">args</span> <span class="o">=</span> <span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">MaxCosts</span> <span class="o">&amp;&amp;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">args</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">DefaultIncomes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>DefineDefaultActions</summary>
                        <p><br>  Define default action for the resources.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/game/game.cpp:1337 CclDefineDefaultActions</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclDefineDefaultActions</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">MaxCosts</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">DefaultActions</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">clear</span><span class="p">();</span>
	<span class="p">}</span>
	<span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">args</span> <span class="o">=</span> <span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">MaxCosts</span> <span class="o">&amp;&amp;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">args</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">DefaultActions</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>DefineDefaultResourceNames</summary>
                        <p><br>  Define default names for the resources.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/game/game.cpp:1354 CclDefineDefaultResourceNames</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclDefineDefaultResourceNames</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">MaxCosts</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">DefaultResourceNames</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">clear</span><span class="p">();</span>
	<span class="p">}</span>
	<span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">args</span> <span class="o">=</span> <span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">MaxCosts</span> <span class="o">&amp;&amp;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">args</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">DefaultResourceNames</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>DefineDefaultResourceAmounts</summary>
                        <p><br>  Define default names for the resources.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/game/game.cpp:1376 CclDefineDefaultResourceAmounts</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclDefineDefaultResourceAmounts</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">args</span> <span class="o">=</span> <span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">args</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">args</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">resource</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="k">const</span> <span class="kt">int</span> <span class="n">resId</span> <span class="o">=</span> <span class="n">GetResourceIdByName</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">resource</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>

		<span class="o">++</span><span class="n">j</span><span class="p">;</span>
		<span class="n">DefaultResourceAmounts</span><span class="p">[</span><span class="n">resId</span><span class="p">]</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>DefineDefaultResourceMaxAmounts</summary>
                        <p><br>  Define max amounts for the resources.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/game/game.cpp:1394 CclDefineDefaultResourceMaxAmounts</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclDefineDefaultResourceMaxAmounts</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">args</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">min</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">),</span> <span class="n">MaxCosts</span><span class="p">);</span>

	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">args</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">DefaultResourceMaxAmounts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">args</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">MaxCosts</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">DefaultResourceMaxAmounts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">-1</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SetUseHPForXp</summary>
                        <p><br>  Affect UseHPForXp.<br><br>  @param l  Lua state.<br><br>  @return 0.</p>
                          <details>
                          <summary>/game/game.cpp:1408 ScriptSetUseHPForXp</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">ScriptSetUseHPForXp</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">UseHPForXp</span> <span class="o">=</span> <span class="n">LuaToBoolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SetLocalPlayerName</summary>
                        <p><br>  Set the local player name<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/game/game.cpp:1420 CclSetLocalPlayerName</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetLocalPlayerName</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">Parameters</span><span class="o">::</span><span class="n">Instance</span><span class="p">.</span><span class="n">LocalPlayerName</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>GetLocalPlayerName</summary>
                        <p><br>  Get the local player name<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/game/game.cpp:1432 CclGetLocalPlayerName</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclGetLocalPlayerName</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="n">lua_pushstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">Parameters</span><span class="o">::</span><span class="n">Instance</span><span class="p">.</span><span class="n">LocalPlayerName</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SetMenuRace</summary>
                        <p>/game/game.cpp:1459 CclSetMenuRace</p>
                        <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetMenuRace</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">MenuRace</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                        </details>
                        
                        <details>
                        <summary>GetStratagusVersion</summary>
                        <p><br>  Get Stratagus Version</p>
                          <details>
                          <summary>/game/game.cpp:1442 CclGetStratagusVersion</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclGetStratagusVersion</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="n">lua_pushstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">VERSION</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>GetStratagusHomepage</summary>
                        <p><br>  Get Stratagus Homepage</p>
                          <details>
                          <summary>/game/game.cpp:1452 CclGetStratagusHomepage</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclGetStratagusHomepage</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="n">lua_pushstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">HOMEPAGE</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SavedGameInfo</summary>
                        <p><br>  Load the SavedGameInfo Header<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/game/game.cpp:1495 CclSavedGameInfo</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSavedGameInfo</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">lua_pushnil</span><span class="p">(</span><span class="n">l</span><span class="p">);</span> <span class="n">lua_next</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
		<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-2</span><span class="p">);</span>

		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;SaveFile&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">strcpy_s</span><span class="p">(</span><span class="n">CurrentMapPath</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">CurrentMapPath</span><span class="p">),</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">))</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;SaveFile too long&quot;</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">buf</span> <span class="o">=</span> <span class="n">StratagusLibPath</span><span class="p">;</span>
			<span class="n">buf</span> <span class="o">+=</span> <span class="s">&quot;/&quot;</span><span class="p">;</span>
			<span class="n">buf</span> <span class="o">+=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">LuaLoadFile</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span> <span class="o">==</span> <span class="mi">-1</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">DebugPrint</span><span class="p">(</span><span class="s">&quot;Load failed: %s</span><span class="se">\n</span><span class="s">&quot;</span> <span class="n">_C_</span> <span class="n">value</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;SyncHash&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">SyncHash</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;SyncRandSeed&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">SyncRandSeed</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Unsupported tag: %s&quot;</span> <span class="n">_C_</span> <span class="n">value</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        <hr>/stratagus/construct.cpp<hr>
                        <details>
                        <summary>DefineConstruction</summary>
                        <p><br>  Parse the construction.<br><br>  @param l  Lua state.<br><br>  @note make this more flexible</p>
                          <details>
                          <summary>/stratagus/construct.cpp:285 CclDefineConstruction</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclDefineConstruction</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="c1">// Slot identifier</span>
	<span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">str</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">CConstruction</span> <span class="o">*</span><span class="n">construction</span> <span class="o">=</span> <span class="n">ConstructionByIdent</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>
	<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">CConstruction</span> <span class="o">*&gt;::</span><span class="n">iterator</span> <span class="n">i</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">construction</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">construction</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CConstruction</span><span class="p">;</span>
		<span class="n">Constructions</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">construction</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="c1">// redefine completely.</span>
		<span class="n">construction</span><span class="o">-&gt;</span><span class="n">Clean</span><span class="p">();</span>
	<span class="p">}</span>
	<span class="n">construction</span><span class="o">-&gt;</span><span class="n">Ident</span> <span class="o">=</span> <span class="n">str</span><span class="p">;</span>

	<span class="c1">//  Parse the arguments, in tagged format.</span>
	<span class="n">lua_pushnil</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="k">while</span> <span class="p">(</span><span class="n">lua_next</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="p">{</span>
		<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-2</span><span class="p">);</span>
		<span class="kt">bool</span> <span class="n">files</span> <span class="o">=</span> <span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Files&quot;</span><span class="p">);</span>

		<span class="k">if</span> <span class="p">(</span><span class="n">files</span> <span class="o">||</span> <span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;ShadowFiles&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">file</span><span class="p">;</span>
			<span class="kt">int</span> <span class="n">w</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="kt">int</span> <span class="n">h</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="n">lua_pushnil</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
			<span class="k">while</span> <span class="p">(</span><span class="n">lua_next</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-2</span><span class="p">))</span> <span class="p">{</span>
				<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-2</span><span class="p">);</span>

				<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;File&quot;</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">file</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
				<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Size&quot;</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">CclGetPos</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">w</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">h</span><span class="p">);</span>
				<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
					<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Unsupported tag: %s&quot;</span> <span class="n">_C_</span> <span class="n">value</span><span class="p">);</span>
				<span class="p">}</span>
				<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">files</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">construction</span><span class="o">-&gt;</span><span class="n">File</span><span class="p">.</span><span class="n">File</span> <span class="o">=</span> <span class="n">file</span><span class="p">;</span>
				<span class="n">construction</span><span class="o">-&gt;</span><span class="n">File</span><span class="p">.</span><span class="n">Width</span> <span class="o">=</span> <span class="n">w</span><span class="p">;</span>
				<span class="n">construction</span><span class="o">-&gt;</span><span class="n">File</span><span class="p">.</span><span class="n">Height</span> <span class="o">=</span> <span class="n">h</span><span class="p">;</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="n">construction</span><span class="o">-&gt;</span><span class="n">ShadowFile</span><span class="p">.</span><span class="n">File</span> <span class="o">=</span> <span class="n">file</span><span class="p">;</span>
				<span class="n">construction</span><span class="o">-&gt;</span><span class="n">ShadowFile</span><span class="p">.</span><span class="n">Width</span> <span class="o">=</span> <span class="n">w</span><span class="p">;</span>
				<span class="n">construction</span><span class="o">-&gt;</span><span class="n">ShadowFile</span><span class="p">.</span><span class="n">Height</span> <span class="o">=</span> <span class="n">h</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Constructions&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">subargs</span> <span class="o">=</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>

			<span class="k">for</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">subargs</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="p">{</span>
				<span class="kt">int</span> <span class="n">percent</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
				<span class="n">ConstructionFileType</span> <span class="n">file</span> <span class="o">=</span> <span class="n">ConstructionFileConstruction</span><span class="p">;</span>
				<span class="kt">int</span> <span class="n">frame</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

				<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
				<span class="p">}</span>
				<span class="n">lua_pushnil</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
				<span class="k">while</span> <span class="p">(</span><span class="n">lua_next</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-2</span><span class="p">))</span> <span class="p">{</span>
					<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-2</span><span class="p">);</span>

					<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Percent&quot;</span><span class="p">))</span> <span class="p">{</span>
						<span class="n">percent</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
					<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;File&quot;</span><span class="p">))</span> <span class="p">{</span>
						<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>

						<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;construction&quot;</span><span class="p">))</span> <span class="p">{</span>
							<span class="n">file</span> <span class="o">=</span> <span class="n">ConstructionFileConstruction</span><span class="p">;</span>
						<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;main&quot;</span><span class="p">))</span> <span class="p">{</span>
							<span class="n">file</span> <span class="o">=</span> <span class="n">ConstructionFileMain</span><span class="p">;</span>
						<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
							<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Unsupported tag: %s&quot;</span> <span class="n">_C_</span> <span class="n">value</span><span class="p">);</span>
						<span class="p">}</span>
					<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Frame&quot;</span><span class="p">))</span> <span class="p">{</span>
						<span class="n">frame</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
					<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
						<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Unsupported tag: %s&quot;</span> <span class="n">_C_</span> <span class="n">value</span><span class="p">);</span>
					<span class="p">}</span>
					<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
				<span class="p">}</span>
				<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
				<span class="n">CConstructionFrame</span> <span class="o">**</span><span class="n">cframe</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">construction</span><span class="o">-&gt;</span><span class="n">Frames</span><span class="p">;</span>
				<span class="k">while</span> <span class="p">(</span><span class="o">*</span><span class="n">cframe</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">cframe</span> <span class="o">=</span> <span class="o">&amp;</span><span class="p">((</span><span class="o">*</span><span class="n">cframe</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">Next</span><span class="p">);</span>
				<span class="p">}</span>
				<span class="p">(</span><span class="o">*</span><span class="n">cframe</span><span class="p">)</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CConstructionFrame</span><span class="p">;</span>
				<span class="p">(</span><span class="o">*</span><span class="n">cframe</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">Percent</span> <span class="o">=</span> <span class="n">percent</span><span class="p">;</span>
				<span class="p">(</span><span class="o">*</span><span class="n">cframe</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">File</span> <span class="o">=</span> <span class="n">file</span><span class="p">;</span>
				<span class="p">(</span><span class="o">*</span><span class="n">cframe</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">Frame</span> <span class="o">=</span> <span class="n">frame</span><span class="p">;</span>
				<span class="p">(</span><span class="o">*</span><span class="n">cframe</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">Next</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Unsupported tag: %s&quot;</span> <span class="n">_C_</span> <span class="n">value</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        <hr>/stratagus/script_player.cpp<hr>
                        <details>
                        <summary>Player</summary>
                        <p><br>  Parse the player configuration.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/stratagus/script_player.cpp:90 CclPlayer</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclPlayer</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

	<span class="n">CPlayer</span> <span class="o">&amp;</span><span class="n">player</span> <span class="o">=</span> <span class="n">Players</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
	<span class="n">player</span><span class="p">.</span><span class="n">Index</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">NumPlayers</span> <span class="o">&lt;=</span> <span class="n">i</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">NumPlayers</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">player</span><span class="p">.</span><span class="n">Load</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>ChangeUnitsOwner</summary>
                        <p><br>  Change unit owner<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/stratagus/script_player.cpp:356 CclChangeUnitsOwner</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclChangeUnitsOwner</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>

	<span class="n">Vec2i</span> <span class="n">pos1</span><span class="p">;</span>
	<span class="n">Vec2i</span> <span class="n">pos2</span><span class="p">;</span>
	<span class="n">CclGetPos</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">pos1</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">pos1</span><span class="p">.</span><span class="n">y</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">CclGetPos</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">pos2</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">pos2</span><span class="p">.</span><span class="n">y</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">oldp</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">newp</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
	<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">CUnit</span> <span class="o">*&gt;</span> <span class="n">table</span><span class="p">;</span>

	<span class="n">Select</span><span class="p">(</span><span class="n">pos1</span><span class="p">,</span> <span class="n">pos2</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">HasSamePlayerAs</span><span class="p">(</span><span class="n">Players</span><span class="p">[</span><span class="n">oldp</span><span class="p">]));</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">table</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">table</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">ChangeOwner</span><span class="p">(</span><span class="n">Players</span><span class="p">[</span><span class="n">newp</span><span class="p">]);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>GetThisPlayer</summary>
                        <p><br>  Get ThisPlayer.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/stratagus/script_player.cpp:372 CclGetThisPlayer</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclGetThisPlayer</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ThisPlayer</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">ThisPlayer</span> <span class="o">-</span> <span class="n">Players</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SetThisPlayer</summary>
                        <p><br>  Set ThisPlayer.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/stratagus/script_player.cpp:387 CclSetThisPlayer</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetThisPlayer</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="kt">int</span> <span class="n">plynr</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">ThisPlayer</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">Players</span><span class="p">[</span><span class="n">plynr</span><span class="p">];</span>

	<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">plynr</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SetMaxSelectable</summary>
                        <p><br>  Set MaxSelectable<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/stratagus/script_player.cpp:401 CclSetMaxSelectable</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetMaxSelectable</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">MaxSelectable</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

	<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">MaxSelectable</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SetAllPlayersUnitLimit</summary>
                        <p><br>  Set player unit limit.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/stratagus/script_player.cpp:417 CclSetAllPlayersUnitLimit</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetAllPlayersUnitLimit</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">PlayerMax</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">Players</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">UnitLimit</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">lua_tonumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">));</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SetAllPlayersBuildingLimit</summary>
                        <p><br>  Set player unit limit.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/stratagus/script_player.cpp:433 CclSetAllPlayersBuildingLimit</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetAllPlayersBuildingLimit</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">PlayerMax</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">Players</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">BuildingLimit</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">lua_tonumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">));</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SetAllPlayersTotalUnitLimit</summary>
                        <p><br>  Set player unit limit.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/stratagus/script_player.cpp:449 CclSetAllPlayersTotalUnitLimit</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetAllPlayersTotalUnitLimit</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">PlayerMax</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">Players</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">TotalUnitLimit</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">lua_tonumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">));</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SetDiplomacy</summary>
                        <p><br>  Change the diplomacy from player to another player.<br><br>  @param l  Lua state.<br><br>  @return          FIXME: should return old state.</p>
                          <details>
                          <summary>/stratagus/script_player.cpp:475 CclSetDiplomacy</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetDiplomacy</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">base</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">plynr</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
	<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">state</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="s">&quot;allied&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">SendCommandDiplomacy</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">DiplomacyAllied</span><span class="p">,</span> <span class="n">plynr</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="s">&quot;neutral&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">SendCommandDiplomacy</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">DiplomacyNeutral</span><span class="p">,</span> <span class="n">plynr</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="s">&quot;crazy&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">SendCommandDiplomacy</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">DiplomacyCrazy</span><span class="p">,</span> <span class="n">plynr</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="s">&quot;enemy&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">SendCommandDiplomacy</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">DiplomacyEnemy</span><span class="p">,</span> <span class="n">plynr</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>Diplomacy</summary>
                        <p><br>  Change the diplomacy from ThisPlayer to another player.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/stratagus/script_player.cpp:487 CclDiplomacy</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclDiplomacy</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">ThisPlayer</span><span class="o">-&gt;</span><span class="n">Index</span><span class="p">);</span>
	<span class="n">lua_insert</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">return</span> <span class="nf">CclSetDiplomacy</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SetSharedVision</summary>
                        <p><br>  Change the shared vision from player to another player.<br><br>  @param l  Lua state.<br><br>  @return   FIXME: should return old state.</p>
                          <details>
                          <summary>/stratagus/script_player.cpp:507 CclSetSharedVision</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetSharedVision</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>

	<span class="k">const</span> <span class="kt">int</span> <span class="n">base</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">const</span> <span class="kt">bool</span> <span class="n">shared</span> <span class="o">=</span> <span class="n">LuaToBoolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">plynr</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>

	<span class="n">SendCommandSharedVision</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">shared</span><span class="p">,</span> <span class="n">plynr</span><span class="p">);</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SharedVision</summary>
                        <p><br>  Change the shared vision from ThisPlayer to another player.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/stratagus/script_player.cpp:519 CclSharedVision</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSharedVision</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">ThisPlayer</span><span class="o">-&gt;</span><span class="n">Index</span><span class="p">);</span>
	<span class="n">lua_insert</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">return</span> <span class="nf">CclSetSharedVision</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SetRevelationType</summary>
                        <p><br>  Change the players revelation type - reveal all units, only buidings or don't reveal anything<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/stratagus/script_player.cpp:543 CclSetRevelationType</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetRevelationType</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

	<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">revel_type</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">revel_type</span><span class="p">,</span> <span class="s">&quot;no-revelation&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">CPlayer</span><span class="o">::</span><span class="n">SetRevelationType</span><span class="p">(</span><span class="n">RevealTypes</span><span class="o">::</span><span class="n">cNoRevelation</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">revel_type</span><span class="p">,</span> <span class="s">&quot;all-units&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">CPlayer</span><span class="o">::</span><span class="n">SetRevelationType</span><span class="p">(</span><span class="n">RevealTypes</span><span class="o">::</span><span class="n">cAllUnits</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">revel_type</span><span class="p">,</span> <span class="s">&quot;buildings-only&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">CPlayer</span><span class="o">::</span><span class="n">SetRevelationType</span><span class="p">(</span><span class="n">RevealTypes</span><span class="o">::</span><span class="n">cBuildingsOnly</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">PrintFunction</span><span class="p">();</span>
		<span class="n">fprintf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="s">&quot;Accessible types of revelation </span><span class="se">\&quot;</span><span class="s">no-revelation</span><span class="se">\&quot;</span><span class="s">, </span><span class="se">\&quot;</span><span class="s">all-units</span><span class="se">\&quot;</span><span class="s"> and </span><span class="se">\&quot;</span><span class="s">buildings-only</span><span class="se">\&quot;</span><span class="s">.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>DefineRaceNames</summary>
                        <p><br> Define race names<br><br> @param l Lua state.</p>
                          <details>
                          <summary>/stratagus/script_player.cpp:592 CclDefineRaceNames</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclDefineRaceNames</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">PlayerRaces</span><span class="p">.</span><span class="n">Clean</span><span class="p">();</span>
	<span class="k">return</span> <span class="nf">CclDefineNewRaceNames</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>DefineNewRaceNames</summary>
                        <p><br> Define race names<br><br> @param l Lua state.</p>
                          <details>
                          <summary>/stratagus/script_player.cpp:592 CclDefineRaceNames</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclDefineRaceNames</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">PlayerRaces</span><span class="p">.</span><span class="n">Clean</span><span class="p">();</span>
	<span class="k">return</span> <span class="nf">CclDefineNewRaceNames</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>DefinePlayerColors</summary>
                        <p><br>  Define player colors<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/stratagus/script_player.cpp:626 CclDefinePlayerColors</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclDefinePlayerColors</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="k">const</span> <span class="kt">int</span> <span class="n">args</span> <span class="o">=</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">args</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">PlayerColorNames</span><span class="p">[</span><span class="n">i</span> <span class="o">/</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="o">++</span><span class="n">i</span><span class="p">;</span>
		<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="k">const</span> <span class="kt">int</span> <span class="n">numcolors</span> <span class="o">=</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">numcolors</span> <span class="o">!=</span> <span class="n">PlayerColorIndexCount</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;You should use %d colors (See DefinePlayerColorIndex())&quot;</span> <span class="n">_C_</span> <span class="n">PlayerColorIndexCount</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">numcolors</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="n">PlayerColorsRGB</span><span class="p">[</span><span class="n">i</span> <span class="o">/</span> <span class="mi">2</span><span class="p">][</span><span class="n">j</span><span class="p">].</span><span class="n">Parse</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
			<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>DefinePlayerColorIndex</summary>
                        <p><br>  Define player color indexes<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/stratagus/script_player.cpp:659 CclDefinePlayerColorIndex</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclDefinePlayerColorIndex</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="n">PlayerColorIndexStart</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">PlayerColorIndexCount</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>

	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">PlayerMax</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">PlayerColorsRGB</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">clear</span><span class="p">();</span>
		<span class="n">PlayerColorsRGB</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">resize</span><span class="p">(</span><span class="n">PlayerColorIndexCount</span><span class="p">);</span>
		<span class="n">PlayerColors</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">clear</span><span class="p">();</span>
		<span class="n">PlayerColors</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">resize</span><span class="p">(</span><span class="n">PlayerColorIndexCount</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>NewColors</summary>
                        <p><br>  Make new player colors<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/stratagus/script_player.cpp:639 CclNewPlayerColors</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclNewPlayerColors</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="n">SetPlayersPalette</span><span class="p">();</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>GetPlayerData</summary>
                        <p><br>  Get player data.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/stratagus/script_player.cpp:816 CclGetPlayerData</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclGetPlayerData</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">const</span> <span class="n">CPlayer</span> <span class="o">*</span><span class="n">p</span> <span class="o">=</span> <span class="n">CclGetPlayer</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">data</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;Name&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">lua_pushstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">Name</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;RaceName&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">lua_pushstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">PlayerRaces</span><span class="p">.</span><span class="n">Name</span><span class="p">[</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">Race</span><span class="p">].</span><span class="n">c_str</span><span class="p">());</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;Resources&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>

		<span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">res</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
		<span class="k">const</span> <span class="kt">int</span> <span class="n">resId</span> <span class="o">=</span> <span class="n">GetResourceIdByName</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">res</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
		<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">Resources</span><span class="p">[</span><span class="n">resId</span><span class="p">]</span> <span class="o">+</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">StoredResources</span><span class="p">[</span><span class="n">resId</span><span class="p">]);</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;StoredResources&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>

		<span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">res</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
		<span class="k">const</span> <span class="kt">int</span> <span class="n">resId</span> <span class="o">=</span> <span class="n">GetResourceIdByName</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">res</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
		<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">StoredResources</span><span class="p">[</span><span class="n">resId</span><span class="p">]);</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;MaxResources&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>

		<span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">res</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
		<span class="k">const</span> <span class="kt">int</span> <span class="n">resId</span> <span class="o">=</span> <span class="n">GetResourceIdByName</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">res</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
		<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">MaxResources</span><span class="p">[</span><span class="n">resId</span><span class="p">]);</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;UnitTypesCount&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
		<span class="n">CUnitType</span> <span class="o">*</span><span class="n">type</span> <span class="o">=</span> <span class="n">CclGetUnitType</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
		<span class="n">Assert</span><span class="p">(</span><span class="n">type</span><span class="p">);</span>
		<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">UnitTypesCount</span><span class="p">[</span><span class="n">type</span><span class="o">-&gt;</span><span class="n">Slot</span><span class="p">]);</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;UnitTypesAiActiveCount&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
		<span class="n">CUnitType</span> <span class="o">*</span><span class="n">type</span> <span class="o">=</span> <span class="n">CclGetUnitType</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
		<span class="n">Assert</span><span class="p">(</span><span class="n">type</span><span class="p">);</span>
		<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">UnitTypesAiActiveCount</span><span class="p">[</span><span class="n">type</span><span class="o">-&gt;</span><span class="n">Slot</span><span class="p">]);</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;AiEnabled&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">lua_pushboolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">AiEnabled</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;TotalNumUnits&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">GetUnitCount</span><span class="p">());</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;NumBuildings&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">NumBuildings</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;Supply&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">Supply</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;Demand&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">Demand</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;UnitLimit&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">UnitLimit</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;BuildingLimit&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">BuildingLimit</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;TotalUnitLimit&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">TotalUnitLimit</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;Score&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">Score</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;TotalUnits&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">TotalUnits</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;TotalBuildings&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">TotalBuildings</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;TotalResources&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>

		<span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">res</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
		<span class="k">const</span> <span class="kt">int</span> <span class="n">resId</span> <span class="o">=</span> <span class="n">GetResourceIdByName</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">res</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
		<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">TotalResources</span><span class="p">[</span><span class="n">resId</span><span class="p">]);</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;TotalRazings&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">TotalRazings</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;TotalKills&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">TotalKills</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;SpeedResourcesHarvest&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>

		<span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">res</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
		<span class="k">const</span> <span class="kt">int</span> <span class="n">resId</span> <span class="o">=</span> <span class="n">GetResourceIdByName</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">res</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
		<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">SpeedResourcesHarvest</span><span class="p">[</span><span class="n">resId</span><span class="p">]);</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;SpeedResourcesReturn&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>

		<span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">res</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
		<span class="k">const</span> <span class="kt">int</span> <span class="n">resId</span> <span class="o">=</span> <span class="n">GetResourceIdByName</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">res</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
		<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">SpeedResourcesReturn</span><span class="p">[</span><span class="n">resId</span><span class="p">]);</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;SpeedBuild&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">SpeedBuild</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;SpeedTrain&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">SpeedTrain</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;SpeedUpgrade&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">SpeedUpgrade</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;SpeedResearch&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">SpeedResearch</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;Allow&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
		<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">ident</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strncmp</span><span class="p">(</span><span class="n">ident</span><span class="p">,</span> <span class="s">&quot;unit-&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span> <span class="p">{</span>
			<span class="kt">int</span> <span class="n">id</span> <span class="o">=</span> <span class="n">UnitTypeIdByIdent</span><span class="p">(</span><span class="n">ident</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">UnitIdAllowed</span><span class="p">(</span><span class="n">Players</span><span class="p">[</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">Index</span><span class="p">],</span> <span class="n">id</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">lua_pushstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;A&quot;</span><span class="p">);</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">UnitIdAllowed</span><span class="p">(</span><span class="n">Players</span><span class="p">[</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">Index</span><span class="p">],</span> <span class="n">id</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">lua_pushstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;F&quot;</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strncmp</span><span class="p">(</span><span class="n">ident</span><span class="p">,</span> <span class="s">&quot;upgrade-&quot;</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">UpgradeIdentAllowed</span><span class="p">(</span><span class="n">Players</span><span class="p">[</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">Index</span><span class="p">],</span> <span class="n">ident</span><span class="p">)</span> <span class="o">==</span> <span class="sc">&#39;A&#39;</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">lua_pushstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;A&quot;</span><span class="p">);</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">UpgradeIdentAllowed</span><span class="p">(</span><span class="n">Players</span><span class="p">[</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">Index</span><span class="p">],</span> <span class="n">ident</span><span class="p">)</span> <span class="o">==</span> <span class="sc">&#39;R&#39;</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">lua_pushstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;R&quot;</span><span class="p">);</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">UpgradeIdentAllowed</span><span class="p">(</span><span class="n">Players</span><span class="p">[</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">Index</span><span class="p">],</span> <span class="n">ident</span><span class="p">)</span> <span class="o">==</span> <span class="sc">&#39;F&#39;</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">lua_pushstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;F&quot;</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">DebugPrint</span><span class="p">(</span><span class="s">&quot; wrong ident %s</span><span class="se">\n</span><span class="s">&quot;</span> <span class="n">_C_</span> <span class="n">ident</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Invalid field: %s&quot;</span> <span class="n">_C_</span> <span class="n">data</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SetPlayerData</summary>
                        <p><br>  Set player data.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/stratagus/script_player.cpp:924 CclSetPlayerData</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetPlayerData</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">CPlayer</span> <span class="o">*</span><span class="n">p</span> <span class="o">=</span> <span class="n">CclGetPlayer</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">data</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;Name&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">p</span><span class="o">-&gt;</span><span class="n">SetName</span><span class="p">(</span><span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">));</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;RaceName&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">racename</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
		<span class="n">p</span><span class="o">-&gt;</span><span class="n">Race</span> <span class="o">=</span> <span class="n">PlayerRaces</span><span class="p">.</span><span class="n">GetRaceIndexByName</span><span class="p">(</span><span class="n">racename</span><span class="p">);</span>

		<span class="k">if</span> <span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">Race</span> <span class="o">==</span> <span class="mi">-1</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;invalid race name &#39;%s&#39;&quot;</span> <span class="n">_C_</span> <span class="n">racename</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;Resources&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>

		<span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">res</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
		<span class="k">const</span> <span class="kt">int</span> <span class="n">resId</span> <span class="o">=</span> <span class="n">GetResourceIdByName</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">res</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
		<span class="n">p</span><span class="o">-&gt;</span><span class="n">SetResource</span><span class="p">(</span><span class="n">resId</span><span class="p">,</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">4</span><span class="p">));</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;StoredResources&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>

		<span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">res</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
		<span class="k">const</span> <span class="kt">int</span> <span class="n">resId</span> <span class="o">=</span> <span class="n">GetResourceIdByName</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">res</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
		<span class="n">p</span><span class="o">-&gt;</span><span class="n">SetResource</span><span class="p">(</span><span class="n">resId</span><span class="p">,</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">STORE_BUILDING</span><span class="p">);</span>
		<span class="c1">// } else if (!strcmp(data, &quot;UnitTypesCount&quot;)) {</span>
		<span class="c1">// } else if (!strcmp(data, &quot;AiEnabled&quot;)) {</span>
		<span class="c1">// } else if (!strcmp(data, &quot;TotalNumUnits&quot;)) {</span>
		<span class="c1">// } else if (!strcmp(data, &quot;NumBuildings&quot;)) {</span>
		<span class="c1">// } else if (!strcmp(data, &quot;Supply&quot;)) {</span>
		<span class="c1">// } else if (!strcmp(data, &quot;Demand&quot;)) {</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;UnitLimit&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">p</span><span class="o">-&gt;</span><span class="n">UnitLimit</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;BuildingLimit&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">p</span><span class="o">-&gt;</span><span class="n">BuildingLimit</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;TotalUnitLimit&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">p</span><span class="o">-&gt;</span><span class="n">TotalUnitLimit</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;Score&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">p</span><span class="o">-&gt;</span><span class="n">Score</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;TotalUnits&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">p</span><span class="o">-&gt;</span><span class="n">TotalUnits</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;TotalBuildings&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">p</span><span class="o">-&gt;</span><span class="n">TotalBuildings</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;TotalResources&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>

		<span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">res</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
		<span class="k">const</span> <span class="kt">int</span> <span class="n">resId</span> <span class="o">=</span> <span class="n">GetResourceIdByName</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">res</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
		<span class="n">p</span><span class="o">-&gt;</span><span class="n">TotalResources</span><span class="p">[</span><span class="n">resId</span><span class="p">]</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;TotalRazings&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">p</span><span class="o">-&gt;</span><span class="n">TotalRazings</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;TotalKills&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">p</span><span class="o">-&gt;</span><span class="n">TotalKills</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;SpeedResourcesHarvest&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>

		<span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">res</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
		<span class="k">const</span> <span class="kt">int</span> <span class="n">resId</span> <span class="o">=</span> <span class="n">GetResourceIdByName</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">res</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
		<span class="n">p</span><span class="o">-&gt;</span><span class="n">SpeedResourcesHarvest</span><span class="p">[</span><span class="n">resId</span><span class="p">]</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;SpeedResourcesReturn&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>

		<span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">res</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
		<span class="k">const</span> <span class="kt">int</span> <span class="n">resId</span> <span class="o">=</span> <span class="n">GetResourceIdByName</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">res</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
		<span class="n">p</span><span class="o">-&gt;</span><span class="n">SpeedResourcesReturn</span><span class="p">[</span><span class="n">resId</span><span class="p">]</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;SpeedBuild&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">p</span><span class="o">-&gt;</span><span class="n">SpeedBuild</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;SpeedTrain&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">p</span><span class="o">-&gt;</span><span class="n">SpeedTrain</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;SpeedUpgrade&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">p</span><span class="o">-&gt;</span><span class="n">SpeedUpgrade</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;SpeedResearch&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">p</span><span class="o">-&gt;</span><span class="n">SpeedResearch</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;Allow&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
		<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">ident</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
		<span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">acquire</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>

		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strncmp</span><span class="p">(</span><span class="n">ident</span><span class="p">,</span> <span class="s">&quot;upgrade-&quot;</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">acquire</span> <span class="o">==</span> <span class="s">&quot;R&quot;</span> <span class="o">&amp;&amp;</span> <span class="n">UpgradeIdentAllowed</span><span class="p">(</span><span class="o">*</span><span class="n">p</span><span class="p">,</span> <span class="n">ident</span><span class="p">)</span> <span class="o">!=</span> <span class="sc">&#39;R&#39;</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">UpgradeAcquire</span><span class="p">(</span><span class="o">*</span><span class="n">p</span><span class="p">,</span> <span class="n">CUpgrade</span><span class="o">::</span><span class="n">Get</span><span class="p">(</span><span class="n">ident</span><span class="p">));</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">acquire</span> <span class="o">==</span> <span class="s">&quot;F&quot;</span> <span class="o">||</span> <span class="n">acquire</span> <span class="o">==</span> <span class="s">&quot;A&quot;</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">UpgradeIdentAllowed</span><span class="p">(</span><span class="o">*</span><span class="n">p</span><span class="p">,</span> <span class="n">ident</span><span class="p">)</span> <span class="o">==</span> <span class="sc">&#39;R&#39;</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">UpgradeLost</span><span class="p">(</span><span class="o">*</span><span class="n">p</span><span class="p">,</span> <span class="n">CUpgrade</span><span class="o">::</span><span class="n">Get</span><span class="p">(</span><span class="n">ident</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">ID</span><span class="p">);</span>
				<span class="p">}</span>
				<span class="n">AllowUpgradeId</span><span class="p">(</span><span class="o">*</span><span class="n">p</span><span class="p">,</span> <span class="n">UpgradeIdByIdent</span><span class="p">(</span><span class="n">ident</span><span class="p">),</span> <span class="n">acquire</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot; wrong ident %s</span><span class="se">\n</span><span class="s">&quot;</span> <span class="n">_C_</span> <span class="n">ident</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Invalid field: %s&quot;</span> <span class="n">_C_</span> <span class="n">data</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SetAiType</summary>
                        <p><br>  Set ai player algo.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/stratagus/script_player.cpp:945 CclSetAiType</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetAiType</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">CPlayer</span> <span class="o">*</span><span class="n">p</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">p</span> <span class="o">=</span> <span class="n">CclGetPlayer</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

	<span class="n">p</span><span class="o">-&gt;</span><span class="n">AiName</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        <hr>/stratagus/script.cpp<hr>
                        <details>
                        <summary>Add</summary>
                        <p><br>  Return equivalent lua table for add.<br>  {"Add", {arg1, arg2}}<br><br>  @param l  Lua state.<br><br>  @return   equivalent lua table.</p>
                          <details>
                          <summary>/stratagus/script.cpp:1557 CclAdd</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclAdd</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="k">return</span> <span class="nf">Alias</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Add&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>Sub</summary>
                        <p><br>  Return equivalent lua table for add.<br>  {"Div", {arg1, arg2}}<br><br>  @param l  Lua state.<br><br>  @return   equivalent lua table.</p>
                          <details>
                          <summary>/stratagus/script.cpp:1571 CclSub</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSub</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="k">return</span> <span class="nf">Alias</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Sub&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>Mul</summary>
                        <p><br>  Return equivalent lua table for add.<br>  {"Mul", {arg1, arg2}}<br><br>  @param l  Lua state.<br><br>  @return   equivalent lua table.</p>
                          <details>
                          <summary>/stratagus/script.cpp:1584 CclMul</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclMul</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="k">return</span> <span class="nf">Alias</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Mul&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>Div</summary>
                        <p><br>  Return equivalent lua table for add.<br>  {"Div", {arg1, arg2}}<br><br>  @param l  Lua state.<br><br>  @return   equivalent lua table.</p>
                          <details>
                          <summary>/stratagus/script.cpp:1597 CclDiv</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclDiv</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="k">return</span> <span class="nf">Alias</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Div&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>Min</summary>
                        <p><br>  Return equivalent lua table for add.<br>  {"Min", {arg1, arg2}}<br><br>  @param l  Lua state.<br><br>  @return   equivalent lua table.</p>
                          <details>
                          <summary>/stratagus/script.cpp:1610 CclMin</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclMin</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="k">return</span> <span class="nf">Alias</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Min&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>Max</summary>
                        <p><br>  Return equivalent lua table for add.<br>  {"Max", {arg1, arg2, argn}}<br><br>  @param l  Lua state.<br><br>  @return   equivalent lua table.</p>
                          <details>
                          <summary>/stratagus/script.cpp:1623 CclMax</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclMax</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="k">return</span> <span class="nf">Alias</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Max&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>Rand</summary>
                        <p><br>  Return equivalent lua table for add.<br>  {"Rand", {arg1}}<br><br>  @param l  Lua state.<br><br>  @return   equivalent lua table.</p>
                          <details>
                          <summary>/stratagus/script.cpp:1636 CclRand</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclRand</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">return</span> <span class="nf">Alias</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Rand&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>GreaterThan</summary>
                        <p><br>  Return equivalent lua table for GreaterThan.<br>  {"GreaterThan", {arg1, arg2}}<br><br>  @param l  Lua state.<br><br>  @return   equivalent lua table.</p>
                          <details>
                          <summary>/stratagus/script.cpp:1649 CclGreaterThan</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclGreaterThan</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="k">return</span> <span class="nf">Alias</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;GreaterThan&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>LessThan</summary>
                        <p><br>  Return equivalent lua table for LessThan.<br>  {"LessThan", {arg1, arg2}}<br><br>  @param l  Lua state.<br><br>  @return   equivalent lua table.</p>
                          <details>
                          <summary>/stratagus/script.cpp:1675 CclLessThan</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclLessThan</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="k">return</span> <span class="nf">Alias</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;LessThan&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>Equal</summary>
                        <p><br>  Return equivalent lua table for Equal.<br>  {"Equal", {arg1, arg2}}<br><br>  @param l  Lua state.<br><br>  @return   equivalent lua table.</p>
                          <details>
                          <summary>/stratagus/script.cpp:1701 CclEqual</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclEqual</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="k">return</span> <span class="nf">Alias</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Equal&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>GreaterThanOrEq</summary>
                        <p><br>  Return equivalent lua table for GreaterThanOrEq.<br>  {"GreaterThanOrEq", {arg1, arg2}}<br><br>  @param l  Lua state.<br><br>  @return   equivalent lua table.</p>
                          <details>
                          <summary>/stratagus/script.cpp:1662 CclGreaterThanOrEq</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclGreaterThanOrEq</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="k">return</span> <span class="nf">Alias</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;GreaterThanOrEq&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>LessThanOrEq</summary>
                        <p><br>  Return equivalent lua table for LessThanOrEq.<br>  {"LessThanOrEq", {arg1, arg2}}<br><br>  @param l  Lua state.<br><br>  @return   equivalent lua table.</p>
                          <details>
                          <summary>/stratagus/script.cpp:1688 CclLessThanOrEq</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclLessThanOrEq</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="k">return</span> <span class="nf">Alias</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;LessThanOrEq&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>NotEqual</summary>
                        <p><br>  Return equivalent lua table for NotEqual.<br>  {"NotEqual", {arg1, arg2}}<br><br>  @param l  Lua state.<br><br>  @return   equivalent lua table.</p>
                          <details>
                          <summary>/stratagus/script.cpp:1714 CclNotEqual</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclNotEqual</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="k">return</span> <span class="nf">Alias</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;NotEqual&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>VideoTextLength</summary>
                        <p><br>  Return equivalent lua table for VideoTextLength.<br>  {"VideoTextLength", {Text = arg1, Font = arg2}}<br><br>  @param l  Lua state.<br><br>  @return   equivalent lua table.</p>
                          <details>
                          <summary>/stratagus/script.cpp:1862 CclVideoTextLength</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclVideoTextLength</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="n">lua_newtable</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">lua_pushstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;VideoTextLength&quot;</span><span class="p">);</span>
	<span class="n">lua_rawset</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-3</span><span class="p">);</span>
	<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>

	<span class="n">lua_newtable</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="n">lua_pushstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Font&quot;</span><span class="p">);</span>
	<span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">lua_rawset</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-3</span><span class="p">);</span>
	<span class="n">lua_pushstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Text&quot;</span><span class="p">);</span>
	<span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="n">lua_rawset</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-3</span><span class="p">);</span>

	<span class="n">lua_rawset</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-3</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>StringFind</summary>
                        <p><br>  Return equivalent lua table for StringFind.<br>  {"StringFind", {arg1, arg2}}<br><br>  @param l  Lua state.<br><br>  @return   equivalent lua table.</p>
                          <details>
                          <summary>/stratagus/script.cpp:1876 CclStringFind</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclStringFind</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="k">return</span> <span class="nf">Alias</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;StringFind&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>AttackerVar</summary>
                        <p><br>  Return equivalent lua table for .<br>  {"Unit", {Unit = "Attacker", Variable = arg1, Component = "Value" or arg2}}<br><br>  @param l  Lua state.<br><br>  @return   equivalent lua table.</p>
                          <details>
                          <summary>/stratagus/script.cpp:1463 CclUnitAttackerVar</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclUnitAttackerVar</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Bad number of arg for AttackerVar()</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">AliasUnitVar</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Attacker&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>DefenderVar</summary>
                        <p><br>  Return equivalent lua table for .<br>  {"Unit", {Unit = "Defender", Variable = arg1, Component = "Value" or arg2}}<br><br>  @param l  Lua state.<br><br>  @return   equivalent lua table.</p>
                          <details>
                          <summary>/stratagus/script.cpp:1479 CclUnitDefenderVar</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclUnitDefenderVar</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Bad number of arg for DefenderVar()</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">AliasUnitVar</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Defender&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>ActiveUnitVar</summary>
                        <p><br>  Return equivalent lua table for .<br>  {"Unit", {Unit = "Active", Variable = arg1, Component = "Value" or arg2}}<br><br>  @param l  Lua state.<br><br>  @return   equivalent lua table.</p>
                          <details>
                          <summary>/stratagus/script.cpp:1495 CclActiveUnitVar</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclActiveUnitVar</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Bad number of arg for ActiveUnitVar()</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">AliasUnitVar</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Active&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>TypeVar</summary>
                        <p><br>  Return equivalent lua table for .<br>  {"Type", {Type = "Active", Variable = arg1, Component = "Value" or arg2}}<br><br>  @param l  Lua state.<br><br>  @return   equivalent lua table.</p>
                          <details>
                          <summary>/stratagus/script.cpp:1511 CclActiveTypeVar</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclActiveTypeVar</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Bad number of arg for ActiveTypeVar()</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">AliasTypeVar</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Type&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>Concat</summary>
                        <p><br>  Return equivalent lua table for Concat.<br>  {"Concat", {arg1}}<br><br>  @param l  Lua state.<br><br>  @return   equivalent lua table.</p>
                          <details>
                          <summary>/stratagus/script.cpp:1732 CclConcat</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclConcat</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// FIXME do extra job for 1.</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Bad number of arg for Concat()</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">Alias</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Concat&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>String</summary>
                        <p><br>  Return equivalent lua table for String.<br>  {"String", {arg1}}<br><br>  @param l  Lua state.<br><br>  @return   equivalent lua table.</p>
                          <details>
                          <summary>/stratagus/script.cpp:1746 CclString</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclString</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">return</span> <span class="nf">Alias</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;String&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>InverseVideo</summary>
                        <p><br>  Return equivalent lua table for InverseVideo.<br>  {"InverseVideo", {arg1}}<br><br>  @param l  Lua state.<br><br>  @return   equivalent lua table.</p>
                          <details>
                          <summary>/stratagus/script.cpp:1759 CclInverseVideo</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclInverseVideo</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">return</span> <span class="nf">Alias</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;InverseVideo&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>UnitName</summary>
                        <p><br>  Return equivalent lua table for UnitName.<br>  {"UnitName", {arg1}}<br><br>  @param l  Lua state.<br><br>  @return   equivalent lua table.</p>
                          <details>
                          <summary>/stratagus/script.cpp:1772 CclUnitName</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclUnitName</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">return</span> <span class="nf">Alias</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;UnitName&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SubString</summary>
                        <p><br>  Return equivalent lua table for SubString.<br>  {"SubString", {arg1, arg2, arg3}}<br><br>  @param l  Lua state.<br><br>  @return   equivalent lua table.</p>
                          <details>
                          <summary>/stratagus/script.cpp:1803 CclSubString</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSubString</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span> <span class="o">&amp;&amp;</span> <span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Bad number of arg for SubString()</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">Alias</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;SubString&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>Line</summary>
                        <p><br>  Return equivalent lua table for Line.<br>  {"Line", {arg1, arg2[, arg3]}}<br><br>  @param l  Lua state.<br><br>  @return   equivalent lua table.</p>
                          <details>
                          <summary>/stratagus/script.cpp:1819 CclLine</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclLine</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="o">||</span> <span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Bad number of arg for Line()</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">Alias</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Line&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>GameInfo</summary>
                        <p><br>  Return equivalent lua table for Line.<br>  {"Line", "arg1"}<br><br>  @param l  Lua state.<br><br>  @return   equivalent lua table.</p>
                          <details>
                          <summary>/stratagus/script.cpp:1833 CclGameInfo</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclGameInfo</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">return</span> <span class="nf">Alias</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;GameInfo&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>PlayerName</summary>
                        <p><br>  Return equivalent lua table for PlayerName.<br>  {"PlayerName", {arg1}}<br><br>  @param l  Lua state.<br><br>  @return   equivalent lua table.</p>
                          <details>
                          <summary>/stratagus/script.cpp:1922 CclPlayerName</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclPlayerName</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">return</span> <span class="nf">Alias</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;PlayerName&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>PlayerData</summary>
                        <p><br>  Return equivalent lua table for PlayerData.<br>  {"PlayerData", {arg1}}<br><br>  @param l  Lua state.<br><br>  @return   equivalent lua table.</p>
                          <details>
                          <summary>/stratagus/script.cpp:1908 CclPlayerData</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclPlayerData</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span> <span class="o">&amp;&amp;</span> <span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Bad number of arg for PlayerData()</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">Alias</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;PlayerData&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>If</summary>
                        <p><br>  Return equivalent lua table for If.<br>  {"If", {arg1}}<br><br>  @param l  Lua state.<br><br>  @return   equivalent lua table.</p>
                          <details>
                          <summary>/stratagus/script.cpp:1787 CclIf</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclIf</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span> <span class="o">&amp;&amp;</span> <span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Bad number of arg for If()</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">Alias</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;If&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>NumIf</summary>
                        <p><br>  Return equivalent lua table for NumIf.<br>  {"NumIf", {arg1}}<br><br>  @param l  Lua state.<br><br>  @return   equivalent lua table.</p>
                          <details>
                          <summary>/stratagus/script.cpp:1892 CclNumIf</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclNumIf</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span> <span class="o">&amp;&amp;</span> <span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Bad number of arg for NumIf()</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">Alias</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;NumIf&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>LibraryPath</summary>
                        <p><br>  Return the stratagus library path.<br><br>  @param l  Lua state.<br><br>  @return   Current libray path.</p>
                          <details>
                          <summary>/stratagus/script.cpp:1984 CclStratagusLibraryPath</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclStratagusLibraryPath</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">lua_pushstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">StratagusLibPath</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>ListDirectory</summary>
                        <p><br>  Return a table with the files or directories found in the subdirectory.</p>
                          <details>
                          <summary>/stratagus/script.cpp:2046 CclListDirectory</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclListDirectory</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="nf">CclFilteredListDirectory</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>ListFilesInDirectory</summary>
                        <p><br>  Return a table with the files found in the subdirectory.</p>
                          <details>
                          <summary>/stratagus/script.cpp:2054 CclListFilesInDirectory</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclListFilesInDirectory</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="nf">CclFilteredListDirectory</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mh">0x1</span><span class="p">,</span> <span class="mh">0x1</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>ListDirsInDirectory</summary>
                        <p><br>  Return a table with the files found in the subdirectory.</p>
                          <details>
                          <summary>/stratagus/script.cpp:2062 CclListDirsInDirectory</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclListDirsInDirectory</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="nf">CclFilteredListDirectory</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mh">0x0</span><span class="p">,</span> <span class="mh">0x1</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SetDamageFormula</summary>
                        <p><br>  Set damage computation method.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/stratagus/script.cpp:2078 CclSetDamageFormula</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetDamageFormula</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">Assert</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">Damage</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">FreeNumberDesc</span><span class="p">(</span><span class="n">Damage</span><span class="p">);</span>
		<span class="k">delete</span> <span class="n">Damage</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">Damage</span> <span class="o">=</span> <span class="n">CclParseNumberDesc</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SavePreferences</summary>
                        <p><br>  Save preferences<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/stratagus/script.cpp:277 CclSavePreferences</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSavePreferences</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="n">SavePreferences</span><span class="p">();</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>Load</summary>
                        <p><br>  Load a file and execute it.<br><br>  @param l  Lua state.<br><br>  @return   0 in success, else exit.</p>
                          <details>
                          <summary>/stratagus/script.cpp:294 CclLoad</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclLoad</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">filename</span> <span class="o">=</span> <span class="n">LibraryFileName</span><span class="p">(</span><span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">));</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">LuaLoadFile</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="o">==</span> <span class="mi">-1</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">DebugPrint</span><span class="p">(</span><span class="s">&quot;Load failed: %s</span><span class="se">\n</span><span class="s">&quot;</span> <span class="n">_C_</span> <span class="n">filename</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>LoadBuffer</summary>
                        <p><br>  Load a file into a buffer and return it.<br><br>  @param l  Lua state.<br><br>  @return   buffer or nil on failure</p>
                          <details>
                          <summary>/stratagus/script.cpp:314 CclLoadBuffer</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclLoadBuffer</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">file</span> <span class="o">=</span> <span class="n">LibraryFileName</span><span class="p">(</span><span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">));</span>
	<span class="n">DebugPrint</span><span class="p">(</span><span class="s">&quot;Loading &#39;%s&#39;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="n">_C_</span> <span class="n">file</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
	<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">content</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">GetFileContent</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">content</span><span class="p">)</span> <span class="o">==</span> <span class="nb">false</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">lua_pushstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">content</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>DebugPrint</summary>
                        <p><br>  Print debug message with info about current script name, line number and function.<br><br>  @see DebugPrint<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/stratagus/script.cpp:2099 CclDebugPrint</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclDebugPrint</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

<span class="cp">#ifdef DEBUG</span>
	<span class="n">lua_Debug</span> <span class="n">ar</span><span class="p">;</span>
	<span class="n">lua_getstack</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ar</span><span class="p">);</span>
	<span class="n">lua_getinfo</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;nSl&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ar</span><span class="p">);</span>
	<span class="n">fprintf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="s">&quot;%s:%d: %s: %s&quot;</span><span class="p">,</span> <span class="n">ar</span><span class="p">.</span><span class="n">source</span><span class="p">,</span> <span class="n">ar</span><span class="p">.</span><span class="n">currentline</span><span class="p">,</span> <span class="n">ar</span><span class="p">.</span><span class="n">what</span><span class="p">,</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">));</span>
<span class="cp">#endif</span>

	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        <hr>/stratagus/groups.cpp<hr>
                        <details>
                        <summary>Group</summary>
                        <p><br>  Define the group.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/stratagus/groups.cpp:265 CclGroup</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclGroup</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>

	<span class="k">const</span> <span class="kt">int</span> <span class="n">grpNum</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">NUM_GROUPS</span> <span class="o">&lt;=</span> <span class="n">grpNum</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;grpIndex out of bound&quot;</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">CUnitGroup</span> <span class="o">&amp;</span><span class="n">grp</span> <span class="o">=</span> <span class="n">Groups</span><span class="p">[</span><span class="n">grpNum</span><span class="p">];</span>
	<span class="n">grp</span><span class="p">.</span><span class="n">init</span><span class="p">();</span>
	<span class="c1">//grp.Units.size() = LuaToNumber(l, 2);</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">args</span> <span class="o">=</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">args</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">str</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="n">grp</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">UnitManager</span><span class="p">.</span><span class="n">GetSlotUnit</span><span class="p">(</span><span class="n">strtol</span><span class="p">(</span><span class="n">str</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="mi">16</span><span class="p">)),</span> <span class="n">grpNum</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        <hr>/stratagus/selection.cpp<hr>
                        <details>
                        <summary>SetGroupId</summary>
                        <p><br>  Set the current group id. (Needed for load/save)<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/stratagus/selection.cpp:1120 CclSetGroupId</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetGroupId</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">old</span><span class="p">;</span>

	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">old</span> <span class="o">=</span> <span class="n">GroupId</span><span class="p">;</span>
	<span class="n">GroupId</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

	<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">old</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>Selection</summary>
                        <p><br>  Define the current selection.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/stratagus/selection.cpp:1140 CclSelection</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSelection</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="c1">//NumSelected = LuaToNumber(l, 1);</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">args</span> <span class="o">=</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">args</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">str</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="n">Selected</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="o">&amp;</span><span class="n">UnitManager</span><span class="p">.</span><span class="n">GetSlotUnit</span><span class="p">(</span><span class="n">strtol</span><span class="p">(</span><span class="n">str</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="mi">16</span><span class="p">)));</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        <hr>/network/netconnect.cpp<hr>
                        <details>
                        <summary>NoRandomPlacementMultiplayer</summary>
                        <p><br>  Removes Randomization of Player position in Multiplayer mode<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/network/netconnect.cpp:1873 CclNoRandomPlacementMultiplayer</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclNoRandomPlacementMultiplayer</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="n">NoRandomPlacementMultiplayer</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>NetworkDiscoverServers</summary>
                        <p>/network/netconnect.cpp:1893 CclNetworkDiscoverServers</p>
                        <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclNetworkDiscoverServers</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="kt">bool</span> <span class="n">start</span> <span class="o">=</span> <span class="n">LuaToBoolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

	<span class="k">auto</span> <span class="n">callback</span><span class="o">=</span> <span class="p">[</span><span class="n">l</span><span class="p">](</span><span class="kt">char</span><span class="o">*</span> <span class="n">ip</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">auto</span> <span class="n">i</span> <span class="o">=</span> <span class="n">lua_objlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
		<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span><span class="p">);</span>
		<span class="n">lua_pushstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">ip</span><span class="p">);</span>
		<span class="n">lua_settable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-3</span><span class="p">);</span>
	<span class="p">};</span>

	<span class="n">lua_newtable</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">start</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">MdnsService</span><span class="p">.</span><span class="n">QueryServers</span><span class="p">(</span><span class="n">callback</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                        </details>
                        <hr>/ai/script_ai.cpp<hr>
                        <details>
                        <summary>DefineAiHelper</summary>
                        <p><br>  Define helper for AI.<br><br>  @param l  Lua state.<br><br>  @todo  FIXME: the first unit could be a list see ../doc/ccl/ai.html</p>
                          <details>
                          <summary>/ai/script_ai.cpp:350 CclDefineAiHelper</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclDefineAiHelper</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">InitAiHelper</span><span class="p">(</span><span class="n">AiHelpers</span><span class="p">);</span>

	<span class="k">const</span> <span class="kt">int</span> <span class="n">args</span> <span class="o">=</span> <span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">args</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="k">const</span> <span class="kt">int</span> <span class="n">subargs</span> <span class="o">=</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;build&quot;</span><span class="p">)</span>
			<span class="o">||</span> <span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;train&quot;</span><span class="p">)</span>
			<span class="o">||</span> <span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;upgrade&quot;</span><span class="p">)</span>
			<span class="o">||</span> <span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;research&quot;</span><span class="p">)</span>
			<span class="o">||</span> <span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;unit-limit&quot;</span><span class="p">)</span>
			<span class="o">||</span> <span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;repair&quot;</span><span class="p">))</span> <span class="p">{</span>
<span class="cp">#ifdef DEBUG</span>
			<span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;DefineAiHelper: Relation is computed from buttons, you may remove safely the block beginning with &#39;</span><span class="se">\&quot;</span><span class="s">%s</span><span class="se">\&quot;</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">);</span>
<span class="cp">#endif</span>
			<span class="k">continue</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;unit-equiv&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;unknown tag: %s&quot;</span> <span class="n">_C_</span> <span class="n">value</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="c1">// Get the base unit type, which could handle the action.</span>
		<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">baseTypeName</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
		<span class="k">const</span> <span class="n">CUnitType</span> <span class="o">*</span><span class="n">base</span> <span class="o">=</span> <span class="n">UnitTypeByIdent</span><span class="p">(</span><span class="n">baseTypeName</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">base</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;unknown unittype: %s&quot;</span> <span class="n">_C_</span> <span class="n">baseTypeName</span><span class="p">);</span>
		<span class="p">}</span>

		<span class="c1">// Get the unit types, which could be produced</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">subargs</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">equivTypeName</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="n">CUnitType</span> <span class="o">*</span><span class="n">type</span> <span class="o">=</span> <span class="n">UnitTypeByIdent</span><span class="p">(</span><span class="n">equivTypeName</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">type</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;unknown unittype: %s&quot;</span> <span class="n">_C_</span> <span class="n">equivTypeName</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="n">AiHelperInsert</span><span class="p">(</span><span class="n">AiHelpers</span><span class="p">.</span><span class="n">Equiv</span><span class="p">,</span> <span class="n">base</span><span class="o">-&gt;</span><span class="n">Slot</span><span class="p">,</span> <span class="o">*</span><span class="n">type</span><span class="p">);</span>
			<span class="n">AiNewUnitTypeEquiv</span><span class="p">(</span><span class="o">*</span><span class="n">base</span><span class="p">,</span> <span class="o">*</span><span class="n">type</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>DefineAi</summary>
                        <p><br>  Define helper for AI.<br><br>  @param l  Lua state.<br><br>  @todo  FIXME: the first unit could be a list see ../doc/ccl/ai.html</p>
                          <details>
                          <summary>/ai/script_ai.cpp:350 CclDefineAi</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclDefineAiHelper</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">InitAiHelper</span><span class="p">(</span><span class="n">AiHelpers</span><span class="p">);</span>

	<span class="k">const</span> <span class="kt">int</span> <span class="n">args</span> <span class="o">=</span> <span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">args</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="k">const</span> <span class="kt">int</span> <span class="n">subargs</span> <span class="o">=</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;build&quot;</span><span class="p">)</span>
			<span class="o">||</span> <span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;train&quot;</span><span class="p">)</span>
			<span class="o">||</span> <span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;upgrade&quot;</span><span class="p">)</span>
			<span class="o">||</span> <span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;research&quot;</span><span class="p">)</span>
			<span class="o">||</span> <span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;unit-limit&quot;</span><span class="p">)</span>
			<span class="o">||</span> <span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;repair&quot;</span><span class="p">))</span> <span class="p">{</span>
<span class="cp">#ifdef DEBUG</span>
			<span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;DefineAiHelper: Relation is computed from buttons, you may remove safely the block beginning with &#39;</span><span class="se">\&quot;</span><span class="s">%s</span><span class="se">\&quot;</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">);</span>
<span class="cp">#endif</span>
			<span class="k">continue</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;unit-equiv&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;unknown tag: %s&quot;</span> <span class="n">_C_</span> <span class="n">value</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="c1">// Get the base unit type, which could handle the action.</span>
		<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">baseTypeName</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
		<span class="k">const</span> <span class="n">CUnitType</span> <span class="o">*</span><span class="n">base</span> <span class="o">=</span> <span class="n">UnitTypeByIdent</span><span class="p">(</span><span class="n">baseTypeName</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">base</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;unknown unittype: %s&quot;</span> <span class="n">_C_</span> <span class="n">baseTypeName</span><span class="p">);</span>
		<span class="p">}</span>

		<span class="c1">// Get the unit types, which could be produced</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">subargs</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">equivTypeName</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="n">CUnitType</span> <span class="o">*</span><span class="n">type</span> <span class="o">=</span> <span class="n">UnitTypeByIdent</span><span class="p">(</span><span class="n">equivTypeName</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">type</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;unknown unittype: %s&quot;</span> <span class="n">_C_</span> <span class="n">equivTypeName</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="n">AiHelperInsert</span><span class="p">(</span><span class="n">AiHelpers</span><span class="p">.</span><span class="n">Equiv</span><span class="p">,</span> <span class="n">base</span><span class="o">-&gt;</span><span class="n">Slot</span><span class="p">,</span> <span class="o">*</span><span class="n">type</span><span class="p">);</span>
			<span class="n">AiNewUnitTypeEquiv</span><span class="p">(</span><span class="o">*</span><span class="n">base</span><span class="p">,</span> <span class="o">*</span><span class="n">type</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>AiGetRace</summary>
                        <p><br>  Get the race of the current AI player.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/ai/script_ai.cpp:503 CclAiGetRace</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclAiGetRace</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="n">lua_pushstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">PlayerRaces</span><span class="p">.</span><span class="n">Name</span><span class="p">[</span><span class="n">AiPlayer</span><span class="o">-&gt;</span><span class="n">Player</span><span class="o">-&gt;</span><span class="n">Race</span><span class="p">].</span><span class="n">c_str</span><span class="p">());</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>AiGetSleepCycles</summary>
                        <p><br>  Get the number of cycles to sleep.<br><br>  @param l  Lua state<br><br>  @return   Number of return values</p>
                          <details>
                          <summary>/ai/script_ai.cpp:517 CclAiGetSleepCycles</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclAiGetSleepCycles</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">AiSleepCycles</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>AiDebug</summary>
                        <p><br>  Set debugging flag of AI script<br><br>  @param l  Lua state<br><br>  @return   Number of return values</p>
                          <details>
                          <summary>/ai/script_ai.cpp:533 CclAiDebug</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclAiDebug</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">AiPlayer</span><span class="o">-&gt;</span><span class="n">ScriptDebug</span> <span class="o">=</span> <span class="n">LuaToBoolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>AiDebugPlayer</summary>
                        <p><br>  Activate AI debugging for the given player(s)<br>  Player can be a number for a specific player<br>    "self" for current human player (ai me)<br>    "none" to disable<br><br>  @param l  Lua State<br><br>  @return   Number of return values</p>
                          <details>
                          <summary>/ai/script_ai.cpp:581 CclAiDebugPlayer</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclAiDebugPlayer</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">args</span> <span class="o">=</span> <span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">args</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">item</span><span class="p">;</span>

		<span class="k">if</span> <span class="p">(</span><span class="n">lua_isstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">item</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">item</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">item</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="s">&quot;none&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">NumPlayers</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">Players</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">AiEnabled</span> <span class="o">||</span> <span class="o">!</span><span class="n">Players</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">Ai</span><span class="p">)</span> <span class="p">{</span>
					<span class="k">continue</span><span class="p">;</span>
				<span class="p">}</span>
				<span class="n">Players</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">Ai</span><span class="o">-&gt;</span><span class="n">ScriptDebug</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="kt">int</span> <span class="n">playerid</span><span class="p">;</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">item</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="s">&quot;self&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">ThisPlayer</span><span class="p">)</span> <span class="p">{</span>
					<span class="k">continue</span><span class="p">;</span>
				<span class="p">}</span>
				<span class="n">playerid</span> <span class="o">=</span> <span class="n">ThisPlayer</span><span class="o">-&gt;</span><span class="n">Index</span><span class="p">;</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="n">playerid</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="p">}</span>

			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">Players</span><span class="p">[</span><span class="n">playerid</span><span class="p">].</span><span class="n">AiEnabled</span> <span class="o">||</span> <span class="o">!</span><span class="n">Players</span><span class="p">[</span><span class="n">playerid</span><span class="p">].</span><span class="n">Ai</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">continue</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="n">Players</span><span class="p">[</span><span class="n">playerid</span><span class="p">].</span><span class="n">Ai</span><span class="o">-&gt;</span><span class="n">ScriptDebug</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>AiNeed</summary>
                        <p><br>  Need a unit.<br><br>  @param l  Lua state.<br><br>  @return   Number of return values</p>
                          <details>
                          <summary>/ai/script_ai.cpp:597 CclAiNeed</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclAiNeed</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">InsertUnitTypeRequests</span><span class="p">(</span><span class="n">CclGetUnitType</span><span class="p">(</span><span class="n">l</span><span class="p">),</span> <span class="mi">1</span><span class="p">);</span>

	<span class="n">lua_pushboolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>AiSet</summary>
                        <p><br>  Set the number of units.<br><br>  @param l  Lua state<br><br>  @return   Number of return values</p>
                          <details>
                          <summary>/ai/script_ai.cpp:622 CclAiSet</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclAiSet</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">CUnitType</span> <span class="o">*</span><span class="n">type</span> <span class="o">=</span> <span class="n">CclGetUnitType</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

	<span class="n">AiRequestType</span> <span class="o">*</span><span class="n">autt</span> <span class="o">=</span> <span class="n">FindInUnitTypeRequests</span><span class="p">(</span><span class="n">type</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">autt</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">autt</span><span class="o">-&gt;</span><span class="n">Count</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
		<span class="c1">// FIXME: 0 should remove it.</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">InsertUnitTypeRequests</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">));</span>
	<span class="p">}</span>
	<span class="n">lua_pushboolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>AiWait</summary>
                        <p><br>  Wait for a unit.<br><br>  @param l  Lua State.<br><br>  @return   Number of return values</p>
                          <details>
                          <summary>/ai/script_ai.cpp:678 CclAiWait</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclAiWait</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">const</span> <span class="n">CUnitType</span> <span class="o">*</span><span class="n">type</span> <span class="o">=</span> <span class="n">CclGetUnitType</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="o">*</span><span class="n">unit_types_count</span> <span class="o">=</span> <span class="n">AiPlayer</span><span class="o">-&gt;</span><span class="n">Player</span><span class="o">-&gt;</span><span class="n">UnitTypesAiActiveCount</span><span class="p">;</span>
	<span class="k">const</span> <span class="n">AiRequestType</span> <span class="o">*</span><span class="n">autt</span> <span class="o">=</span> <span class="n">FindInUnitTypeRequests</span><span class="p">(</span><span class="n">type</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">autt</span><span class="p">)</span> <span class="p">{</span>
		<span class="c1">// Look if we have this unit-type.</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">unit_types_count</span><span class="p">[</span><span class="n">type</span><span class="o">-&gt;</span><span class="n">Slot</span><span class="p">])</span> <span class="p">{</span>
			<span class="n">lua_pushboolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
			<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>

		<span class="c1">// Look if we have equivalent unit-types.</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">type</span><span class="o">-&gt;</span><span class="n">Slot</span> <span class="o">&lt;</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">AiHelpers</span><span class="p">.</span><span class="n">Equiv</span><span class="p">.</span><span class="n">size</span><span class="p">())</span> <span class="p">{</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">AiHelpers</span><span class="p">.</span><span class="n">Equiv</span><span class="p">[</span><span class="n">type</span><span class="o">-&gt;</span><span class="n">Slot</span><span class="p">].</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">unit_types_count</span><span class="p">[</span><span class="n">AiHelpers</span><span class="p">.</span><span class="n">Equiv</span><span class="p">[</span><span class="n">type</span><span class="o">-&gt;</span><span class="n">Slot</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">Slot</span><span class="p">])</span> <span class="p">{</span>
					<span class="n">lua_pushboolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
					<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
				<span class="p">}</span>
			<span class="p">}</span>
		<span class="p">}</span>
		<span class="c1">// Look if we have an upgrade-to request.</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">FindInUpgradeToRequests</span><span class="p">(</span><span class="n">type</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">lua_pushboolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
			<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="n">DebugPrint</span><span class="p">(</span><span class="s">&quot;Broken? waiting on %s which wasn&#39;t requested.</span><span class="se">\n</span><span class="s">&quot;</span> <span class="n">_C_</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">Ident</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
		<span class="n">lua_pushboolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="c1">//</span>
	<span class="c1">// Add equivalent units</span>
	<span class="c1">//</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="n">unit_types_count</span><span class="p">[</span><span class="n">type</span><span class="o">-&gt;</span><span class="n">Slot</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">type</span><span class="o">-&gt;</span><span class="n">Slot</span> <span class="o">&lt;</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">AiHelpers</span><span class="p">.</span><span class="n">Equiv</span><span class="p">.</span><span class="n">size</span><span class="p">())</span> <span class="p">{</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">AiHelpers</span><span class="p">.</span><span class="n">Equiv</span><span class="p">[</span><span class="n">type</span><span class="o">-&gt;</span><span class="n">Slot</span><span class="p">].</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">n</span> <span class="o">+=</span> <span class="n">unit_types_count</span><span class="p">[</span><span class="n">AiHelpers</span><span class="p">.</span><span class="n">Equiv</span><span class="p">[</span><span class="n">type</span><span class="o">-&gt;</span><span class="n">Slot</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">Slot</span><span class="p">];</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="c1">// units available?</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">&gt;=</span> <span class="n">autt</span><span class="o">-&gt;</span><span class="n">Count</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">lua_pushboolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">lua_pushboolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>AiGetPendingBuilds</summary>
                        <p><br>  Get number of active build requests for a unit type.<br><br>  @param l  Lua State.<br><br>  @return   Number of return values</p>
                          <details>
                          <summary>/ai/script_ai.cpp:702 CclAiPendingBuildCount</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclAiPendingBuildCount</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">const</span> <span class="n">CUnitType</span> <span class="o">*</span><span class="n">type</span> <span class="o">=</span> <span class="n">CclGetUnitType</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>

	<span class="c1">// The assumption of this function is that UnitTypeBuilt will be always be</span>
	<span class="c1">// fairly small so we iterate each time instead of doing any caching</span>
	<span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="nl">b</span> <span class="p">:</span> <span class="n">AiPlayer</span><span class="o">-&gt;</span><span class="n">UnitTypeBuilt</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">b</span><span class="p">.</span><span class="n">Type</span> <span class="o">==</span> <span class="n">type</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">lua_pushinteger</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">b</span><span class="p">.</span><span class="n">Want</span><span class="p">);</span>
			<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="n">lua_pushinteger</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>AiForce</summary>
                        <p><br>  Define a force, a groups of units.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/ai/script_ai.cpp:780 CclAiForce</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclAiForce</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">bool</span> <span class="n">resetForce</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">arg</span> <span class="o">=</span> <span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="n">Assert</span><span class="p">(</span><span class="mi">0</span> <span class="o">&lt;</span> <span class="n">arg</span> <span class="o">&amp;&amp;</span> <span class="n">arg</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">arg</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">resetForce</span> <span class="o">=</span> <span class="n">LuaToBoolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="kt">int</span> <span class="n">force</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">force</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">force</span> <span class="o">&gt;=</span> <span class="n">AI_MAX_FORCE_INTERNAL</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Force out of range: %d&quot;</span> <span class="n">_C_</span> <span class="n">force</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">AiForce</span> <span class="o">&amp;</span><span class="n">aiforce</span> <span class="o">=</span> <span class="n">AiPlayer</span><span class="o">-&gt;</span><span class="n">Force</span><span class="p">[</span><span class="n">AiPlayer</span><span class="o">-&gt;</span><span class="n">Force</span><span class="p">.</span><span class="n">getScriptForce</span><span class="p">(</span><span class="n">force</span><span class="p">)];</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">resetForce</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">aiforce</span><span class="p">.</span><span class="n">Reset</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">AiForceRole</span> <span class="n">role</span> <span class="o">=</span> <span class="n">aiforce</span><span class="p">.</span><span class="n">Role</span><span class="p">;</span>
	<span class="n">aiforce</span><span class="p">.</span><span class="n">State</span> <span class="o">=</span> <span class="n">AiForceAttackingState_Waiting</span><span class="p">;</span>
	<span class="n">aiforce</span><span class="p">.</span><span class="n">Role</span> <span class="o">=</span> <span class="n">role</span><span class="p">;</span>

	<span class="kt">int</span> <span class="n">args</span> <span class="o">=</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">args</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="n">CUnitType</span> <span class="o">*</span><span class="n">type</span> <span class="o">=</span> <span class="n">CclGetUnitType</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
		<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
		<span class="o">++</span><span class="n">j</span><span class="p">;</span>
		<span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>

		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">type</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// bulletproof</span>
			<span class="k">continue</span><span class="p">;</span>
		<span class="p">}</span>

		<span class="c1">// Use the equivalent unittype.</span>
		<span class="n">type</span> <span class="o">=</span> <span class="n">UnitTypes</span><span class="p">[</span><span class="n">UnitTypeEquivs</span><span class="p">[</span><span class="n">type</span><span class="o">-&gt;</span><span class="n">Slot</span><span class="p">]];</span>

		<span class="k">if</span> <span class="p">(</span><span class="n">resetForce</span><span class="p">)</span> <span class="p">{</span>
			<span class="c1">// Append it.</span>
			<span class="n">AiUnitType</span> <span class="n">newaiut</span><span class="p">;</span>
			<span class="n">newaiut</span><span class="p">.</span><span class="n">Want</span> <span class="o">=</span> <span class="n">count</span><span class="p">;</span>
			<span class="n">newaiut</span><span class="p">.</span><span class="n">Type</span> <span class="o">=</span> <span class="n">type</span><span class="p">;</span>
			<span class="n">aiforce</span><span class="p">.</span><span class="n">UnitTypes</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">newaiut</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="c1">// Look if already in force.</span>
			<span class="kt">size_t</span> <span class="n">i</span><span class="p">;</span>
			<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">aiforce</span><span class="p">.</span><span class="n">UnitTypes</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">AiUnitType</span> <span class="o">*</span><span class="n">aiut</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">aiforce</span><span class="p">.</span><span class="n">UnitTypes</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">aiut</span><span class="o">-&gt;</span><span class="n">Type</span><span class="o">-&gt;</span><span class="n">Slot</span> <span class="o">==</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">Slot</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// found</span>
					<span class="k">if</span> <span class="p">(</span><span class="n">count</span><span class="p">)</span> <span class="p">{</span>
						<span class="n">aiut</span><span class="o">-&gt;</span><span class="n">Want</span> <span class="o">=</span> <span class="n">count</span><span class="p">;</span>
					<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
						<span class="n">aiforce</span><span class="p">.</span><span class="n">UnitTypes</span><span class="p">.</span><span class="n">erase</span><span class="p">(</span><span class="n">aiforce</span><span class="p">.</span><span class="n">UnitTypes</span><span class="p">.</span><span class="n">begin</span><span class="p">()</span> <span class="o">+</span> <span class="n">i</span><span class="p">);</span>
					<span class="p">}</span>
					<span class="k">break</span><span class="p">;</span>
				<span class="p">}</span>
			<span class="p">}</span>
			<span class="c1">// New type append it.</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="n">aiforce</span><span class="p">.</span><span class="n">UnitTypes</span><span class="p">.</span><span class="n">size</span><span class="p">())</span> <span class="p">{</span>
				<span class="n">AiUnitType</span> <span class="n">newaiut</span><span class="p">;</span>
				<span class="n">newaiut</span><span class="p">.</span><span class="n">Want</span> <span class="o">=</span> <span class="n">count</span><span class="p">;</span>
				<span class="n">newaiut</span><span class="p">.</span><span class="n">Type</span> <span class="o">=</span> <span class="n">type</span><span class="p">;</span>
				<span class="n">aiforce</span><span class="p">.</span><span class="n">UnitTypes</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">newaiut</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span>

	<span class="p">}</span>
	<span class="n">AiAssignFreeUnitsToForce</span><span class="p">(</span><span class="n">force</span><span class="p">);</span>
	<span class="n">lua_pushboolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>AiReleaseForce</summary>
                        <p><br>  Release force.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/ai/script_ai.cpp:834 CclAiReleaseForce</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclAiReleaseForce</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="kt">int</span> <span class="n">force</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">force</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">force</span> <span class="o">&gt;=</span> <span class="n">AI_MAX_FORCE_INTERNAL</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Force out of range: %d&quot;</span> <span class="n">_C_</span> <span class="n">force</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">AI_MAX_FORCE_INTERNAL</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">AI_MAX_FORCES</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">AiPlayer</span><span class="o">-&gt;</span><span class="n">Force</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">FormerForce</span> <span class="o">!=</span> <span class="mi">-1</span> <span class="o">&amp;&amp;</span> <span class="n">AiPlayer</span><span class="o">-&gt;</span><span class="n">Force</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">FormerForce</span> <span class="o">==</span> <span class="n">force</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">while</span> <span class="p">(</span><span class="n">AiPlayer</span><span class="o">-&gt;</span><span class="n">Force</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">Size</span><span class="p">())</span> <span class="p">{</span>
				<span class="n">CUnit</span> <span class="o">&amp;</span><span class="n">aiunit</span> <span class="o">=</span> <span class="o">*</span><span class="n">AiPlayer</span><span class="o">-&gt;</span><span class="n">Force</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">Units</span><span class="p">[</span><span class="n">AiPlayer</span><span class="o">-&gt;</span><span class="n">Force</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">Size</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">];</span>
				<span class="n">aiunit</span><span class="p">.</span><span class="n">GroupId</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
				<span class="n">AiPlayer</span><span class="o">-&gt;</span><span class="n">Force</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">Units</span><span class="p">.</span><span class="n">Remove</span><span class="p">(</span><span class="o">&amp;</span><span class="n">aiunit</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="n">AiPlayer</span><span class="o">-&gt;</span><span class="n">Force</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">Reset</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="n">lua_pushboolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>AiForceRole</summary>
                        <p><br>  Define the role of a force.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/ai/script_ai.cpp:807 CclAiForceRole</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclAiForceRole</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="kt">int</span> <span class="n">force</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">force</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">force</span> <span class="o">&gt;=</span> <span class="n">AI_MAX_FORCE_INTERNAL</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Force %i out of range&quot;</span> <span class="n">_C_</span> <span class="n">force</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="n">AiForce</span> <span class="o">&amp;</span><span class="n">aiforce</span> <span class="o">=</span> <span class="n">AiPlayer</span><span class="o">-&gt;</span><span class="n">Force</span><span class="p">[</span><span class="n">AiPlayer</span><span class="o">-&gt;</span><span class="n">Force</span><span class="p">.</span><span class="n">getScriptForce</span><span class="p">(</span><span class="n">force</span><span class="p">)];</span>

	<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">flag</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">flag</span><span class="p">,</span> <span class="s">&quot;attack&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">aiforce</span><span class="p">.</span><span class="n">Role</span> <span class="o">=</span> <span class="n">AiForceRoleAttack</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">flag</span><span class="p">,</span> <span class="s">&quot;defend&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">aiforce</span><span class="p">.</span><span class="n">Role</span> <span class="o">=</span> <span class="n">AiForceRoleDefend</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Unknown force role &#39;%s&#39;&quot;</span> <span class="n">_C_</span> <span class="n">flag</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">lua_pushboolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>AiCheckForce</summary>
                        <p><br>  Check if a force ready.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/ai/script_ai.cpp:854 CclAiCheckForce</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclAiCheckForce</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="kt">int</span> <span class="n">force</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">force</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">force</span> <span class="o">&gt;=</span> <span class="n">AI_MAX_FORCE_INTERNAL</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">lua_pushfstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Force out of range: %d&quot;</span><span class="p">,</span> <span class="n">force</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">AiPlayer</span><span class="o">-&gt;</span><span class="n">Force</span><span class="p">[</span><span class="n">AiPlayer</span><span class="o">-&gt;</span><span class="n">Force</span><span class="p">.</span><span class="n">getScriptForce</span><span class="p">(</span><span class="n">force</span><span class="p">)].</span><span class="n">Completed</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">lua_pushboolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">lua_pushboolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>AiWaitForce</summary>
                        <p><br>  Wait for a force ready.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/ai/script_ai.cpp:879 CclAiWaitForce</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclAiWaitForce</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="kt">int</span> <span class="n">force</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">force</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">force</span> <span class="o">&gt;=</span> <span class="n">AI_MAX_FORCE_INTERNAL</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">lua_pushfstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Force out of range: %d&quot;</span><span class="p">,</span> <span class="n">force</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">AiPlayer</span><span class="o">-&gt;</span><span class="n">Force</span><span class="p">[</span><span class="n">AiPlayer</span><span class="o">-&gt;</span><span class="n">Force</span><span class="p">.</span><span class="n">getScriptForce</span><span class="p">(</span><span class="n">force</span><span class="p">)].</span><span class="n">Completed</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">lua_pushboolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>
<span class="cp">#if 0</span><span class="c"></span>
<span class="c">	// Debuging</span>
<span class="c">	AiRemoveDeadUnitInForces();</span>
<span class="c">	Assert(!AiPlayer-&gt;Force.getScriptForce(f).Completed);</span>
<span class="cp">#endif</span>
	<span class="n">lua_pushboolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>AiAttackWithForce</summary>
                        <p><br>  Attack with force.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/ai/script_ai.cpp:896 CclAiAttackWithForce</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclAiAttackWithForce</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="kt">int</span> <span class="n">force</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">force</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">force</span> <span class="o">&gt;=</span> <span class="n">AI_MAX_FORCE_INTERNAL</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Force out of range: %d&quot;</span> <span class="n">_C_</span> <span class="n">force</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">AiAttackWithForce</span><span class="p">(</span><span class="n">force</span><span class="p">);</span>
	<span class="n">lua_pushboolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>AiSleep</summary>
                        <p><br>  Sleep n cycles.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/ai/script_ai.cpp:973 CclAiSleep</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclAiSleep</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">AiPlayer</span><span class="o">-&gt;</span><span class="n">SleepCycles</span> <span class="o">||</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">AiPlayer</span><span class="o">-&gt;</span><span class="n">SleepCycles</span> <span class="o">&lt;</span> <span class="n">GameCycle</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">AiPlayer</span><span class="o">-&gt;</span><span class="n">SleepCycles</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">lua_pushboolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
			<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">AiPlayer</span><span class="o">-&gt;</span><span class="n">SleepCycles</span> <span class="o">=</span> <span class="n">GameCycle</span> <span class="o">+</span> <span class="n">i</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">lua_pushboolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>AiResearch</summary>
                        <p><br>  Research an upgrade.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/ai/script_ai.cpp:995 CclAiResearch</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclAiResearch</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">str</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">CUpgrade</span> <span class="o">*</span><span class="n">upgrade</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">str</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">upgrade</span> <span class="o">=</span> <span class="n">CUpgrade</span><span class="o">::</span><span class="n">Get</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Upgrade needed&quot;</span><span class="p">);</span>
		<span class="n">upgrade</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">InsertResearchRequests</span><span class="p">(</span><span class="n">upgrade</span><span class="p">);</span>
	<span class="n">lua_pushboolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>AiUpgradeTo</summary>
                        <p><br>  Upgrade an unit to an new unit-type.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/ai/script_ai.cpp:1010 CclAiUpgradeTo</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclAiUpgradeTo</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">CUnitType</span> <span class="o">*</span><span class="n">type</span> <span class="o">=</span> <span class="n">CclGetUnitType</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="n">InsertUpgradeToRequests</span><span class="p">(</span><span class="n">type</span><span class="p">);</span>

	<span class="n">lua_pushboolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>AiPlayer</summary>
                        <p><br>  Return the player of the running AI.<br><br>  @param l  Lua state.<br><br>  @return  Player number of the AI.</p>
                          <details>
                          <summary>/ai/script_ai.cpp:1024 CclAiPlayer</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclAiPlayer</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">AiPlayer</span><span class="o">-&gt;</span><span class="n">Player</span><span class="o">-&gt;</span><span class="n">Index</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>AiSetReserve</summary>
                        <p><br>  Set AI player resource reserve.<br><br>  @param l  Lua state.<br><br>  @return     Old resource vector</p>
                          <details>
                          <summary>/ai/script_ai.cpp:1048 CclAiSetReserve</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclAiSetReserve</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">lua_newtable</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">MaxCosts</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">AiPlayer</span><span class="o">-&gt;</span><span class="n">Reserve</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
		<span class="n">lua_rawseti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-2</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">MaxCosts</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">AiPlayer</span><span class="o">-&gt;</span><span class="n">Reserve</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>AiSetCollect</summary>
                        <p><br>  Set AI player resource collect percent.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/ai/script_ai.cpp:1065 CclAiSetCollect</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclAiSetCollect</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">MaxCosts</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">AiPlayer</span><span class="o">-&gt;</span><span class="n">Collect</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>AiSetBuildDepots</summary>
                        <p><br>  Set AI player build.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/ai/script_ai.cpp:1080 CclAiSetBuildDepots</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclAiSetBuildDepots</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_isboolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">AiPlayer</span><span class="o">-&gt;</span><span class="n">BuildDepots</span> <span class="o">=</span> <span class="n">LuaToBoolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>AiDump</summary>
                        <p><br>  Dump some AI debug information.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/ai/script_ai.cpp:1153 CclAiDump</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclAiDump</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">p</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">p</span> <span class="o">&lt;</span> <span class="n">PlayerMax</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="o">++</span><span class="n">p</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">CPlayer</span> <span class="o">&amp;</span><span class="n">aip</span> <span class="o">=</span> <span class="n">Players</span><span class="p">[</span><span class="n">p</span><span class="p">];</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">aip</span><span class="p">.</span><span class="n">AiEnabled</span><span class="p">)</span> <span class="p">{</span>
			<span class="c1">//</span>
			<span class="c1">// Script</span>
			<span class="c1">//</span>

			<span class="n">printf</span><span class="p">(</span><span class="s">&quot;------</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">MaxCosts</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">printf</span><span class="p">(</span><span class="s">&quot;%s(%4d, %4d/%4d) &quot;</span><span class="p">,</span> <span class="n">DefaultResourceNames</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">c_str</span><span class="p">(),</span>
					   <span class="n">aip</span><span class="p">.</span><span class="n">Resources</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">aip</span><span class="p">.</span><span class="n">StoredResources</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">aip</span><span class="p">.</span><span class="n">MaxResources</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
			<span class="p">}</span>
			<span class="n">printf</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
			<span class="n">printf</span><span class="p">(</span><span class="s">&quot;Player %d:&quot;</span><span class="p">,</span> <span class="n">aip</span><span class="p">.</span><span class="n">Index</span><span class="p">);</span>
<span class="cp">#if 0</span><span class="c"></span>
<span class="c">			gh_display(gh_car(AiPlayer-&gt;Script));</span>
<span class="cp">#endif</span>
			<span class="c1">//</span>
			<span class="c1">// Requests</span>
			<span class="c1">//</span>
			<span class="kt">size_t</span> <span class="n">n</span> <span class="o">=</span> <span class="n">aip</span><span class="p">.</span><span class="n">Ai</span><span class="o">-&gt;</span><span class="n">UnitTypeRequests</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
			<span class="n">printf</span><span class="p">(</span><span class="s">&quot;UnitTypeRequests(%u):</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">n</span><span class="p">));</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">printf</span><span class="p">(</span><span class="s">&quot;%s &quot;</span><span class="p">,</span> <span class="n">aip</span><span class="p">.</span><span class="n">Ai</span><span class="o">-&gt;</span><span class="n">UnitTypeRequests</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">Type</span><span class="o">-&gt;</span><span class="n">Ident</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
			<span class="p">}</span>
			<span class="n">printf</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
			<span class="n">n</span> <span class="o">=</span> <span class="n">aip</span><span class="p">.</span><span class="n">Ai</span><span class="o">-&gt;</span><span class="n">UpgradeToRequests</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
			<span class="n">printf</span><span class="p">(</span><span class="s">&quot;UpgradeToRequests(%u):</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">n</span><span class="p">));</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">printf</span><span class="p">(</span><span class="s">&quot;%s &quot;</span><span class="p">,</span> <span class="n">aip</span><span class="p">.</span><span class="n">Ai</span><span class="o">-&gt;</span><span class="n">UpgradeToRequests</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">Ident</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
			<span class="p">}</span>
			<span class="n">printf</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
			<span class="n">n</span> <span class="o">=</span> <span class="n">aip</span><span class="p">.</span><span class="n">Ai</span><span class="o">-&gt;</span><span class="n">ResearchRequests</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
			<span class="n">printf</span><span class="p">(</span><span class="s">&quot;ResearchRequests(%u):</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">n</span><span class="p">));</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">printf</span><span class="p">(</span><span class="s">&quot;%s &quot;</span><span class="p">,</span> <span class="n">aip</span><span class="p">.</span><span class="n">Ai</span><span class="o">-&gt;</span><span class="n">ResearchRequests</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">Ident</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
			<span class="p">}</span>
			<span class="n">printf</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>

			<span class="c1">// Building queue</span>
			<span class="n">printf</span><span class="p">(</span><span class="s">&quot;Building queue:</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">aip</span><span class="p">.</span><span class="n">Ai</span><span class="o">-&gt;</span><span class="n">UnitTypeBuilt</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">const</span> <span class="n">AiBuildQueue</span> <span class="o">&amp;</span><span class="n">queue</span> <span class="o">=</span> <span class="n">aip</span><span class="p">.</span><span class="n">Ai</span><span class="o">-&gt;</span><span class="n">UnitTypeBuilt</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
				<span class="n">printf</span><span class="p">(</span><span class="s">&quot;%s(%d/%d) &quot;</span><span class="p">,</span> <span class="n">queue</span><span class="p">.</span><span class="n">Type</span><span class="o">-&gt;</span><span class="n">Ident</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span> <span class="n">queue</span><span class="p">.</span><span class="n">Made</span><span class="p">,</span> <span class="n">queue</span><span class="p">.</span><span class="n">Want</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="n">printf</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>

			<span class="c1">// PrintForce</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">aip</span><span class="p">.</span><span class="n">Ai</span><span class="o">-&gt;</span><span class="n">Force</span><span class="p">.</span><span class="n">Size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">printf</span><span class="p">(</span><span class="s">&quot;Force(%u%s%s):</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">i</span><span class="p">),</span>
					   <span class="n">aip</span><span class="p">.</span><span class="n">Ai</span><span class="o">-&gt;</span><span class="n">Force</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">Completed</span> <span class="o">?</span> <span class="s">&quot;,complete&quot;</span> <span class="o">:</span> <span class="s">&quot;,recruit&quot;</span><span class="p">,</span>
					   <span class="n">aip</span><span class="p">.</span><span class="n">Ai</span><span class="o">-&gt;</span><span class="n">Force</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">Attacking</span> <span class="o">?</span> <span class="s">&quot;,attack&quot;</span> <span class="o">:</span> <span class="s">&quot;&quot;</span><span class="p">);</span>
				<span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">aip</span><span class="p">.</span><span class="n">Ai</span><span class="o">-&gt;</span><span class="n">Force</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">UnitTypes</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
					<span class="k">const</span> <span class="n">AiUnitType</span> <span class="o">&amp;</span><span class="n">aut</span> <span class="o">=</span> <span class="n">aip</span><span class="p">.</span><span class="n">Ai</span><span class="o">-&gt;</span><span class="n">Force</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">UnitTypes</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
					<span class="n">printf</span><span class="p">(</span><span class="s">&quot;%s(%d) &quot;</span><span class="p">,</span> <span class="n">aut</span><span class="p">.</span><span class="n">Type</span><span class="o">-&gt;</span><span class="n">Ident</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span> <span class="n">aut</span><span class="p">.</span><span class="n">Want</span><span class="p">);</span>
				<span class="p">}</span>
				<span class="n">printf</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="n">printf</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="n">lua_pushboolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>DefineAiPlayer</summary>
                        <p><br> Define an AI player.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/ai/script_ai.cpp:1441 CclDefineAiPlayer</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclDefineAiPlayer</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">playerIdx</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>

	<span class="n">Assert</span><span class="p">(</span><span class="n">playerIdx</span> <span class="o">&lt;=</span> <span class="n">PlayerMax</span><span class="p">);</span>
	<span class="n">DebugPrint</span><span class="p">(</span><span class="s">&quot;%p %d</span><span class="se">\n</span><span class="s">&quot;</span> <span class="n">_C_</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">)</span><span class="n">Players</span><span class="p">[</span><span class="n">playerIdx</span><span class="p">].</span><span class="n">Ai</span> <span class="n">_C_</span> <span class="n">Players</span><span class="p">[</span><span class="n">playerIdx</span><span class="p">].</span><span class="n">AiEnabled</span><span class="p">);</span>
	<span class="c1">// FIXME: lose this:</span>
	<span class="c1">// Assert(!Players[playerIdx].Ai &amp;&amp; Players[playerIdx].AiEnabled);</span>

	<span class="n">PlayerAi</span> <span class="o">*</span><span class="n">ai</span> <span class="o">=</span> <span class="n">Players</span><span class="p">[</span><span class="n">playerIdx</span><span class="p">].</span><span class="n">Ai</span> <span class="o">=</span> <span class="k">new</span> <span class="n">PlayerAi</span><span class="p">;</span>
	<span class="n">ai</span><span class="o">-&gt;</span><span class="n">Player</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">Players</span><span class="p">[</span><span class="n">playerIdx</span><span class="p">];</span>

	<span class="c1">// Parse the list: (still everything could be changed!)</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">args</span> <span class="o">=</span> <span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">args</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="o">++</span><span class="n">j</span><span class="p">;</span>

		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;ai-type&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">aiName</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="n">CAiType</span> <span class="o">*</span><span class="n">ait</span> <span class="o">=</span> <span class="n">GetAiTypesByName</span><span class="p">(</span><span class="n">aiName</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">ait</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;ai-type not found: %s&quot;</span> <span class="n">_C_</span> <span class="n">aiName</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="n">ai</span><span class="o">-&gt;</span><span class="n">AiType</span> <span class="o">=</span> <span class="n">ait</span><span class="p">;</span>
			<span class="n">ai</span><span class="o">-&gt;</span><span class="n">Script</span> <span class="o">=</span> <span class="n">ait</span><span class="o">-&gt;</span><span class="n">Script</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;script&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">ai</span><span class="o">-&gt;</span><span class="n">Script</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;script-debug&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">ai</span><span class="o">-&gt;</span><span class="n">ScriptDebug</span> <span class="o">=</span> <span class="n">LuaToBoolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;sleep-cycles&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">ai</span><span class="o">-&gt;</span><span class="n">SleepCycles</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;force&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="k">const</span> <span class="kt">int</span> <span class="n">subargs</span> <span class="o">=</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="k">const</span> <span class="kt">int</span> <span class="n">cclforceIdx</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
			<span class="n">UNUSED</span><span class="p">(</span><span class="n">cclforceIdx</span><span class="p">);</span>
			<span class="k">const</span> <span class="kt">int</span> <span class="n">forceIdx</span> <span class="o">=</span> <span class="n">ai</span><span class="o">-&gt;</span><span class="n">Force</span><span class="p">.</span><span class="n">FindFreeForce</span><span class="p">(</span><span class="n">AiForceRoleDefault</span><span class="p">);</span>

			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">subargs</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="o">++</span><span class="n">k</span><span class="p">;</span>
				<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;complete&quot;</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">ai</span><span class="o">-&gt;</span><span class="n">Force</span><span class="p">[</span><span class="n">forceIdx</span><span class="p">].</span><span class="n">Completed</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
					<span class="o">--</span><span class="n">k</span><span class="p">;</span>
				<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;recruit&quot;</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">ai</span><span class="o">-&gt;</span><span class="n">Force</span><span class="p">[</span><span class="n">forceIdx</span><span class="p">].</span><span class="n">Completed</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
					<span class="o">--</span><span class="n">k</span><span class="p">;</span>
				<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;attack&quot;</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">ai</span><span class="o">-&gt;</span><span class="n">Force</span><span class="p">[</span><span class="n">forceIdx</span><span class="p">].</span><span class="n">Attacking</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
					<span class="o">--</span><span class="n">k</span><span class="p">;</span>
				<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;defend&quot;</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">ai</span><span class="o">-&gt;</span><span class="n">Force</span><span class="p">[</span><span class="n">forceIdx</span><span class="p">].</span><span class="n">Defending</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
					<span class="o">--</span><span class="n">k</span><span class="p">;</span>
				<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;role&quot;</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
					<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;attack&quot;</span><span class="p">))</span> <span class="p">{</span>
						<span class="n">ai</span><span class="o">-&gt;</span><span class="n">Force</span><span class="p">[</span><span class="n">forceIdx</span><span class="p">].</span><span class="n">Role</span> <span class="o">=</span> <span class="n">AiForceRoleAttack</span><span class="p">;</span>
					<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;defend&quot;</span><span class="p">))</span> <span class="p">{</span>
						<span class="n">ai</span><span class="o">-&gt;</span><span class="n">Force</span><span class="p">[</span><span class="n">forceIdx</span><span class="p">].</span><span class="n">Role</span> <span class="o">=</span> <span class="n">AiForceRoleDefend</span><span class="p">;</span>
					<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
						<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Unsupported force tag: %s&quot;</span> <span class="n">_C_</span> <span class="n">value</span><span class="p">);</span>
					<span class="p">}</span>
				<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;types&quot;</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
					<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">))</span> <span class="p">{</span>
						<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
					<span class="p">}</span>
					<span class="k">const</span> <span class="kt">int</span> <span class="n">subsubargs</span> <span class="o">=</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
					<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">subk</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">subk</span> <span class="o">&lt;</span> <span class="n">subsubargs</span><span class="p">;</span> <span class="o">++</span><span class="n">subk</span><span class="p">)</span> <span class="p">{</span>
						<span class="k">const</span> <span class="kt">int</span> <span class="n">num</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">subk</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
						<span class="o">++</span><span class="n">subk</span><span class="p">;</span>
						<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">ident</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">subk</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
						<span class="n">AiUnitType</span> <span class="n">queue</span><span class="p">;</span>

						<span class="n">queue</span><span class="p">.</span><span class="n">Want</span> <span class="o">=</span> <span class="n">num</span><span class="p">;</span>
						<span class="n">queue</span><span class="p">.</span><span class="n">Type</span> <span class="o">=</span> <span class="n">UnitTypeByIdent</span><span class="p">(</span><span class="n">ident</span><span class="p">);</span>
						<span class="n">ai</span><span class="o">-&gt;</span><span class="n">Force</span><span class="p">[</span><span class="n">forceIdx</span><span class="p">].</span><span class="n">UnitTypes</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">queue</span><span class="p">);</span>
					<span class="p">}</span>
					<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
				<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;units&quot;</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
					<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">))</span> <span class="p">{</span>
						<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
					<span class="p">}</span>
					<span class="k">const</span> <span class="kt">int</span> <span class="n">subsubargs</span> <span class="o">=</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
					<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">subk</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">subk</span> <span class="o">&lt;</span> <span class="n">subsubargs</span><span class="p">;</span> <span class="o">++</span><span class="n">subk</span><span class="p">)</span> <span class="p">{</span>
						<span class="k">const</span> <span class="kt">int</span> <span class="n">num</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">subk</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
						<span class="o">++</span><span class="n">subk</span><span class="p">;</span>
<span class="cp">#if 0</span><span class="c"></span>
<span class="c">						const char *ident = LuaToString(l, -1, subk + 1);</span>
<span class="c">						UNUSED(ident);</span>
<span class="cp">#endif</span>
						<span class="n">ai</span><span class="o">-&gt;</span><span class="n">Force</span><span class="p">[</span><span class="n">forceIdx</span><span class="p">].</span><span class="n">Units</span><span class="p">.</span><span class="n">Insert</span><span class="p">(</span><span class="o">&amp;</span><span class="n">UnitManager</span><span class="p">.</span><span class="n">GetSlotUnit</span><span class="p">(</span><span class="n">num</span><span class="p">));</span>
					<span class="p">}</span>
					<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
				<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;state&quot;</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">ai</span><span class="o">-&gt;</span><span class="n">Force</span><span class="p">[</span><span class="n">forceIdx</span><span class="p">].</span><span class="n">State</span> <span class="o">=</span> <span class="n">AiForceAttackingState</span><span class="p">(</span><span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">));</span>
				<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;goalx&quot;</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">ai</span><span class="o">-&gt;</span><span class="n">Force</span><span class="p">[</span><span class="n">forceIdx</span><span class="p">].</span><span class="n">GoalPos</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;goaly&quot;</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">ai</span><span class="o">-&gt;</span><span class="n">Force</span><span class="p">[</span><span class="n">forceIdx</span><span class="p">].</span><span class="n">GoalPos</span><span class="p">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;must-transport&quot;</span><span class="p">))</span> <span class="p">{</span>
					<span class="c1">// Keep for backward compatibility</span>
				<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
					<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Unsupported tag: %s&quot;</span> <span class="n">_C_</span> <span class="n">value</span><span class="p">);</span>
				<span class="p">}</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;reserve&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="k">const</span> <span class="kt">int</span> <span class="n">subargs</span> <span class="o">=</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">subargs</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">type</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="o">++</span><span class="n">k</span><span class="p">;</span>
				<span class="kt">int</span> <span class="n">num</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="k">const</span> <span class="kt">int</span> <span class="n">resId</span> <span class="o">=</span> <span class="n">GetResourceIdByName</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">type</span><span class="p">);</span>
				<span class="n">ai</span><span class="o">-&gt;</span><span class="n">Reserve</span><span class="p">[</span><span class="n">resId</span><span class="p">]</span> <span class="o">=</span> <span class="n">num</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;used&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="k">const</span> <span class="kt">int</span> <span class="n">subargs</span> <span class="o">=</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">subargs</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">type</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="o">++</span><span class="n">k</span><span class="p">;</span>
				<span class="k">const</span> <span class="kt">int</span> <span class="n">num</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="k">const</span> <span class="kt">int</span> <span class="n">resId</span> <span class="o">=</span> <span class="n">GetResourceIdByName</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">type</span><span class="p">);</span>
				<span class="n">ai</span><span class="o">-&gt;</span><span class="n">Used</span><span class="p">[</span><span class="n">resId</span><span class="p">]</span> <span class="o">=</span> <span class="n">num</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;needed&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="k">const</span> <span class="kt">int</span> <span class="n">subargs</span> <span class="o">=</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">subargs</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">type</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="o">++</span><span class="n">k</span><span class="p">;</span>
				<span class="k">const</span> <span class="kt">int</span> <span class="n">num</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="k">const</span> <span class="kt">int</span> <span class="n">resId</span> <span class="o">=</span> <span class="n">GetResourceIdByName</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">type</span><span class="p">);</span>
				<span class="n">ai</span><span class="o">-&gt;</span><span class="n">Needed</span><span class="p">[</span><span class="n">resId</span><span class="p">]</span> <span class="o">=</span> <span class="n">num</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;collect&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="k">const</span> <span class="kt">int</span> <span class="n">subargs</span> <span class="o">=</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">subargs</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">type</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="o">++</span><span class="n">k</span><span class="p">;</span>
				<span class="k">const</span> <span class="kt">int</span> <span class="n">num</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="k">const</span> <span class="kt">int</span> <span class="n">resId</span> <span class="o">=</span> <span class="n">GetResourceIdByName</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">type</span><span class="p">);</span>
				<span class="n">ai</span><span class="o">-&gt;</span><span class="n">Collect</span><span class="p">[</span><span class="n">resId</span><span class="p">]</span> <span class="o">=</span> <span class="n">num</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;need-mask&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="k">const</span> <span class="kt">int</span> <span class="n">subargs</span> <span class="o">=</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">subargs</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">type</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="k">const</span> <span class="kt">int</span> <span class="n">resId</span> <span class="o">=</span> <span class="n">GetResourceIdByName</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">type</span><span class="p">);</span>
				<span class="n">ai</span><span class="o">-&gt;</span><span class="n">NeededMask</span> <span class="o">|=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">resId</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;need-supply&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">ai</span><span class="o">-&gt;</span><span class="n">NeedSupply</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
			<span class="o">--</span><span class="n">j</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;exploration&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="k">const</span> <span class="kt">int</span> <span class="n">subargs</span> <span class="o">=</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">subargs</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">Vec2i</span> <span class="n">pos</span><span class="p">;</span>

				<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">)</span> <span class="o">||</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
				<span class="p">}</span>
				<span class="n">pos</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
				<span class="n">pos</span><span class="p">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
				<span class="k">const</span> <span class="kt">int</span> <span class="n">mask</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
				<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
				<span class="n">AiExplorationRequest</span> <span class="nf">queue</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">mask</span><span class="p">);</span>
				<span class="n">ai</span><span class="o">-&gt;</span><span class="n">FirstExplorationRequest</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">queue</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;last-exploration-cycle&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">ai</span><span class="o">-&gt;</span><span class="n">LastExplorationGameCycle</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;last-can-not-move-cycle&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">ai</span><span class="o">-&gt;</span><span class="n">LastCanNotMoveGameCycle</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;unit-type&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="k">const</span> <span class="kt">int</span> <span class="n">subargs</span> <span class="o">=</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">subargs</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">ai</span><span class="o">-&gt;</span><span class="n">UnitTypeRequests</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">subargs</span> <span class="o">/</span> <span class="mi">2</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">subargs</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">ident</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="o">++</span><span class="n">k</span><span class="p">;</span>
				<span class="k">const</span> <span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="n">ai</span><span class="o">-&gt;</span><span class="n">UnitTypeRequests</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">Type</span> <span class="o">=</span> <span class="n">UnitTypeByIdent</span><span class="p">(</span><span class="n">ident</span><span class="p">);</span>
				<span class="n">ai</span><span class="o">-&gt;</span><span class="n">UnitTypeRequests</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">Count</span> <span class="o">=</span> <span class="n">count</span><span class="p">;</span>
				<span class="o">++</span><span class="n">i</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;upgrade&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="k">const</span> <span class="kt">int</span> <span class="n">subargs</span> <span class="o">=</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">subargs</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">ident</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="n">ai</span><span class="o">-&gt;</span><span class="n">UpgradeToRequests</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">UnitTypeByIdent</span><span class="p">(</span><span class="n">ident</span><span class="p">));</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;research&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="k">const</span> <span class="kt">int</span> <span class="n">subargs</span> <span class="o">=</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">subargs</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">ident</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="n">ai</span><span class="o">-&gt;</span><span class="n">ResearchRequests</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">CUpgrade</span><span class="o">::</span><span class="n">Get</span><span class="p">(</span><span class="n">ident</span><span class="p">));</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;building&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">CclParseBuildQueue</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">ai</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;repair-building&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">ai</span><span class="o">-&gt;</span><span class="n">LastRepairBuilding</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Unsupported tag: %s&quot;</span> <span class="n">_C_</span> <span class="n">value</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>AiAttackWithForces</summary>
                        <p><br>  Attack with forces.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/ai/script_ai.cpp:951 CclAiAttackWithForces</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclAiAttackWithForces</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">Forces</span><span class="p">[</span><span class="n">AI_MAX_FORCE_INTERNAL</span> <span class="o">+</span> <span class="mi">1</span><span class="p">];</span>

	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="kt">int</span> <span class="n">args</span> <span class="o">=</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">args</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">const</span> <span class="kt">int</span> <span class="n">force</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>

		<span class="k">if</span> <span class="p">(</span><span class="n">force</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">force</span> <span class="o">&gt;=</span> <span class="n">AI_MAX_FORCE_INTERNAL</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">lua_pushfstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Force out of range: %d&quot;</span><span class="p">,</span> <span class="n">force</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="n">Forces</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">AiPlayer</span><span class="o">-&gt;</span><span class="n">Force</span><span class="p">.</span><span class="n">getScriptForce</span><span class="p">(</span><span class="n">force</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">Forces</span><span class="p">[</span><span class="n">args</span><span class="p">]</span> <span class="o">=</span> <span class="mi">-1</span><span class="p">;</span>
	<span class="n">AiAttackWithForces</span><span class="p">(</span><span class="n">Forces</span><span class="p">);</span>
	<span class="n">lua_pushboolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>AiWaitForces</summary>
                        <p><br>  Wait for a forces ready.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/ai/script_ai.cpp:923 CclAiWaitForces</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclAiWaitForces</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">args</span> <span class="o">=</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">args</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">const</span> <span class="kt">int</span> <span class="n">force</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>

		<span class="k">if</span> <span class="p">(</span><span class="n">force</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">force</span> <span class="o">&gt;=</span> <span class="n">AI_MAX_FORCE_INTERNAL</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">lua_pushfstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Force out of range: %d&quot;</span><span class="p">,</span> <span class="n">force</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">AiPlayer</span><span class="o">-&gt;</span><span class="n">Force</span><span class="p">[</span><span class="n">AiPlayer</span><span class="o">-&gt;</span><span class="n">Force</span><span class="p">.</span><span class="n">getScriptForce</span><span class="p">(</span><span class="n">force</span><span class="p">)].</span><span class="n">Completed</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">lua_pushboolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
			<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="n">lua_pushboolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>AiProcessorSetup</summary>
                        <p><br> AiProcessorSetup(host, port, number_of_state_variables, number_of_actions)<br><br> Connect to an AI agent running at host:port, that will consume<br> number_of_state_variables every step and select one of number_of_actions.</p>
                          <details>
                          <summary>/ai/script_ai.cpp:1474 CclAiProcessorSetup</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclAiProcessorSetup</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">InitNetwork1</span><span class="p">();</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
	<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">host</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="kt">int</span> <span class="n">port</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="kt">int</span> <span class="n">stateDim</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
	<span class="kt">int</span> <span class="n">actionDim</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>

	<span class="n">CHost</span> <span class="nf">h</span><span class="p">(</span><span class="n">host</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span> <span class="n">port</span><span class="p">);</span>
	<span class="n">CTCPSocket</span> <span class="o">*</span><span class="n">s</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CTCPSocket</span><span class="p">();</span>
	<span class="n">s</span><span class="o">-&gt;</span><span class="n">Open</span><span class="p">(</span><span class="n">CHost</span><span class="p">());</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">-&gt;</span><span class="n">Connect</span><span class="p">(</span><span class="n">h</span><span class="p">))</span> <span class="p">{</span>
		<span class="kt">char</span> <span class="n">buf</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
		<span class="n">buf</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="sc">&#39;I&#39;</span><span class="p">;</span>
		<span class="n">buf</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="kt">uint8_t</span><span class="p">)</span><span class="n">stateDim</span><span class="p">;</span>
		<span class="n">buf</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="kt">uint8_t</span><span class="p">)</span><span class="n">actionDim</span><span class="p">;</span>
		<span class="n">s</span><span class="o">-&gt;</span><span class="n">Send</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
		<span class="n">lua_pushlightuserdata</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">s</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">delete</span> <span class="n">s</span><span class="p">;</span>
	<span class="n">lua_pushnil</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>AiProcessorStep</summary>
                        <p><br> AiProcessorStep(handle, reward_since_last_call, table_of_state_variables)</p>
                          <details>
                          <summary>/ai/script_ai.cpp:1529 CclAiProcessorStep</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclAiProcessorStep</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="c1">// A single step in a reinforcement learning network</span>

	<span class="c1">// We receive the current env and current reward in the arguments</span>

	<span class="c1">// We need to return the next action.</span>

	<span class="c1">// The next call to this function will be the updated state, reward for the</span>
	<span class="c1">// last action</span>

	<span class="n">CTCPSocket</span> <span class="o">*</span><span class="n">s</span> <span class="o">=</span> <span class="n">AiProcessorSendState</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="sc">&#39;S&#39;</span><span class="p">);</span>
	<span class="kt">int</span> <span class="n">action</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">s</span><span class="o">-&gt;</span><span class="n">Recv</span><span class="p">(</span><span class="o">&amp;</span><span class="n">action</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">action</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span> <span class="c1">// +1 since lua tables are 1-indexed</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>AiProcessorEnd</summary>
                        <p>/ai/script_ai.cpp:1537 CclAiProcessorEnd</p>
                        <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclAiProcessorEnd</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">CTCPSocket</span> <span class="o">*</span><span class="n">s</span> <span class="o">=</span> <span class="n">AiProcessorSendState</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="sc">&#39;E&#39;</span><span class="p">);</span>
	<span class="n">s</span><span class="o">-&gt;</span><span class="n">Close</span><span class="p">();</span>
	<span class="k">delete</span> <span class="n">s</span><span class="p">;</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                        </details>
                        <hr>/map/script_map.cpp<hr>
                        <details>
                        <summary>StratagusMap</summary>
                        <p><br>  Parse a map.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/map/script_map.cpp:128 CclStratagusMap</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclStratagusMap</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">args</span> <span class="o">=</span> <span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">args</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="o">++</span><span class="n">j</span><span class="p">;</span>

		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;version&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="kt">char</span> <span class="n">buf</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span>

			<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">version</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="n">strncpy</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="n">VERSION</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">buf</span><span class="p">));</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">strcmp</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="n">version</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;Warning not saved with this version.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;uid&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">Map</span><span class="p">.</span><span class="n">Info</span><span class="p">.</span><span class="n">MapUID</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;description&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">Map</span><span class="p">.</span><span class="n">Info</span><span class="p">.</span><span class="n">Description</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;the-map&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="kt">int</span> <span class="n">subargs</span> <span class="o">=</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">subargs</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="o">++</span><span class="n">k</span><span class="p">;</span>

				<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;size&quot;</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
					<span class="n">CclGetPos</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">Map</span><span class="p">.</span><span class="n">Info</span><span class="p">.</span><span class="n">MapWidth</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">Map</span><span class="p">.</span><span class="n">Info</span><span class="p">.</span><span class="n">MapHeight</span><span class="p">);</span>
					<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

					<span class="k">delete</span><span class="p">[]</span> <span class="n">Map</span><span class="p">.</span><span class="n">Fields</span><span class="p">;</span>
					<span class="n">Map</span><span class="p">.</span><span class="n">Fields</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CMapField</span><span class="p">[</span><span class="n">Map</span><span class="p">.</span><span class="n">Info</span><span class="p">.</span><span class="n">MapWidth</span> <span class="o">*</span> <span class="n">Map</span><span class="p">.</span><span class="n">Info</span><span class="p">.</span><span class="n">MapHeight</span><span class="p">];</span>
					<span class="c1">// FIXME: this should be CreateMap or InitMap?</span>
				<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;fog-of-war&quot;</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">Map</span><span class="p">.</span><span class="n">NoFogOfWar</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
					<span class="o">--</span><span class="n">k</span><span class="p">;</span>
				<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;no-fog-of-war&quot;</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">Map</span><span class="p">.</span><span class="n">NoFogOfWar</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
					<span class="o">--</span><span class="n">k</span><span class="p">;</span>
				<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;filename&quot;</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">Map</span><span class="p">.</span><span class="n">Info</span><span class="p">.</span><span class="n">Filename</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;map-fields&quot;</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
					<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">))</span> <span class="p">{</span>
						<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
					<span class="p">}</span>
					<span class="k">const</span> <span class="kt">int</span> <span class="n">subsubargs</span> <span class="o">=</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
					<span class="k">if</span> <span class="p">(</span><span class="n">subsubargs</span> <span class="o">!=</span> <span class="n">Map</span><span class="p">.</span><span class="n">Info</span><span class="p">.</span><span class="n">MapWidth</span> <span class="o">*</span> <span class="n">Map</span><span class="p">.</span><span class="n">Info</span><span class="p">.</span><span class="n">MapHeight</span><span class="p">)</span> <span class="p">{</span>
						<span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;Wrong tile table length: %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">subsubargs</span><span class="p">);</span>
					<span class="p">}</span>
					<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">subsubargs</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
						<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
						<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">))</span> <span class="p">{</span>
							<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
						<span class="p">}</span>
						<span class="n">Map</span><span class="p">.</span><span class="n">Fields</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">parse</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
						<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
					<span class="p">}</span>
					<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
				<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
					<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Unsupported tag: %s&quot;</span> <span class="n">_C_</span> <span class="n">value</span><span class="p">);</span>
				<span class="p">}</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Unsupported tag: %s&quot;</span> <span class="n">_C_</span> <span class="n">value</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>RevealMap</summary>
                        <p><br>  Reveal the complete map.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/map/script_map.cpp:144 CclRevealMap</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclRevealMap</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">CclInConfigFile</span> <span class="o">||</span> <span class="o">!</span><span class="n">Map</span><span class="p">.</span><span class="n">Fields</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">FlagRevealMap</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">Map</span><span class="p">.</span><span class="n">Reveal</span><span class="p">();</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>CenterMap</summary>
                        <p><br>  Center the map.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/map/script_map.cpp:158 CclCenterMap</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclCenterMap</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="k">const</span> <span class="n">Vec2i</span> <span class="n">pos</span><span class="p">(</span><span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">));</span>

	<span class="n">UI</span><span class="p">.</span><span class="n">SelectedViewport</span><span class="o">-&gt;</span><span class="n">Center</span><span class="p">(</span><span class="n">Map</span><span class="p">.</span><span class="n">TilePosToMapPixelPos_Center</span><span class="p">(</span><span class="n">pos</span><span class="p">));</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SetStartView</summary>
                        <p><br>  Define the starting viewpoint for a given player.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/map/script_map.cpp:174 CclSetStartView</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetStartView</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>

	<span class="k">const</span> <span class="kt">int</span> <span class="n">p</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">Players</span><span class="p">[</span><span class="n">p</span><span class="p">].</span><span class="n">StartPos</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="n">Players</span><span class="p">[</span><span class="n">p</span><span class="p">].</span><span class="n">StartPos</span><span class="p">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>ShowMapLocation</summary>
                        <p><br>  Show Map Location<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/map/script_map.cpp:205 CclShowMapLocation</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclShowMapLocation</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="c1">// Put a unit on map, use its properties, except for</span>
	<span class="c1">// what is listed below</span>

	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
	<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">unitname</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>
	<span class="n">CUnitType</span> <span class="o">*</span><span class="n">unitType</span> <span class="o">=</span> <span class="n">UnitTypeByIdent</span><span class="p">(</span><span class="n">unitname</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">unitType</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">DebugPrint</span><span class="p">(</span><span class="s">&quot;Unable to find UnitType &#39;%s&#39;&quot;</span> <span class="n">_C_</span> <span class="n">unitname</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">CUnit</span> <span class="o">*</span><span class="n">target</span> <span class="o">=</span> <span class="n">MakeUnit</span><span class="p">(</span><span class="o">*</span><span class="n">unitType</span><span class="p">,</span> <span class="n">ThisPlayer</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">target</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">target</span><span class="o">-&gt;</span><span class="n">Variable</span><span class="p">[</span><span class="n">HP_INDEX</span><span class="p">].</span><span class="n">Value</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">target</span><span class="o">-&gt;</span><span class="n">tilePos</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
		<span class="n">target</span><span class="o">-&gt;</span><span class="n">tilePos</span><span class="p">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
		<span class="n">target</span><span class="o">-&gt;</span><span class="n">TTL</span> <span class="o">=</span> <span class="n">GameCycle</span> <span class="o">+</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
		<span class="n">target</span><span class="o">-&gt;</span><span class="n">CurrentSightRange</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
		<span class="n">MapMarkUnitSight</span><span class="p">(</span><span class="o">*</span><span class="n">target</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">DebugPrint</span><span class="p">(</span><span class="s">&quot;Unable to allocate Unit&quot;</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SetTileSize</summary>
                        <p><br>  Define size in pixels (x,y) of a tile in this game<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/map/script_map.cpp:342 CclSetTileSize</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetTileSize</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="n">PixelTileSize</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">PixelTileSize</span><span class="p">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SetFogOfWar</summary>
                        <p><br>  Set fog of war on/off.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/map/script_map.cpp:222 CclSetFogOfWar</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetFogOfWar</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">Map</span><span class="p">.</span><span class="n">NoFogOfWar</span> <span class="o">=</span> <span class="o">!</span><span class="n">LuaToBoolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">CclInConfigFile</span> <span class="o">&amp;&amp;</span> <span class="n">Map</span><span class="p">.</span><span class="n">Fields</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">UpdateFogOfWarChange</span><span class="p">();</span>
		<span class="c1">// FIXME: save setting in replay log</span>
		<span class="c1">//CommandLog(&quot;input&quot;, NoUnitP, FlushCommands, -1, -1, NoUnitP, &quot;fow off&quot;, -1);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>GetFogOfWar</summary>
                        <p>/map/script_map.cpp:229 CclGetFogOfWar</p>
                        <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclGetFogOfWar</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="n">lua_pushboolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="o">!</span><span class="n">Map</span><span class="p">.</span><span class="n">NoFogOfWar</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                        </details>
                        
                        <details>
                        <summary>SetMinimapTerrain</summary>
                        <p><br>  Enable display of terrain in minimap.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/map/script_map.cpp:241 CclSetMinimapTerrain</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetMinimapTerrain</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">UI</span><span class="p">.</span><span class="n">Minimap</span><span class="p">.</span><span class="n">WithTerrain</span> <span class="o">=</span> <span class="n">LuaToBoolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SetFogOfWarGraphics</summary>
                        <p><br>  Define Fog graphics<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/map/script_map.cpp:329 CclSetFogOfWarGraphics</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetFogOfWarGraphics</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">FogGraphicFile</span><span class="p">;</span>

	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">FogGraphicFile</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">CMap</span><span class="o">::</span><span class="n">FogGraphic</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">CGraphic</span><span class="o">::</span><span class="n">Free</span><span class="p">(</span><span class="n">CMap</span><span class="o">::</span><span class="n">FogGraphic</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">CMap</span><span class="o">::</span><span class="n">FogGraphic</span> <span class="o">=</span> <span class="n">CGraphic</span><span class="o">::</span><span class="n">New</span><span class="p">(</span><span class="n">FogGraphicFile</span><span class="p">,</span> <span class="n">PixelTileSize</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">PixelTileSize</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SetFogOfWarOpacity</summary>
                        <p><br>  Fog of war opacity.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/map/script_map.cpp:263 CclSetFogOfWarOpacity</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetFogOfWarOpacity</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">255</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">PrintFunction</span><span class="p">();</span>
		<span class="n">fprintf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="s">&quot;Opacity should be 0 - 256</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
		<span class="n">i</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">FogOfWarOpacity</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">CclInConfigFile</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">Map</span><span class="p">.</span><span class="n">Init</span><span class="p">();</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SetFogOfWarColor</summary>
                        <p><br>  Set Fog color.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/map/script_map.cpp:310 CclSetFogOfWarColor</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetFogOfWarColor</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
	<span class="kt">int</span> <span class="n">r</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="kt">int</span> <span class="n">g</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="kt">int</span> <span class="n">b</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">((</span><span class="n">r</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">r</span> <span class="o">&gt;</span> <span class="mi">255</span><span class="p">)</span> <span class="o">||</span>
		<span class="p">(</span><span class="n">g</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">g</span> <span class="o">&gt;</span> <span class="mi">255</span><span class="p">)</span> <span class="o">||</span>
		<span class="p">(</span><span class="n">b</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">b</span> <span class="o">&gt;</span> <span class="mi">255</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Arguments must be in the range 0-255&quot;</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">FogOfWarColor</span><span class="p">.</span><span class="n">R</span> <span class="o">=</span> <span class="n">r</span><span class="p">;</span>
	<span class="n">FogOfWarColor</span><span class="p">.</span><span class="n">G</span> <span class="o">=</span> <span class="n">g</span><span class="p">;</span>
	<span class="n">FogOfWarColor</span><span class="p">.</span><span class="n">B</span> <span class="o">=</span> <span class="n">b</span><span class="p">;</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SetForestRegeneration</summary>
                        <p><br>  Set forest regeneration speed.<br><br>  @param l  Lua state.<br><br>  @return   Old speed</p>
                          <details>
                          <summary>/map/script_map.cpp:286 CclSetForestRegeneration</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetForestRegeneration</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">255</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">PrintFunction</span><span class="p">();</span>
		<span class="n">fprintf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="s">&quot;Regeneration speed should be 0 - 255</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
		<span class="n">i</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">old</span> <span class="o">=</span> <span class="n">ForestRegeneration</span><span class="p">;</span>
	<span class="n">ForestRegeneration</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>

	<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">old</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>LoadTileModels</summary>
                        <p><br> Load the lua file which will define the tile models<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/map/script_map.cpp:432 CclLoadTileModels</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclLoadTileModels</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">Map</span><span class="p">.</span><span class="n">TileModelsFileName</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">filename</span> <span class="o">=</span> <span class="n">LibraryFileName</span><span class="p">(</span><span class="n">Map</span><span class="p">.</span><span class="n">TileModelsFileName</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">LuaLoadFile</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="o">==</span> <span class="mi">-1</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">DebugPrint</span><span class="p">(</span><span class="s">&quot;Load failed: %s</span><span class="se">\n</span><span class="s">&quot;</span> <span class="n">_C_</span> <span class="n">filename</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>DefinePlayerTypes</summary>
                        <p><br>  Define the type of each player available for the map<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/map/script_map.cpp:414 CclDefinePlayerTypes</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclDefinePlayerTypes</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">numplayers</span> <span class="o">=</span> <span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">);</span> <span class="cm">/* Number of players == number of arguments */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">numplayers</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Not enough players&quot;</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">numplayers</span> <span class="o">&amp;&amp;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">PlayerMax</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">lua_isnil</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">numplayers</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">type</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="s">&quot;neutral&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">Map</span><span class="p">.</span><span class="n">Info</span><span class="p">.</span><span class="n">PlayerType</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">PlayerNeutral</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="s">&quot;nobody&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">Map</span><span class="p">.</span><span class="n">Info</span><span class="p">.</span><span class="n">PlayerType</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">PlayerNobody</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="s">&quot;computer&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">Map</span><span class="p">.</span><span class="n">Info</span><span class="p">.</span><span class="n">PlayerType</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">PlayerComputer</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="s">&quot;person&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">Map</span><span class="p">.</span><span class="n">Info</span><span class="p">.</span><span class="n">PlayerType</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">PlayerPerson</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="s">&quot;rescue-passive&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">Map</span><span class="p">.</span><span class="n">Info</span><span class="p">.</span><span class="n">PlayerType</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">PlayerRescuePassive</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="s">&quot;rescue-active&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">Map</span><span class="p">.</span><span class="n">Info</span><span class="p">.</span><span class="n">PlayerType</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">PlayerRescueActive</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Unsupported tag: %s&quot;</span> <span class="n">_C_</span> <span class="n">type</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">numplayers</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">PlayerMax</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">Map</span><span class="p">.</span><span class="n">Info</span><span class="p">.</span><span class="n">PlayerType</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">PlayerNobody</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">numplayers</span> <span class="o">&lt;</span> <span class="n">PlayerMax</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">Map</span><span class="p">.</span><span class="n">Info</span><span class="p">.</span><span class="n">PlayerType</span><span class="p">[</span><span class="n">PlayerMax</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">PlayerNeutral</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>DefineTileset</summary>
                        <p><br>  Define tileset<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/map/script_map.cpp:450 CclDefineTileset</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclDefineTileset</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">Map</span><span class="p">.</span><span class="n">Tileset</span><span class="o">-&gt;</span><span class="n">parse</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>

	<span class="c1">//  Load and prepare the tileset</span>
	<span class="n">PixelTileSize</span> <span class="o">=</span> <span class="n">Map</span><span class="p">.</span><span class="n">Tileset</span><span class="o">-&gt;</span><span class="n">getPixelTileSize</span><span class="p">();</span>

	<span class="n">ShowLoadProgress</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Tileset &#39;%s&#39;&quot;</span><span class="p">),</span> <span class="n">Map</span><span class="p">.</span><span class="n">Tileset</span><span class="o">-&gt;</span><span class="n">ImageFile</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
	<span class="n">Map</span><span class="p">.</span><span class="n">TileGraphic</span> <span class="o">=</span> <span class="n">CGraphic</span><span class="o">::</span><span class="n">New</span><span class="p">(</span><span class="n">Map</span><span class="p">.</span><span class="n">Tileset</span><span class="o">-&gt;</span><span class="n">ImageFile</span><span class="p">,</span> <span class="n">PixelTileSize</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">PixelTileSize</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>
	<span class="n">Map</span><span class="p">.</span><span class="n">TileGraphic</span><span class="o">-&gt;</span><span class="n">Load</span><span class="p">();</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SetTileFlags</summary>
                        <p><br>  Set the flags like "water" for a tile of a tileset<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/map/script_map.cpp:489 CclSetTileFlags</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetTileFlags</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;No flags defined&quot;</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">tilenumber</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">tilenumber</span> <span class="o">&gt;=</span> <span class="n">Map</span><span class="p">.</span><span class="n">Tileset</span><span class="o">-&gt;</span><span class="n">tiles</span><span class="p">.</span><span class="n">size</span><span class="p">())</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Accessed a tile that&#39;s not defined&quot;</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">flags</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">newBase</span> <span class="o">=</span> <span class="n">Map</span><span class="p">.</span><span class="n">Tileset</span><span class="o">-&gt;</span><span class="n">parseTilesetTileFlags</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">flags</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">j</span><span class="p">);</span>
	<span class="n">Map</span><span class="p">.</span><span class="n">Tileset</span><span class="o">-&gt;</span><span class="n">tiles</span><span class="p">[</span><span class="n">tilenumber</span><span class="p">].</span><span class="n">flag</span> <span class="o">=</span> <span class="n">flags</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">newBase</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">Map</span><span class="p">.</span><span class="n">Tileset</span><span class="o">-&gt;</span><span class="n">tiles</span><span class="p">[</span><span class="n">tilenumber</span><span class="p">].</span><span class="n">tileinfo</span><span class="p">.</span><span class="n">BaseTerrain</span> <span class="o">=</span> <span class="n">newBase</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>BuildTilesetTables</summary>
                        <p><br> Build tileset tables like humanWallTable or mixedLookupTable<br><br> Called after DefineTileset and only for tilesets that have wall,<br> trees and rocks. This function will be deleted when removing<br> support of walls and alike in the tileset.</p>
                          <details>
                          <summary>/map/script_map.cpp:464 CclBuildTilesetTables</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclBuildTilesetTables</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

	<span class="n">Map</span><span class="p">.</span><span class="n">Tileset</span><span class="o">-&gt;</span><span class="n">buildTable</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>GetTileTerrainName</summary>
                        <p><br>  Get the name of the terrain of the tile.<br><br>  @param l  Lua state.<br><br>  @return   The name of the terrain of the tile.</p>
                          <details>
                          <summary>/map/script_map.cpp:512 CclGetTileTerrainName</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclGetTileTerrainName</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>

	<span class="k">const</span> <span class="n">Vec2i</span> <span class="n">pos</span><span class="p">(</span><span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">));</span>

	<span class="k">const</span> <span class="n">CMapField</span> <span class="o">&amp;</span><span class="n">mf</span> <span class="o">=</span> <span class="o">*</span><span class="n">Map</span><span class="p">.</span><span class="n">Field</span><span class="p">(</span><span class="n">pos</span><span class="p">);</span>
	<span class="k">const</span> <span class="n">CTileset</span> <span class="o">&amp;</span><span class="n">tileset</span> <span class="o">=</span> <span class="o">*</span><span class="n">Map</span><span class="p">.</span><span class="n">Tileset</span><span class="p">;</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="n">tileset</span><span class="p">.</span><span class="n">findTileIndexByTile</span><span class="p">(</span><span class="n">mf</span><span class="p">.</span><span class="n">getGraphicTile</span><span class="p">());</span>
	<span class="n">Assert</span><span class="p">(</span><span class="n">index</span> <span class="o">!=</span> <span class="mi">-1</span><span class="p">);</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">baseTerrainIdx</span> <span class="o">=</span> <span class="n">tileset</span><span class="p">.</span><span class="n">tiles</span><span class="p">[</span><span class="n">index</span><span class="p">].</span><span class="n">tileinfo</span><span class="p">.</span><span class="n">BaseTerrain</span><span class="p">;</span>

	<span class="n">lua_pushstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">tileset</span><span class="p">.</span><span class="n">getTerrainName</span><span class="p">(</span><span class="n">baseTerrainIdx</span><span class="p">).</span><span class="n">c_str</span><span class="p">());</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>GetTileTerrainHasFlag</summary>
                        <p><br>  Check if the tile's terrain has a particular flag.<br><br>  @param l  Lua state.<br><br>  @return   True if has the flag, false if not.</p>
                          <details>
                          <summary>/map/script_map.cpp:556 CclGetTileTerrainHasFlag</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclGetTileTerrainHasFlag</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>

	<span class="k">const</span> <span class="n">Vec2i</span> <span class="n">pos</span><span class="p">(</span><span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">));</span>

	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">flag</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">flag_name</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">flag_name</span><span class="p">,</span> <span class="s">&quot;water&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">flag</span> <span class="o">=</span> <span class="n">MapFieldWaterAllowed</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">flag_name</span><span class="p">,</span> <span class="s">&quot;land&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">flag</span> <span class="o">=</span> <span class="n">MapFieldLandAllowed</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">flag_name</span><span class="p">,</span> <span class="s">&quot;coast&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">flag</span> <span class="o">=</span> <span class="n">MapFieldCoastAllowed</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">flag_name</span><span class="p">,</span> <span class="s">&quot;no-building&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">flag</span> <span class="o">=</span> <span class="n">MapFieldNoBuilding</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">flag_name</span><span class="p">,</span> <span class="s">&quot;unpassable&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">flag</span> <span class="o">=</span> <span class="n">MapFieldUnpassable</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">flag_name</span><span class="p">,</span> <span class="s">&quot;wall&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">flag</span> <span class="o">=</span> <span class="n">MapFieldWall</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">flag_name</span><span class="p">,</span> <span class="s">&quot;rock&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">flag</span> <span class="o">=</span> <span class="n">MapFieldRocks</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">flag_name</span><span class="p">,</span> <span class="s">&quot;forest&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">flag</span> <span class="o">=</span> <span class="n">MapFieldForest</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">const</span> <span class="n">CMapField</span> <span class="o">&amp;</span><span class="n">mf</span> <span class="o">=</span> <span class="o">*</span><span class="n">Map</span><span class="p">.</span><span class="n">Field</span><span class="p">(</span><span class="n">pos</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">mf</span><span class="p">.</span><span class="n">getFlag</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">flag</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">lua_pushboolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">lua_pushboolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        <hr>/editor/script_editor.cpp<hr>
                        <details>
                        <summary>SetEditorSelectIcon</summary>
                        <p><br>  Set the editor's select icon<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/editor/script_editor.cpp:59 CclSetEditorSelectIcon</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetEditorSelectIcon</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">Editor</span><span class="p">.</span><span class="n">Select</span><span class="p">.</span><span class="n">Name</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SetEditorUnitsIcon</summary>
                        <p><br>  Set the editor's units icon<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/editor/script_editor.cpp:71 CclSetEditorUnitsIcon</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetEditorUnitsIcon</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">Editor</span><span class="p">.</span><span class="n">Units</span><span class="p">.</span><span class="n">Name</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SetEditorStartUnit</summary>
                        <p><br>  Set the editor's start location unit<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/editor/script_editor.cpp:83 CclSetEditorStartUnit</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetEditorStartUnit</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">Editor</span><span class="p">.</span><span class="n">StartUnitName</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        <hr>/spell/script_spell.cpp<hr>
                        <details>
                        <summary>DefineSpell</summary>
                        <p><br>  Parse Spell.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/spell/script_spell.cpp:419 CclDefineSpell</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclDefineSpell</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">args</span> <span class="o">=</span> <span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">identname</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">SpellType</span> <span class="o">*</span><span class="n">spell</span> <span class="o">=</span> <span class="n">SpellTypeByIdent</span><span class="p">(</span><span class="n">identname</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">spell</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">DebugPrint</span><span class="p">(</span><span class="s">&quot;Redefining spell-type &#39;%s&#39;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="n">_C_</span> <span class="n">identname</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">spell</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SpellType</span><span class="p">(</span><span class="n">SpellTypeTable</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span> <span class="n">identname</span><span class="p">);</span>
		<span class="k">for</span> <span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">CUnitType</span> <span class="o">*&gt;::</span><span class="n">size_type</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">UnitTypes</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// adjust array for caster already defined</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">UnitTypes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">CanCastSpell</span><span class="p">)</span> <span class="p">{</span>
				<span class="kt">char</span> <span class="o">*</span><span class="n">newc</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">char</span><span class="p">[(</span><span class="n">SpellTypeTable</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">char</span><span class="p">)];</span>
				<span class="n">memcpy</span><span class="p">(</span><span class="n">newc</span><span class="p">,</span> <span class="n">UnitTypes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">CanCastSpell</span><span class="p">,</span> <span class="n">SpellTypeTable</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">*</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">char</span><span class="p">));</span>
				<span class="k">delete</span><span class="p">[]</span> <span class="n">UnitTypes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">CanCastSpell</span><span class="p">;</span>
				<span class="n">UnitTypes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">CanCastSpell</span> <span class="o">=</span> <span class="n">newc</span><span class="p">;</span>
				<span class="n">UnitTypes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">CanCastSpell</span><span class="p">[</span><span class="n">SpellTypeTable</span><span class="p">.</span><span class="n">size</span><span class="p">()]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">UnitTypes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">AutoCastActive</span><span class="p">)</span> <span class="p">{</span>
				<span class="kt">char</span> <span class="o">*</span><span class="n">newc</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">char</span><span class="p">[(</span><span class="n">SpellTypeTable</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">char</span><span class="p">)];</span>
				<span class="n">memcpy</span><span class="p">(</span><span class="n">newc</span><span class="p">,</span> <span class="n">UnitTypes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">AutoCastActive</span><span class="p">,</span> <span class="n">SpellTypeTable</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">*</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">char</span><span class="p">));</span>
				<span class="k">delete</span><span class="p">[]</span> <span class="n">UnitTypes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">AutoCastActive</span><span class="p">;</span>
				<span class="n">UnitTypes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">AutoCastActive</span> <span class="o">=</span> <span class="n">newc</span><span class="p">;</span>
				<span class="n">UnitTypes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">AutoCastActive</span><span class="p">[</span><span class="n">SpellTypeTable</span><span class="p">.</span><span class="n">size</span><span class="p">()]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span>
		<span class="n">SpellTypeTable</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">spell</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">args</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="o">++</span><span class="n">i</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;showname&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">spell</span><span class="o">-&gt;</span><span class="n">Name</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;manacost&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">spell</span><span class="o">-&gt;</span><span class="n">ManaCost</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;cooldown&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">spell</span><span class="o">-&gt;</span><span class="n">CoolDown</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;res-cost&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="k">const</span> <span class="kt">int</span> <span class="n">len</span> <span class="o">=</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">len</span> <span class="o">!=</span> <span class="n">MaxCosts</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;resource table size isn&#39;t correct&quot;</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">len</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// exclude the time</span>
				<span class="n">spell</span><span class="o">-&gt;</span><span class="n">Costs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;range&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_isstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">lua_isnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">lua_isstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">lua_tostring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="s">&quot;infinite&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">spell</span><span class="o">-&gt;</span><span class="n">Range</span> <span class="o">=</span> <span class="n">INFINITE_RANGE</span><span class="p">;</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">lua_isnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">spell</span><span class="o">-&gt;</span><span class="n">Range</span> <span class="o">=</span> <span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">lua_tonumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">));</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Invalid range&quot;</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;repeat-cast&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">spell</span><span class="o">-&gt;</span><span class="n">RepeatCast</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="o">--</span><span class="n">i</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;force-use-animation&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">spell</span><span class="o">-&gt;</span><span class="n">ForceUseAnimation</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
			<span class="o">--</span><span class="n">i</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;target&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;self&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">spell</span><span class="o">-&gt;</span><span class="n">Target</span> <span class="o">=</span> <span class="n">TargetSelf</span><span class="p">;</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;unit&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">spell</span><span class="o">-&gt;</span><span class="n">Target</span> <span class="o">=</span> <span class="n">TargetUnit</span><span class="p">;</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;position&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">spell</span><span class="o">-&gt;</span><span class="n">Target</span> <span class="o">=</span> <span class="n">TargetPosition</span><span class="p">;</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Unsupported spell target type tag: %s&quot;</span> <span class="n">_C_</span> <span class="n">value</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;action&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="k">const</span> <span class="kt">int</span> <span class="n">subargs</span> <span class="o">=</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">subargs</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="n">spell</span><span class="o">-&gt;</span><span class="n">Action</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">CclSpellAction</span><span class="p">(</span><span class="n">l</span><span class="p">));</span>
				<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;condition&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">spell</span><span class="o">-&gt;</span><span class="n">Condition</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">spell</span><span class="o">-&gt;</span><span class="n">Condition</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ConditionInfo</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="n">CclSpellCondition</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">spell</span><span class="o">-&gt;</span><span class="n">Condition</span><span class="p">);</span>
			<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;autocast&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">spell</span><span class="o">-&gt;</span><span class="n">AutoCast</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">spell</span><span class="o">-&gt;</span><span class="n">AutoCast</span> <span class="o">=</span> <span class="k">new</span> <span class="n">AutoCastInfo</span><span class="p">();</span>
			<span class="p">}</span>
			<span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="n">CclSpellAutocast</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">spell</span><span class="o">-&gt;</span><span class="n">AutoCast</span><span class="p">);</span>
			<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;ai-cast&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">spell</span><span class="o">-&gt;</span><span class="n">AICast</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">spell</span><span class="o">-&gt;</span><span class="n">AICast</span> <span class="o">=</span> <span class="k">new</span> <span class="n">AutoCastInfo</span><span class="p">();</span>
			<span class="p">}</span>
			<span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="n">CclSpellAutocast</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">spell</span><span class="o">-&gt;</span><span class="n">AICast</span><span class="p">);</span>
			<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;sound-when-cast&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="c1">//  Free the old name, get the new one</span>
			<span class="n">spell</span><span class="o">-&gt;</span><span class="n">SoundWhenCast</span><span class="p">.</span><span class="n">Name</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="n">spell</span><span class="o">-&gt;</span><span class="n">SoundWhenCast</span><span class="p">.</span><span class="n">MapSound</span><span class="p">();</span>
			<span class="c1">//  Check for sound.</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">spell</span><span class="o">-&gt;</span><span class="n">SoundWhenCast</span><span class="p">.</span><span class="n">Sound</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">spell</span><span class="o">-&gt;</span><span class="n">SoundWhenCast</span><span class="p">.</span><span class="n">Name</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;depend-upgrade&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="n">spell</span><span class="o">-&gt;</span><span class="n">DependencyId</span> <span class="o">=</span> <span class="n">UpgradeIdByIdent</span><span class="p">(</span><span class="n">value</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">spell</span><span class="o">-&gt;</span><span class="n">DependencyId</span> <span class="o">==</span> <span class="mi">-1</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">lua_pushfstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Bad upgrade name: %s&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Unsupported tag: %s&quot;</span> <span class="n">_C_</span> <span class="n">value</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        <hr>/ui/script_ui.cpp<hr>
                        <details>
                        <summary>AddMessage</summary>
                        <p><br>  Add a new message.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/ui/script_ui.cpp:1154 CclAddMessage</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclAddMessage</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">SetMessage</span><span class="p">(</span><span class="s">&quot;%s&quot;</span><span class="p">,</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">));</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SetKeyScrollSpeed</summary>
                        <p><br>  Set speed of key scroll<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/ui/script_ui.cpp:81 CclSetKeyScrollSpeed</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetKeyScrollSpeed</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">UI</span><span class="p">.</span><span class="n">KeyScrollSpeed</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>GetKeyScrollSpeed</summary>
                        <p><br>  Get speed of key scroll<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/ui/script_ui.cpp:93 CclGetKeyScrollSpeed</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclGetKeyScrollSpeed</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">UI</span><span class="p">.</span><span class="n">KeyScrollSpeed</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SetMouseScrollSpeed</summary>
                        <p><br>  Set speed of mouse scroll<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/ui/script_ui.cpp:105 CclSetMouseScrollSpeed</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetMouseScrollSpeed</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">UI</span><span class="p">.</span><span class="n">MouseScrollSpeed</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>GetMouseScrollSpeed</summary>
                        <p><br>  Get speed of mouse scroll<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/ui/script_ui.cpp:117 CclGetMouseScrollSpeed</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclGetMouseScrollSpeed</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">UI</span><span class="p">.</span><span class="n">MouseScrollSpeed</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SetMouseScrollSpeedDefault</summary>
                        <p><br>  Set speed of middle-mouse scroll<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/ui/script_ui.cpp:129 CclSetMouseScrollSpeedDefault</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetMouseScrollSpeedDefault</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">UI</span><span class="p">.</span><span class="n">MouseScrollSpeedDefault</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>GetMouseScrollSpeedDefault</summary>
                        <p><br>  Get speed of middle-mouse scroll<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/ui/script_ui.cpp:141 CclGetMouseScrollSpeedDefault</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclGetMouseScrollSpeedDefault</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">UI</span><span class="p">.</span><span class="n">MouseScrollSpeedDefault</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SetMouseScrollSpeedControl</summary>
                        <p><br>  Set speed of ctrl-middle-mouse scroll<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/ui/script_ui.cpp:153 CclSetMouseScrollSpeedControl</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetMouseScrollSpeedControl</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">UI</span><span class="p">.</span><span class="n">MouseScrollSpeedControl</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>GetMouseScrollSpeedControl</summary>
                        <p><br>  Get speed of ctrl-middle-mouse scroll<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/ui/script_ui.cpp:165 CclGetMouseScrollSpeedControl</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclGetMouseScrollSpeedControl</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">UI</span><span class="p">.</span><span class="n">MouseScrollSpeedControl</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SetClickMissile</summary>
                        <p><br>  Set which missile is used for right click<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/ui/script_ui.cpp:183 CclSetClickMissile</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetClickMissile</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">args</span> <span class="o">=</span> <span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">args</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="o">||</span> <span class="p">(</span><span class="n">args</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_isnil</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">lua_isstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">))))</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">ClickMissile</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">args</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">lua_isnil</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">ClickMissile</span> <span class="o">=</span> <span class="n">lua_tostring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SetDamageMissile</summary>
                        <p><br>  Set which missile shows Damage<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/ui/script_ui.cpp:202 CclSetDamageMissile</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetDamageMissile</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">args</span> <span class="o">=</span> <span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">args</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="o">||</span> <span class="p">(</span><span class="n">args</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_isnil</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">lua_isstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">))))</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">DamageMissile</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">args</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">lua_isnil</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">DamageMissile</span> <span class="o">=</span> <span class="n">lua_tostring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SetVideoResolution</summary>
                        <p><br>  Set the video resolution.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/ui/script_ui.cpp:220 CclSetVideoResolution</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetVideoResolution</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">CclInConfigFile</span><span class="p">)</span> <span class="p">{</span>
		<span class="c1">// May have been set from the command line</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">Video</span><span class="p">.</span><span class="n">Width</span> <span class="o">||</span> <span class="o">!</span><span class="n">Video</span><span class="p">.</span><span class="n">Height</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">Video</span><span class="p">.</span><span class="n">Width</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
			<span class="n">Video</span><span class="p">.</span><span class="n">Height</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>GetVideoResolution</summary>
                        <p><br>  Get the video resolution.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/ui/script_ui.cpp:233 CclGetVideoResolution</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclGetVideoResolution</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">Video</span><span class="p">.</span><span class="n">Width</span><span class="p">);</span>
	<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">Video</span><span class="p">.</span><span class="n">Height</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SetVideoFullScreen</summary>
                        <p><br>  Set the video fullscreen mode.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/ui/script_ui.cpp:250 CclSetVideoFullScreen</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetVideoFullScreen</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">CclInConfigFile</span><span class="p">)</span> <span class="p">{</span>
		<span class="c1">// May have been set from the command line</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">VideoForceFullScreen</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">Video</span><span class="p">.</span><span class="n">FullScreen</span> <span class="o">=</span> <span class="n">LuaToBoolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>GetVideoFullScreen</summary>
                        <p><br>  Get the video fullscreen mode.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/ui/script_ui.cpp:262 CclGetVideoFullScreen</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclGetVideoFullScreen</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="n">lua_pushboolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">Video</span><span class="p">.</span><span class="n">FullScreen</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SetWindowSize</summary>
                        <p><br> Request a specific initial window size</p>
                          <details>
                          <summary>/ui/script_ui.cpp:278 CclSetWindowSize</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetWindowSize</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">CclInConfigFile</span><span class="p">)</span> <span class="p">{</span>
		<span class="c1">// May have been set from the command line</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">Video</span><span class="p">.</span><span class="n">WindowWidth</span> <span class="o">||</span> <span class="o">!</span><span class="n">Video</span><span class="p">.</span><span class="n">WindowHeight</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">Video</span><span class="p">.</span><span class="n">WindowWidth</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
			<span class="n">Video</span><span class="p">.</span><span class="n">WindowHeight</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SetVerticalPixelSize</summary>
                        <p><br> For games with non-square pixels, this sets the scale of vertical pixels versus horizontal pixels.<br> e.g., if your assets are 320x200, but you render at 320x240, this is 1.2.</p>
                          <details>
                          <summary>/ui/script_ui.cpp:292 CclSetVerticalPixelSize</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetVerticalPixelSize</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">CclInConfigFile</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">luaL_checktype</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">LUA_TNUMBER</span><span class="p">);</span>
		<span class="n">Video</span><span class="p">.</span><span class="n">VerticalPixelSize</span> <span class="o">=</span> <span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="p">(</span><span class="n">lua_tonumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">));</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SetTitleScreens</summary>
                        <p><br>  Default title screens.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/ui/script_ui.cpp:389 CclSetTitleScreens</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetTitleScreens</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">TitleScreens</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">TitleScreens</span><span class="p">[</span><span class="n">i</span><span class="p">];</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">delete</span> <span class="n">TitleScreens</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
		<span class="p">}</span>
		<span class="k">delete</span><span class="p">[]</span> <span class="n">TitleScreens</span><span class="p">;</span>
		<span class="n">TitleScreens</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">const</span> <span class="kt">int</span> <span class="n">args</span> <span class="o">=</span> <span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="n">TitleScreens</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TitleScreen</span> <span class="o">*</span><span class="p">[</span><span class="n">args</span> <span class="o">+</span> <span class="mi">1</span><span class="p">];</span>
	<span class="n">memset</span><span class="p">(</span><span class="n">TitleScreens</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">args</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">TitleScreen</span> <span class="o">*</span><span class="p">));</span>

	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">args</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="n">TitleScreens</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TitleScreen</span><span class="p">;</span>
		<span class="n">TitleScreens</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">Iterations</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="n">lua_pushnil</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
		<span class="k">while</span> <span class="p">(</span><span class="n">lua_next</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-2</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Image&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">TitleScreens</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">File</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Music&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">TitleScreens</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">Music</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Timeout&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">TitleScreens</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">Timeout</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Iterations&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">TitleScreens</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">Iterations</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Editor&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">TitleScreens</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">Editor</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Labels&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
				<span class="p">}</span>
				<span class="k">const</span> <span class="kt">int</span> <span class="n">subargs</span> <span class="o">=</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
				<span class="n">TitleScreens</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">Labels</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TitleScreenLabel</span> <span class="o">*</span><span class="p">[</span><span class="n">subargs</span> <span class="o">+</span> <span class="mi">1</span><span class="p">];</span>
				<span class="n">memset</span><span class="p">(</span><span class="n">TitleScreens</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">Labels</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">subargs</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">TitleScreenLabel</span> <span class="o">*</span><span class="p">));</span>
				<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">subargs</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
					<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">))</span> <span class="p">{</span>
						<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
					<span class="p">}</span>
					<span class="n">TitleScreens</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">Labels</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TitleScreenLabel</span><span class="p">;</span>
					<span class="n">lua_pushnil</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
					<span class="k">while</span> <span class="p">(</span><span class="n">lua_next</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-2</span><span class="p">))</span> <span class="p">{</span>
						<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-2</span><span class="p">);</span>
						<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Text&quot;</span><span class="p">))</span> <span class="p">{</span>
							<span class="n">TitleScreens</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">Labels</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">Text</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
						<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Font&quot;</span><span class="p">))</span> <span class="p">{</span>
							<span class="n">TitleScreens</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">Labels</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">Font</span> <span class="o">=</span> <span class="n">CFont</span><span class="o">::</span><span class="n">Get</span><span class="p">(</span><span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">));</span>
						<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Pos&quot;</span><span class="p">))</span> <span class="p">{</span>
							<span class="n">CclGetPos</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">TitleScreens</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">Labels</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">Xofs</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">TitleScreens</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">Labels</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">Yofs</span><span class="p">);</span>
						<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Flags&quot;</span><span class="p">))</span> <span class="p">{</span>
							<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">))</span> <span class="p">{</span>
								<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
							<span class="p">}</span>
							<span class="k">const</span> <span class="kt">int</span> <span class="n">subsubargs</span> <span class="o">=</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
							<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">subk</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">subk</span> <span class="o">&lt;</span> <span class="n">subsubargs</span><span class="p">;</span> <span class="o">++</span><span class="n">subk</span><span class="p">)</span> <span class="p">{</span>
								<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">subk</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
								<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;center&quot;</span><span class="p">))</span> <span class="p">{</span>
									<span class="n">TitleScreens</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">Labels</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">Flags</span> <span class="o">|=</span> <span class="n">TitleFlagCenter</span><span class="p">;</span>
								<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
									<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect flag&quot;</span><span class="p">);</span>
								<span class="p">}</span>
							<span class="p">}</span>
						<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
							<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Unsupported key: %s&quot;</span> <span class="n">_C_</span> <span class="n">value</span><span class="p">);</span>
						<span class="p">}</span>
						<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
					<span class="p">}</span>
					<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
				<span class="p">}</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Unsupported key: %s&quot;</span> <span class="n">_C_</span> <span class="n">value</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>ShowTitleScreens</summary>
                        <p>/ui/script_ui.cpp:300 CclShowTitleScreens</p>
                        <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclShowTitleScreens</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="n">ShowTitleScreens</span><span class="p">();</span>
	<span class="n">lua_pushboolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                        </details>
                        
                        <details>
                        <summary>DefinePanelContents</summary>
                        <p><br>  Define the Panels.<br>  Define what is shown in the panel(text, icon, variables)<br><br>  @param l  Lua state.<br>  @return   0.</p>
                          <details>
                          <summary>/ui/script_ui.cpp:573 CclDefinePanelContents</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclDefinePanelContents</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">nargs</span> <span class="o">=</span> <span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>

	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nargs</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">Assert</span><span class="p">(</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">));</span>
		<span class="n">CUnitInfoPanel</span> <span class="o">*</span><span class="n">infopanel</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CUnitInfoPanel</span><span class="p">;</span>

		<span class="k">for</span> <span class="p">(</span><span class="n">lua_pushnil</span><span class="p">(</span><span class="n">l</span><span class="p">);</span> <span class="n">lua_next</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span> <span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">key</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-2</span><span class="p">);</span>

			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s">&quot;Ident&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">infopanel</span><span class="o">-&gt;</span><span class="n">Name</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s">&quot;Pos&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">CclGetPos</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">infopanel</span><span class="o">-&gt;</span><span class="n">PosX</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">infopanel</span><span class="o">-&gt;</span><span class="n">PosY</span><span class="p">);</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s">&quot;DefaultFont&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">infopanel</span><span class="o">-&gt;</span><span class="n">DefaultFont</span> <span class="o">=</span> <span class="n">CFont</span><span class="o">::</span><span class="n">Get</span><span class="p">(</span><span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">));</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s">&quot;Condition&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">infopanel</span><span class="o">-&gt;</span><span class="n">Condition</span> <span class="o">=</span> <span class="n">ParseConditionPanel</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s">&quot;Contents&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">Assert</span><span class="p">(</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">));</span>
				<span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span> <span class="n">j</span><span class="o">++</span><span class="p">,</span> <span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
					<span class="n">infopanel</span><span class="o">-&gt;</span><span class="n">Contents</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">CclParseContent</span><span class="p">(</span><span class="n">l</span><span class="p">));</span>
				<span class="p">}</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;&#39;%s&#39; invalid for DefinePanelContents&quot;</span> <span class="n">_C_</span> <span class="n">key</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span>
		<span class="k">for</span> <span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">CContentType</span> <span class="o">*&gt;::</span><span class="n">iterator</span> <span class="n">content</span> <span class="o">=</span> <span class="n">infopanel</span><span class="o">-&gt;</span><span class="n">Contents</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span>
			 <span class="n">content</span> <span class="o">!=</span> <span class="n">infopanel</span><span class="o">-&gt;</span><span class="n">Contents</span><span class="p">.</span><span class="n">end</span><span class="p">();</span> <span class="o">++</span><span class="n">content</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// Default value for invalid value.</span>
			<span class="p">(</span><span class="o">*</span><span class="n">content</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">Pos</span><span class="p">.</span><span class="n">x</span> <span class="o">+=</span> <span class="n">infopanel</span><span class="o">-&gt;</span><span class="n">PosX</span><span class="p">;</span>
			<span class="p">(</span><span class="o">*</span><span class="n">content</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">Pos</span><span class="p">.</span><span class="n">y</span> <span class="o">+=</span> <span class="n">infopanel</span><span class="o">-&gt;</span><span class="n">PosY</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="kt">size_t</span> <span class="n">j</span><span class="p">;</span>
		<span class="k">for</span> <span class="p">(</span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">UI</span><span class="p">.</span><span class="n">InfoPanelContents</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">infopanel</span><span class="o">-&gt;</span><span class="n">Name</span> <span class="o">==</span> <span class="n">UI</span><span class="p">.</span><span class="n">InfoPanelContents</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">Name</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">DebugPrint</span><span class="p">(</span><span class="s">&quot;Redefinition of Panel &#39;%s&#39;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="n">_C_</span> <span class="n">infopanel</span><span class="o">-&gt;</span><span class="n">Name</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
				<span class="k">delete</span> <span class="n">UI</span><span class="p">.</span><span class="n">InfoPanelContents</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
				<span class="n">UI</span><span class="p">.</span><span class="n">InfoPanelContents</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">infopanel</span><span class="p">;</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">j</span> <span class="o">==</span> <span class="n">UI</span><span class="p">.</span><span class="n">InfoPanelContents</span><span class="p">.</span><span class="n">size</span><span class="p">())</span> <span class="p">{</span>
			<span class="n">UI</span><span class="p">.</span><span class="n">InfoPanelContents</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">infopanel</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>DefinePopup</summary>
                        <p><br>  Define the Panels.<br>  Define what is shown in the panel(text, icon, variables)<br><br>  @param l  Lua state.<br>  @return   0.</p>
                          <details>
                          <summary>/ui/script_ui.cpp:625 CclDefinePopup</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclDefinePopup</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">Assert</span><span class="p">(</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">));</span>

	<span class="n">CPopup</span> <span class="o">*</span><span class="n">popup</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CPopup</span><span class="p">;</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">lua_pushnil</span><span class="p">(</span><span class="n">l</span><span class="p">);</span> <span class="n">lua_next</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
		<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">key</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-2</span><span class="p">);</span>

		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s">&quot;Ident&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">popup</span><span class="o">-&gt;</span><span class="n">Ident</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s">&quot;DefaultFont&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">popup</span><span class="o">-&gt;</span><span class="n">DefaultFont</span> <span class="o">=</span> <span class="n">CFont</span><span class="o">::</span><span class="n">Get</span><span class="p">(</span><span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">));</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s">&quot;BackgroundColor&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">popup</span><span class="o">-&gt;</span><span class="n">BackgroundColor</span> <span class="o">=</span> <span class="n">LuaToUnsignedNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s">&quot;BorderColor&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">popup</span><span class="o">-&gt;</span><span class="n">BorderColor</span> <span class="o">=</span> <span class="n">LuaToUnsignedNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s">&quot;Margin&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">CclGetPos</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">popup</span><span class="o">-&gt;</span><span class="n">MarginX</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">popup</span><span class="o">-&gt;</span><span class="n">MarginY</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s">&quot;MinWidth&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">popup</span><span class="o">-&gt;</span><span class="n">MinWidth</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s">&quot;MinHeight&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">popup</span><span class="o">-&gt;</span><span class="n">MinHeight</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s">&quot;Contents&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">Assert</span><span class="p">(</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">));</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span> <span class="n">j</span><span class="o">++</span><span class="p">,</span> <span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="n">popup</span><span class="o">-&gt;</span><span class="n">Contents</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">CPopupContentType</span><span class="o">::</span><span class="n">ParsePopupContent</span><span class="p">(</span><span class="n">l</span><span class="p">));</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;&#39;%s&#39; invalid for DefinePopups&quot;</span> <span class="n">_C_</span> <span class="n">key</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">UI</span><span class="p">.</span><span class="n">ButtonPopups</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">popup</span><span class="o">-&gt;</span><span class="n">Ident</span> <span class="o">==</span> <span class="n">UI</span><span class="p">.</span><span class="n">ButtonPopups</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">Ident</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">DebugPrint</span><span class="p">(</span><span class="s">&quot;Redefinition of Popup &#39;%s&#39;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="n">_C_</span> <span class="n">popup</span><span class="o">-&gt;</span><span class="n">Ident</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
			<span class="k">delete</span> <span class="n">UI</span><span class="p">.</span><span class="n">ButtonPopups</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
			<span class="n">UI</span><span class="p">.</span><span class="n">ButtonPopups</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">popup</span><span class="p">;</span>
			<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="n">UI</span><span class="p">.</span><span class="n">ButtonPopups</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">popup</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>DefineViewports</summary>
                        <p><br>  Define the viewports.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/ui/script_ui.cpp:659 CclDefineViewports</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclDefineViewports</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">args</span> <span class="o">=</span> <span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>

	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">args</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="o">++</span><span class="n">j</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;mode&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">UI</span><span class="p">.</span><span class="n">ViewportMode</span> <span class="o">=</span> <span class="p">(</span><span class="n">ViewportModeType</span><span class="p">)</span><span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;viewport&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="n">UI</span><span class="p">.</span><span class="n">Viewports</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">MapPos</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
			<span class="n">UI</span><span class="p">.</span><span class="n">Viewports</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">MapPos</span><span class="p">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
			<span class="k">const</span> <span class="kt">int</span> <span class="n">slot</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">slot</span> <span class="o">!=</span> <span class="mi">-1</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">UI</span><span class="p">.</span><span class="n">Viewports</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">Unit</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">UnitManager</span><span class="p">.</span><span class="n">GetSlotUnit</span><span class="p">(</span><span class="n">slot</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="o">++</span><span class="n">i</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Unsupported tag: %s&quot;</span> <span class="n">_C_</span> <span class="n">value</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="n">UI</span><span class="p">.</span><span class="n">NumViewports</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>RightButtonAttacks</summary>
                        <p><br>  Fighter right button attacks as default.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/ui/script_ui.cpp:671 CclRightButtonAttacks</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclRightButtonAttacks</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="n">RightButtonAttacks</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>RightButtonMoves</summary>
                        <p><br>  Fighter right button moves as default.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/ui/script_ui.cpp:683 CclRightButtonMoves</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclRightButtonMoves</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="n">RightButtonAttacks</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SetFancyBuildings</summary>
                        <p><br>  Enable/disable the fancy buildings.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/ui/script_ui.cpp:695 CclSetFancyBuildings</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetFancyBuildings</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">FancyBuildings</span> <span class="o">=</span> <span class="n">LuaToBoolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>DefineButton</summary>
                        <p><br>  Define a button style<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/ui/script_ui.cpp:859 CclDefineButton</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclDefineButtonStyle</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">style</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">ButtonStyle</span> <span class="o">*&amp;</span><span class="n">b</span> <span class="o">=</span> <span class="n">ButtonStyleHash</span><span class="p">[</span><span class="n">style</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">b</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">b</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ButtonStyle</span><span class="p">;</span>
		<span class="c1">// Set to bogus value to see if it was set later</span>
		<span class="n">b</span><span class="o">-&gt;</span><span class="n">Default</span><span class="p">.</span><span class="n">TextPos</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">b</span><span class="o">-&gt;</span><span class="n">Hover</span><span class="p">.</span><span class="n">TextPos</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">b</span><span class="o">-&gt;</span><span class="n">Clicked</span><span class="p">.</span><span class="n">TextPos</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="mh">0xFFFFFF</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">lua_pushnil</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="k">while</span> <span class="p">(</span><span class="n">lua_next</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="p">{</span>
		<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-2</span><span class="p">);</span>

		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Size&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">CclGetPos</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">b</span><span class="o">-&gt;</span><span class="n">Width</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">b</span><span class="o">-&gt;</span><span class="n">Height</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Font&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">b</span><span class="o">-&gt;</span><span class="n">Font</span> <span class="o">=</span> <span class="n">CFont</span><span class="o">::</span><span class="n">Get</span><span class="p">(</span><span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">));</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;TextNormalColor&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">b</span><span class="o">-&gt;</span><span class="n">TextNormalColor</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;TextReverseColor&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">b</span><span class="o">-&gt;</span><span class="n">TextReverseColor</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;TextPos&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">CclGetPos</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">b</span><span class="o">-&gt;</span><span class="n">TextX</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">b</span><span class="o">-&gt;</span><span class="n">TextY</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;TextAlign&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Center&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">b</span><span class="o">-&gt;</span><span class="n">TextAlign</span> <span class="o">=</span> <span class="n">TextAlignCenter</span><span class="p">;</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Right&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">b</span><span class="o">-&gt;</span><span class="n">TextAlign</span> <span class="o">=</span> <span class="n">TextAlignRight</span><span class="p">;</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Left&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">b</span><span class="o">-&gt;</span><span class="n">TextAlign</span> <span class="o">=</span> <span class="n">TextAlignLeft</span><span class="p">;</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Invalid text alignment: %s&quot;</span> <span class="n">_C_</span> <span class="n">value</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Default&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">ParseButtonStyleProperties</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">b</span><span class="o">-&gt;</span><span class="n">Default</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Hover&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">ParseButtonStyleProperties</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">b</span><span class="o">-&gt;</span><span class="n">Hover</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Clicked&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">ParseButtonStyleProperties</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">b</span><span class="o">-&gt;</span><span class="n">Clicked</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Unsupported tag: %s&quot;</span> <span class="n">_C_</span> <span class="n">value</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">b</span><span class="o">-&gt;</span><span class="n">Default</span><span class="p">.</span><span class="n">TextPos</span><span class="p">.</span><span class="n">x</span> <span class="o">==</span> <span class="mh">0xFFFFFF</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">b</span><span class="o">-&gt;</span><span class="n">Default</span><span class="p">.</span><span class="n">TextPos</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">b</span><span class="o">-&gt;</span><span class="n">TextX</span><span class="p">;</span>
		<span class="n">b</span><span class="o">-&gt;</span><span class="n">Default</span><span class="p">.</span><span class="n">TextPos</span><span class="p">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">b</span><span class="o">-&gt;</span><span class="n">TextY</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">b</span><span class="o">-&gt;</span><span class="n">Hover</span><span class="p">.</span><span class="n">TextPos</span><span class="p">.</span><span class="n">x</span> <span class="o">==</span> <span class="mh">0xFFFFFF</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">b</span><span class="o">-&gt;</span><span class="n">Hover</span><span class="p">.</span><span class="n">TextPos</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">b</span><span class="o">-&gt;</span><span class="n">TextX</span><span class="p">;</span>
		<span class="n">b</span><span class="o">-&gt;</span><span class="n">Hover</span><span class="p">.</span><span class="n">TextPos</span><span class="p">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">b</span><span class="o">-&gt;</span><span class="n">TextY</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">b</span><span class="o">-&gt;</span><span class="n">Clicked</span><span class="p">.</span><span class="n">TextPos</span><span class="p">.</span><span class="n">x</span> <span class="o">==</span> <span class="mh">0xFFFFFF</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">b</span><span class="o">-&gt;</span><span class="n">Clicked</span><span class="p">.</span><span class="n">TextPos</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">b</span><span class="o">-&gt;</span><span class="n">TextX</span><span class="p">;</span>
		<span class="n">b</span><span class="o">-&gt;</span><span class="n">Clicked</span><span class="p">.</span><span class="n">TextPos</span><span class="p">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">b</span><span class="o">-&gt;</span><span class="n">TextY</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">b</span><span class="o">-&gt;</span><span class="n">Default</span><span class="p">.</span><span class="n">TextAlign</span> <span class="o">==</span> <span class="n">TextAlignUndefined</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">b</span><span class="o">-&gt;</span><span class="n">Default</span><span class="p">.</span><span class="n">TextAlign</span> <span class="o">=</span> <span class="n">b</span><span class="o">-&gt;</span><span class="n">TextAlign</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">b</span><span class="o">-&gt;</span><span class="n">Hover</span><span class="p">.</span><span class="n">TextAlign</span> <span class="o">==</span> <span class="n">TextAlignUndefined</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">b</span><span class="o">-&gt;</span><span class="n">Hover</span><span class="p">.</span><span class="n">TextAlign</span> <span class="o">=</span> <span class="n">b</span><span class="o">-&gt;</span><span class="n">TextAlign</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">b</span><span class="o">-&gt;</span><span class="n">Clicked</span><span class="p">.</span><span class="n">TextAlign</span> <span class="o">==</span> <span class="n">TextAlignUndefined</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">b</span><span class="o">-&gt;</span><span class="n">Clicked</span><span class="p">.</span><span class="n">TextAlign</span> <span class="o">=</span> <span class="n">b</span><span class="o">-&gt;</span><span class="n">TextAlign</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>ClearButtons</summary>
                        <p><br>  Clear all buttons<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/ui/script_ui.cpp:903 CclClearButtons</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclClearButtons</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="n">CleanButtons</span><span class="p">();</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>DefineButtonStyle</summary>
                        <p><br>  Define a button style<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/ui/script_ui.cpp:859 CclDefineButtonStyle</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclDefineButtonStyle</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">style</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">ButtonStyle</span> <span class="o">*&amp;</span><span class="n">b</span> <span class="o">=</span> <span class="n">ButtonStyleHash</span><span class="p">[</span><span class="n">style</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">b</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">b</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ButtonStyle</span><span class="p">;</span>
		<span class="c1">// Set to bogus value to see if it was set later</span>
		<span class="n">b</span><span class="o">-&gt;</span><span class="n">Default</span><span class="p">.</span><span class="n">TextPos</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">b</span><span class="o">-&gt;</span><span class="n">Hover</span><span class="p">.</span><span class="n">TextPos</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">b</span><span class="o">-&gt;</span><span class="n">Clicked</span><span class="p">.</span><span class="n">TextPos</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="mh">0xFFFFFF</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">lua_pushnil</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="k">while</span> <span class="p">(</span><span class="n">lua_next</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="p">{</span>
		<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-2</span><span class="p">);</span>

		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Size&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">CclGetPos</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">b</span><span class="o">-&gt;</span><span class="n">Width</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">b</span><span class="o">-&gt;</span><span class="n">Height</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Font&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">b</span><span class="o">-&gt;</span><span class="n">Font</span> <span class="o">=</span> <span class="n">CFont</span><span class="o">::</span><span class="n">Get</span><span class="p">(</span><span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">));</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;TextNormalColor&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">b</span><span class="o">-&gt;</span><span class="n">TextNormalColor</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;TextReverseColor&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">b</span><span class="o">-&gt;</span><span class="n">TextReverseColor</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;TextPos&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">CclGetPos</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">b</span><span class="o">-&gt;</span><span class="n">TextX</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">b</span><span class="o">-&gt;</span><span class="n">TextY</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;TextAlign&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Center&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">b</span><span class="o">-&gt;</span><span class="n">TextAlign</span> <span class="o">=</span> <span class="n">TextAlignCenter</span><span class="p">;</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Right&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">b</span><span class="o">-&gt;</span><span class="n">TextAlign</span> <span class="o">=</span> <span class="n">TextAlignRight</span><span class="p">;</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Left&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">b</span><span class="o">-&gt;</span><span class="n">TextAlign</span> <span class="o">=</span> <span class="n">TextAlignLeft</span><span class="p">;</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Invalid text alignment: %s&quot;</span> <span class="n">_C_</span> <span class="n">value</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Default&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">ParseButtonStyleProperties</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">b</span><span class="o">-&gt;</span><span class="n">Default</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Hover&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">ParseButtonStyleProperties</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">b</span><span class="o">-&gt;</span><span class="n">Hover</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Clicked&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">ParseButtonStyleProperties</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">b</span><span class="o">-&gt;</span><span class="n">Clicked</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Unsupported tag: %s&quot;</span> <span class="n">_C_</span> <span class="n">value</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">b</span><span class="o">-&gt;</span><span class="n">Default</span><span class="p">.</span><span class="n">TextPos</span><span class="p">.</span><span class="n">x</span> <span class="o">==</span> <span class="mh">0xFFFFFF</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">b</span><span class="o">-&gt;</span><span class="n">Default</span><span class="p">.</span><span class="n">TextPos</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">b</span><span class="o">-&gt;</span><span class="n">TextX</span><span class="p">;</span>
		<span class="n">b</span><span class="o">-&gt;</span><span class="n">Default</span><span class="p">.</span><span class="n">TextPos</span><span class="p">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">b</span><span class="o">-&gt;</span><span class="n">TextY</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">b</span><span class="o">-&gt;</span><span class="n">Hover</span><span class="p">.</span><span class="n">TextPos</span><span class="p">.</span><span class="n">x</span> <span class="o">==</span> <span class="mh">0xFFFFFF</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">b</span><span class="o">-&gt;</span><span class="n">Hover</span><span class="p">.</span><span class="n">TextPos</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">b</span><span class="o">-&gt;</span><span class="n">TextX</span><span class="p">;</span>
		<span class="n">b</span><span class="o">-&gt;</span><span class="n">Hover</span><span class="p">.</span><span class="n">TextPos</span><span class="p">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">b</span><span class="o">-&gt;</span><span class="n">TextY</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">b</span><span class="o">-&gt;</span><span class="n">Clicked</span><span class="p">.</span><span class="n">TextPos</span><span class="p">.</span><span class="n">x</span> <span class="o">==</span> <span class="mh">0xFFFFFF</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">b</span><span class="o">-&gt;</span><span class="n">Clicked</span><span class="p">.</span><span class="n">TextPos</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">b</span><span class="o">-&gt;</span><span class="n">TextX</span><span class="p">;</span>
		<span class="n">b</span><span class="o">-&gt;</span><span class="n">Clicked</span><span class="p">.</span><span class="n">TextPos</span><span class="p">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">b</span><span class="o">-&gt;</span><span class="n">TextY</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">b</span><span class="o">-&gt;</span><span class="n">Default</span><span class="p">.</span><span class="n">TextAlign</span> <span class="o">==</span> <span class="n">TextAlignUndefined</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">b</span><span class="o">-&gt;</span><span class="n">Default</span><span class="p">.</span><span class="n">TextAlign</span> <span class="o">=</span> <span class="n">b</span><span class="o">-&gt;</span><span class="n">TextAlign</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">b</span><span class="o">-&gt;</span><span class="n">Hover</span><span class="p">.</span><span class="n">TextAlign</span> <span class="o">==</span> <span class="n">TextAlignUndefined</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">b</span><span class="o">-&gt;</span><span class="n">Hover</span><span class="p">.</span><span class="n">TextAlign</span> <span class="o">=</span> <span class="n">b</span><span class="o">-&gt;</span><span class="n">TextAlign</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">b</span><span class="o">-&gt;</span><span class="n">Clicked</span><span class="p">.</span><span class="n">TextAlign</span> <span class="o">==</span> <span class="n">TextAlignUndefined</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">b</span><span class="o">-&gt;</span><span class="n">Clicked</span><span class="p">.</span><span class="n">TextAlign</span> <span class="o">=</span> <span class="n">b</span><span class="o">-&gt;</span><span class="n">TextAlign</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>PresentMap</summary>
                        <p><br> Set basic map caracteristics.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/ui/script_ui.cpp:1184 CclPresentMap</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclPresentMap</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>

	<span class="n">Map</span><span class="p">.</span><span class="n">Info</span><span class="p">.</span><span class="n">Description</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="c1">// Number of players in LuaToNumber(l, 3); // Not used yet.</span>
	<span class="n">Map</span><span class="p">.</span><span class="n">Info</span><span class="p">.</span><span class="n">MapWidth</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
	<span class="n">Map</span><span class="p">.</span><span class="n">Info</span><span class="p">.</span><span class="n">MapHeight</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
	<span class="n">Map</span><span class="p">.</span><span class="n">Info</span><span class="p">.</span><span class="n">MapUID</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>DefineMapSetup</summary>
                        <p><br> Define the lua file that will build the map<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/ui/script_ui.cpp:1197 CclDefineMapSetup</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclDefineMapSetup</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">Map</span><span class="p">.</span><span class="n">Info</span><span class="p">.</span><span class="n">Filename</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SetSelectionStyle</summary>
                        <p><br>  Set selection style.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/ui/script_ui.cpp:1142 CclSetSelectionStyle</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetSelectionStyle</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

	<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">style</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">style</span><span class="p">,</span> <span class="s">&quot;rectangle&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">DrawSelection</span> <span class="o">=</span> <span class="n">DrawSelectionRectangle</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">style</span><span class="p">,</span> <span class="s">&quot;alpha-rectangle&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">DrawSelection</span> <span class="o">=</span> <span class="n">DrawSelectionRectangleWithTrans</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">style</span><span class="p">,</span> <span class="s">&quot;circle&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">DrawSelection</span> <span class="o">=</span> <span class="n">DrawSelectionCircle</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">style</span><span class="p">,</span> <span class="s">&quot;alpha-circle&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">DrawSelection</span> <span class="o">=</span> <span class="n">DrawSelectionCircleWithTrans</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">style</span><span class="p">,</span> <span class="s">&quot;corners&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">DrawSelection</span> <span class="o">=</span> <span class="n">DrawSelectionCorners</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Unsupported selection style&quot;</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SetGroupKeys</summary>
                        <p><br>  Set the keys which are use for grouping units, helpful for other keyboards<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/ui/script_ui.cpp:1166 CclSetGroupKeys</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetGroupKeys</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">UiGroupKeys</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        <hr>/sound/script_sound.cpp<hr>
                        <details>
                        <summary>SetGlobalSoundRange</summary>
                        <p><br>  Set the cut off distance.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/sound/script_sound.cpp:326 CclSetGlobalSoundRange</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetGlobalSoundRange</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

	<span class="c1">// FIXME: check for errors</span>
	<span class="kt">int</span> <span class="n">d</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">d</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">DistanceSilent</span> <span class="o">=</span> <span class="n">d</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>DefineGameSounds</summary>
                        <p><br>  Glue between c and scheme. Allows to specify some global game sounds<br>  in a ccl file.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/sound/script_sound.cpp:309 CclDefineGameSounds</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclDefineGameSounds</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="c1">//FIXME: should allow to define ALL the game sounds</span>

	<span class="k">const</span> <span class="kt">int</span> <span class="n">args</span> <span class="o">=</span> <span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">args</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="o">++</span><span class="n">j</span><span class="p">;</span>

		<span class="n">LuaUserData</span> <span class="o">*</span><span class="n">data</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>

		<span class="c1">// let&#39;s handle now the different cases</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;click&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_isuserdata</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
				<span class="o">||</span> <span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="n">LuaUserData</span> <span class="o">*</span><span class="p">)</span><span class="n">lua_touserdata</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span><span class="o">-&gt;</span><span class="n">Type</span> <span class="o">!=</span> <span class="n">LuaSoundType</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Sound id expected&quot;</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="n">GameSounds</span><span class="p">.</span><span class="n">Click</span><span class="p">.</span><span class="n">Sound</span> <span class="o">=</span> <span class="p">(</span><span class="n">CSound</span> <span class="o">*</span><span class="p">)</span><span class="n">data</span><span class="o">-&gt;</span><span class="n">Data</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;transport-docking&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_isuserdata</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
				<span class="o">||</span> <span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="n">LuaUserData</span> <span class="o">*</span><span class="p">)</span><span class="n">lua_touserdata</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span><span class="o">-&gt;</span><span class="n">Type</span> <span class="o">!=</span> <span class="n">LuaSoundType</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Sound id expected&quot;</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="n">GameSounds</span><span class="p">.</span><span class="n">Docking</span><span class="p">.</span><span class="n">Sound</span> <span class="o">=</span> <span class="p">(</span><span class="n">CSound</span> <span class="o">*</span><span class="p">)</span><span class="n">data</span><span class="o">-&gt;</span><span class="n">Data</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;placement-error&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">SetSoundConfigRace</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">GameSounds</span><span class="p">.</span><span class="n">PlacementError</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;placement-success&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">SetSoundConfigRace</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">GameSounds</span><span class="p">.</span><span class="n">PlacementSuccess</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;work-complete&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">SetSoundConfigRace</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">GameSounds</span><span class="p">.</span><span class="n">WorkComplete</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;research-complete&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">SetSoundConfigRace</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">GameSounds</span><span class="p">.</span><span class="n">ResearchComplete</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;not-enough-res&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">||</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">resName</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
			<span class="k">const</span> <span class="kt">int</span> <span class="n">resId</span> <span class="o">=</span> <span class="n">GetResourceIdByName</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">resName</span><span class="p">);</span>
			<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">raceName</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
			<span class="k">const</span> <span class="kt">int</span> <span class="n">raceIndex</span> <span class="o">=</span> <span class="n">PlayerRaces</span><span class="p">.</span><span class="n">GetRaceIndexByName</span><span class="p">(</span><span class="n">raceName</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">raceIndex</span> <span class="o">==</span> <span class="mi">-1</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Unknown race: %s&quot;</span> <span class="n">_C_</span> <span class="n">raceName</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_isuserdata</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">)</span>
				<span class="o">||</span> <span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="n">LuaUserData</span> <span class="o">*</span><span class="p">)</span><span class="n">lua_touserdata</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">))</span><span class="o">-&gt;</span><span class="n">Type</span> <span class="o">!=</span> <span class="n">LuaSoundType</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Sound id expected&quot;</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
			<span class="n">GameSounds</span><span class="p">.</span><span class="n">NotEnoughRes</span><span class="p">[</span><span class="n">raceIndex</span><span class="p">][</span><span class="n">resId</span><span class="p">].</span><span class="n">Sound</span> <span class="o">=</span> <span class="p">(</span><span class="n">CSound</span> <span class="o">*</span><span class="p">)</span><span class="n">data</span><span class="o">-&gt;</span><span class="n">Data</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;not-enough-food&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">SetSoundConfigRace</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">GameSounds</span><span class="p">.</span><span class="n">NotEnoughFood</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;rescue&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">SetSoundConfigRace</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">GameSounds</span><span class="p">.</span><span class="n">Rescue</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;building-construction&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">SetSoundConfigRace</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">GameSounds</span><span class="p">.</span><span class="n">BuildingConstruction</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;chat-message&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_isuserdata</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
				<span class="o">||</span> <span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="n">LuaUserData</span> <span class="o">*</span><span class="p">)</span><span class="n">lua_touserdata</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span><span class="o">-&gt;</span><span class="n">Type</span> <span class="o">!=</span> <span class="n">LuaSoundType</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Sound id expected&quot;</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="n">GameSounds</span><span class="p">.</span><span class="n">ChatMessage</span><span class="p">.</span><span class="n">Sound</span> <span class="o">=</span> <span class="p">(</span><span class="n">CSound</span> <span class="o">*</span><span class="p">)</span><span class="n">data</span><span class="o">-&gt;</span><span class="n">Data</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Unsupported tag: %s&quot;</span> <span class="n">_C_</span> <span class="n">value</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>MapSound</summary>
                        <p><br>  Glue between c and scheme. Ask to the sound system to remap a sound id<br>  to a given name.<br><br>  @param l  Lua state.<br><br>  @return   the sound object</p>
                          <details>
                          <summary>/sound/script_sound.cpp:191 CclMapSound</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclMapSound</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">sound_name</span><span class="p">;</span>

	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="n">sound_name</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">MapSound</span><span class="p">(</span><span class="n">sound_name</span><span class="p">,</span> <span class="n">CclGetSound</span><span class="p">(</span><span class="n">l</span><span class="p">));</span>
	<span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SoundForName</summary>
                        <p><br>  Glue between c and scheme. Ask the sound system to associate a<br>  sound id to a sound name.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/sound/script_sound.cpp:71 CclSoundForName</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSoundForName</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">CSound</span> <span class="o">*</span><span class="n">id</span><span class="p">;</span>
	<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">sound_name</span><span class="p">;</span>
	<span class="n">LuaUserData</span> <span class="o">*</span><span class="n">data</span><span class="p">;</span>

	<span class="n">sound_name</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
	<span class="n">id</span> <span class="o">=</span> <span class="n">SoundForName</span><span class="p">(</span><span class="n">sound_name</span><span class="p">);</span>

	<span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="n">LuaUserData</span> <span class="o">*</span><span class="p">)</span><span class="n">lua_newuserdata</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">LuaUserData</span><span class="p">));</span>
	<span class="n">data</span><span class="o">-&gt;</span><span class="n">Type</span> <span class="o">=</span> <span class="n">LuaSoundType</span><span class="p">;</span>
	<span class="n">data</span><span class="o">-&gt;</span><span class="n">Data</span> <span class="o">=</span> <span class="n">id</span><span class="p">;</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SetSoundRange</summary>
                        <p><br>  Set the range of a given sound.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/sound/script_sound.cpp:346 CclSetSoundRange</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetSoundRange</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>

	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>

	<span class="kt">int</span> <span class="n">tmp</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="n">clamp</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tmp</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">);</span>
	<span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">theRange</span> <span class="o">=</span> <span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">char</span><span class="o">&gt;</span><span class="p">(</span><span class="n">tmp</span><span class="p">);</span>

	<span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">CSound</span> <span class="o">*</span><span class="n">id</span> <span class="o">=</span> <span class="n">CclGetSound</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="n">SetSoundRange</span><span class="p">(</span><span class="n">id</span><span class="p">,</span> <span class="n">theRange</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>MakeSound</summary>
                        <p><br>  Create a sound.<br><br>  Glue between c and scheme. This function asks the sound system to<br>  register a sound under a given name, with an associated list of files<br>  (the list can be replaced by only one file).<br><br>  @param l  Lua state.<br><br>  @return   the sound id of the created sound</p>
                          <details>
                          <summary>/sound/script_sound.cpp:141 CclMakeSound</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclMakeSound</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>

	<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">c_name</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span> <span class="n">files</span><span class="p">;</span>
	<span class="n">CSound</span> <span class="o">*</span><span class="n">id</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">lua_isstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="p">{</span>
		<span class="c1">// only one file</span>
		<span class="n">files</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">));</span>
		<span class="n">id</span> <span class="o">=</span> <span class="n">MakeSound</span><span class="p">(</span><span class="n">c_name</span><span class="p">,</span> <span class="n">files</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="p">{</span>
		<span class="c1">// several files</span>
		<span class="k">const</span> <span class="kt">int</span> <span class="n">args</span> <span class="o">=</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
		<span class="n">files</span><span class="p">.</span><span class="n">reserve</span><span class="p">(</span><span class="n">args</span><span class="p">);</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">args</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">files</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">));</span>
		<span class="p">}</span>
		<span class="n">id</span> <span class="o">=</span> <span class="n">MakeSound</span><span class="p">(</span><span class="n">c_name</span><span class="p">,</span> <span class="n">files</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;string or table expected&quot;</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">LuaUserData</span> <span class="o">*</span><span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="n">LuaUserData</span> <span class="o">*</span><span class="p">)</span><span class="n">lua_newuserdata</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">LuaUserData</span><span class="p">));</span>
	<span class="n">data</span><span class="o">-&gt;</span><span class="n">Type</span> <span class="o">=</span> <span class="n">LuaSoundType</span><span class="p">;</span>
	<span class="n">data</span><span class="o">-&gt;</span><span class="n">Data</span> <span class="o">=</span> <span class="n">id</span><span class="p">;</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>MakeSoundGroup</summary>
                        <p><br>  Glue between c and scheme. This function asks the sound system to<br>  build a special sound group.<br><br>  @param l  Lua state.<br><br>  @return   The sound id of the created sound</p>
                          <details>
                          <summary>/sound/script_sound.cpp:172 CclMakeSoundGroup</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclMakeSoundGroup</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">CSound</span> <span class="o">*</span><span class="n">id</span><span class="p">;</span>
	<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">c_name</span><span class="p">;</span>
	<span class="n">CSound</span> <span class="o">*</span><span class="n">first</span><span class="p">;</span>
	<span class="n">CSound</span> <span class="o">*</span><span class="n">second</span><span class="p">;</span>
	<span class="n">LuaUserData</span> <span class="o">*</span><span class="n">data</span><span class="p">;</span>

	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>

	<span class="n">c_name</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

	<span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="n">first</span> <span class="o">=</span> <span class="n">CclGetSound</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">second</span> <span class="o">=</span> <span class="n">CclGetSound</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="n">id</span> <span class="o">=</span> <span class="n">MakeSoundGroup</span><span class="p">(</span><span class="n">c_name</span><span class="p">,</span> <span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">);</span>
	<span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="n">LuaUserData</span> <span class="o">*</span><span class="p">)</span><span class="n">lua_newuserdata</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">LuaUserData</span><span class="p">));</span>
	<span class="n">data</span><span class="o">-&gt;</span><span class="n">Type</span> <span class="o">=</span> <span class="n">LuaSoundType</span><span class="p">;</span>
	<span class="n">data</span><span class="o">-&gt;</span><span class="n">Data</span> <span class="o">=</span> <span class="n">id</span><span class="p">;</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>PlaySound</summary>
                        <p><br>  Ask the sound system to play the specified sound.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/sound/script_sound.cpp:214 CclPlaySound</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclPlaySound</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">args</span> <span class="o">=</span> <span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">args</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="o">||</span> <span class="n">args</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">CSound</span> <span class="o">*</span><span class="n">id</span> <span class="o">=</span> <span class="n">CclGetSound</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="kt">bool</span> <span class="n">always</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">args</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">always</span> <span class="o">=</span> <span class="n">LuaToBoolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">PlayGameSound</span><span class="p">(</span><span class="n">id</span><span class="p">,</span> <span class="n">MaxSampleVolume</span><span class="p">,</span> <span class="n">always</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        <hr>/animation/animation.cpp<hr>
                        <details>
                        <summary>DefineAnimations</summary>
                        <p><br>  Define a unit-type animation set.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/animation/animation.cpp:747 CclDefineAnimations</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclDefineAnimations</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">name</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">CAnimations</span> <span class="o">*</span><span class="n">anims</span> <span class="o">=</span> <span class="n">AnimationsByIdent</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">anims</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">anims</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CAnimations</span><span class="p">;</span>
		<span class="n">AnimationMap</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">anims</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">lua_pushnil</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="k">while</span> <span class="p">(</span><span class="n">lua_next</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="p">{</span>
		<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-2</span><span class="p">);</span>

		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Start&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">anims</span><span class="o">-&gt;</span><span class="n">Start</span> <span class="o">=</span> <span class="n">ParseAnimation</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strncmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Still&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">anims</span><span class="o">-&gt;</span><span class="n">Still</span> <span class="o">=</span> <span class="n">ParseAnimation</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strncmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Death&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">anims</span><span class="o">-&gt;</span><span class="n">hasDeathAnimation</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">strlen</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">const</span> <span class="kt">int</span> <span class="n">death</span> <span class="o">=</span> <span class="n">ExtraDeathIndex</span><span class="p">(</span><span class="n">value</span> <span class="o">+</span> <span class="mi">6</span><span class="p">);</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">death</span> <span class="o">==</span> <span class="n">ANIMATIONS_DEATHTYPES</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">anims</span><span class="o">-&gt;</span><span class="n">Death</span><span class="p">[</span><span class="n">ANIMATIONS_DEATHTYPES</span><span class="p">]</span> <span class="o">=</span> <span class="n">ParseAnimation</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
				<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
					<span class="n">anims</span><span class="o">-&gt;</span><span class="n">Death</span><span class="p">[</span><span class="n">death</span><span class="p">]</span> <span class="o">=</span> <span class="n">ParseAnimation</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
				<span class="p">}</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="n">anims</span><span class="o">-&gt;</span><span class="n">Death</span><span class="p">[</span><span class="n">ANIMATIONS_DEATHTYPES</span><span class="p">]</span> <span class="o">=</span> <span class="n">ParseAnimation</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Attack&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">anims</span><span class="o">-&gt;</span><span class="n">Attack</span> <span class="o">=</span> <span class="n">ParseAnimation</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;RangedAttack&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">anims</span><span class="o">-&gt;</span><span class="n">RangedAttack</span> <span class="o">=</span> <span class="n">ParseAnimation</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;SpellCast&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">anims</span><span class="o">-&gt;</span><span class="n">SpellCast</span> <span class="o">=</span> <span class="n">ParseAnimation</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Move&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">anims</span><span class="o">-&gt;</span><span class="n">Move</span> <span class="o">=</span> <span class="n">ParseAnimation</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Repair&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">anims</span><span class="o">-&gt;</span><span class="n">Repair</span> <span class="o">=</span> <span class="n">ParseAnimation</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Train&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">anims</span><span class="o">-&gt;</span><span class="n">Train</span> <span class="o">=</span> <span class="n">ParseAnimation</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Research&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">anims</span><span class="o">-&gt;</span><span class="n">Research</span> <span class="o">=</span> <span class="n">ParseAnimation</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Upgrade&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">anims</span><span class="o">-&gt;</span><span class="n">Upgrade</span> <span class="o">=</span> <span class="n">ParseAnimation</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Build&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">anims</span><span class="o">-&gt;</span><span class="n">Build</span> <span class="o">=</span> <span class="n">ParseAnimation</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strncmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Harvest_&quot;</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">const</span> <span class="kt">int</span> <span class="n">res</span> <span class="o">=</span> <span class="n">GetResourceIdByName</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">value</span> <span class="o">+</span> <span class="mi">8</span><span class="p">);</span>
			<span class="n">anims</span><span class="o">-&gt;</span><span class="n">Harvest</span><span class="p">[</span><span class="n">res</span><span class="p">]</span> <span class="o">=</span> <span class="n">ParseAnimation</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Unsupported animation: %s&quot;</span> <span class="n">_C_</span> <span class="n">value</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="c1">// Must add to array in a fixed order for save games</span>
	<span class="n">AddAnimationToArray</span><span class="p">(</span><span class="n">anims</span><span class="o">-&gt;</span><span class="n">Start</span><span class="p">);</span>
	<span class="n">AddAnimationToArray</span><span class="p">(</span><span class="n">anims</span><span class="o">-&gt;</span><span class="n">Still</span><span class="p">);</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">ANIMATIONS_DEATHTYPES</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">AddAnimationToArray</span><span class="p">(</span><span class="n">anims</span><span class="o">-&gt;</span><span class="n">Death</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
	<span class="p">}</span>
	<span class="n">AddAnimationToArray</span><span class="p">(</span><span class="n">anims</span><span class="o">-&gt;</span><span class="n">Attack</span><span class="p">);</span>
	<span class="n">AddAnimationToArray</span><span class="p">(</span><span class="n">anims</span><span class="o">-&gt;</span><span class="n">RangedAttack</span><span class="p">);</span>
	<span class="n">AddAnimationToArray</span><span class="p">(</span><span class="n">anims</span><span class="o">-&gt;</span><span class="n">SpellCast</span><span class="p">);</span>
	<span class="n">AddAnimationToArray</span><span class="p">(</span><span class="n">anims</span><span class="o">-&gt;</span><span class="n">Move</span><span class="p">);</span>
	<span class="n">AddAnimationToArray</span><span class="p">(</span><span class="n">anims</span><span class="o">-&gt;</span><span class="n">Repair</span><span class="p">);</span>
	<span class="n">AddAnimationToArray</span><span class="p">(</span><span class="n">anims</span><span class="o">-&gt;</span><span class="n">Train</span><span class="p">);</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">MaxCosts</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">AddAnimationToArray</span><span class="p">(</span><span class="n">anims</span><span class="o">-&gt;</span><span class="n">Harvest</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        <hr>/unit/upgrade.cpp<hr>
                        <details>
                        <summary>DefineModifier</summary>
                        <p><br>  Define a new upgrade modifier.<br><br>  @param l  List of modifiers.</p>
                          <details>
                          <summary>/unit/upgrade.cpp:358 CclDefineModifier</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclDefineModifier</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">args</span> <span class="o">=</span> <span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>

	<span class="n">CUpgradeModifier</span> <span class="o">*</span><span class="n">um</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CUpgradeModifier</span><span class="p">;</span>

	<span class="n">memset</span><span class="p">(</span><span class="n">um</span><span class="o">-&gt;</span><span class="n">ChangeUpgrades</span><span class="p">,</span> <span class="sc">&#39;?&#39;</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">um</span><span class="o">-&gt;</span><span class="n">ChangeUpgrades</span><span class="p">));</span>
	<span class="n">memset</span><span class="p">(</span><span class="n">um</span><span class="o">-&gt;</span><span class="n">ApplyTo</span><span class="p">,</span> <span class="sc">&#39;?&#39;</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">um</span><span class="o">-&gt;</span><span class="n">ApplyTo</span><span class="p">));</span>
	<span class="n">um</span><span class="o">-&gt;</span><span class="n">Modifier</span><span class="p">.</span><span class="n">Variables</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CVariable</span><span class="p">[</span><span class="n">UnitTypeVar</span><span class="p">.</span><span class="n">GetNumberVariable</span><span class="p">()];</span>
	<span class="n">um</span><span class="o">-&gt;</span><span class="n">ModifyPercent</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">int</span><span class="p">[</span><span class="n">UnitTypeVar</span><span class="p">.</span><span class="n">GetNumberVariable</span><span class="p">()];</span>
	<span class="n">memset</span><span class="p">(</span><span class="n">um</span><span class="o">-&gt;</span><span class="n">ModifyPercent</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">UnitTypeVar</span><span class="p">.</span><span class="n">GetNumberVariable</span><span class="p">()</span> <span class="o">*</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">));</span>

	<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">upgrade_ident</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">um</span><span class="o">-&gt;</span><span class="n">UpgradeId</span> <span class="o">=</span> <span class="n">UpgradeIdByIdent</span><span class="p">(</span><span class="n">upgrade_ident</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">um</span><span class="o">-&gt;</span><span class="n">UpgradeId</span> <span class="o">==</span> <span class="mi">-1</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Error when defining upgrade modifier: upgrade </span><span class="se">\&quot;</span><span class="s">%s</span><span class="se">\&quot;</span><span class="s"> doesn&#39;t exist.&quot;</span> <span class="n">_C_</span> <span class="n">upgrade_ident</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
	<span class="p">}</span>

	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">args</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">key</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="cp">#if 0</span><span class="c"> // To be removed. must modify lua file.</span>
<span class="c">		if (!strcmp(key, &quot;attack-range&quot;)) {</span>
<span class="c">			key = &quot;AttackRange&quot;;</span>
<span class="c">		} else if (!strcmp(key, &quot;sight-range&quot;)) {</span>
<span class="c">			key = &quot;SightRange&quot;;</span>
<span class="c">		} else if (!strcmp(key, &quot;basic-damage&quot;)) {</span>
<span class="c">			key = &quot;BasicDamage&quot;;</span>
<span class="c">		} else if (!strcmp(key, &quot;piercing-damage&quot;)) {</span>
<span class="c">			key = &quot;PiercingDamage&quot;;</span>
<span class="c">		} else if (!strcmp(key, &quot;armor&quot;)) {</span>
<span class="c">			key = &quot;Armor&quot;;</span>
<span class="c">		} else if (!strcmp(key, &quot;hit-points&quot;)) {</span>
<span class="c">			key = &quot;HitPoints&quot;;</span>
<span class="c">		}</span>
<span class="cp">#endif</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s">&quot;regeneration-rate&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">um</span><span class="o">-&gt;</span><span class="n">Modifier</span><span class="p">.</span><span class="n">Variables</span><span class="p">[</span><span class="n">HP_INDEX</span><span class="p">].</span><span class="n">Increase</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s">&quot;cost&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">||</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
			<span class="k">const</span> <span class="kt">int</span> <span class="n">resId</span> <span class="o">=</span> <span class="n">GetResourceIdByName</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">value</span><span class="p">);</span>
			<span class="n">um</span><span class="o">-&gt;</span><span class="n">Modifier</span><span class="p">.</span><span class="n">Costs</span><span class="p">[</span><span class="n">resId</span><span class="p">]</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s">&quot;storing&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">||</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
			<span class="k">const</span> <span class="kt">int</span> <span class="n">resId</span> <span class="o">=</span> <span class="n">GetResourceIdByName</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">value</span><span class="p">);</span>
			<span class="n">um</span><span class="o">-&gt;</span><span class="n">Modifier</span><span class="p">.</span><span class="n">Storing</span><span class="p">[</span><span class="n">resId</span><span class="p">]</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s">&quot;improve-production&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
			<span class="k">const</span> <span class="kt">int</span> <span class="n">resId</span> <span class="o">=</span> <span class="n">GetResourceIdByName</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">value</span><span class="p">);</span>
			<span class="n">um</span><span class="o">-&gt;</span><span class="n">Modifier</span><span class="p">.</span><span class="n">ImproveIncomes</span><span class="p">[</span><span class="n">resId</span><span class="p">]</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s">&quot;allow-unit&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>

			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strncmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;unit-&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">um</span><span class="o">-&gt;</span><span class="n">ChangeUnits</span><span class="p">[</span><span class="n">UnitTypeIdByIdent</span><span class="p">(</span><span class="n">value</span><span class="p">)]</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;unit expected&quot;</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s">&quot;allow&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strncmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;upgrade-&quot;</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">um</span><span class="o">-&gt;</span><span class="n">ChangeUpgrades</span><span class="p">[</span><span class="n">UpgradeIdByIdent</span><span class="p">(</span><span class="n">value</span><span class="p">)]</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;upgrade expected&quot;</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s">&quot;apply-to&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
			<span class="n">um</span><span class="o">-&gt;</span><span class="n">ApplyTo</span><span class="p">[</span><span class="n">UnitTypeIdByIdent</span><span class="p">(</span><span class="n">value</span><span class="p">)]</span> <span class="o">=</span> <span class="sc">&#39;X&#39;</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s">&quot;convert-to&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
			<span class="n">um</span><span class="o">-&gt;</span><span class="n">ConvertTo</span> <span class="o">=</span> <span class="n">UnitTypeByIdent</span><span class="p">(</span><span class="n">value</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s">&quot;research-speed&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">um</span><span class="o">-&gt;</span><span class="n">SpeedResearch</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="n">UnitTypeVar</span><span class="p">.</span><span class="n">VariableNameLookup</span><span class="p">[</span><span class="n">key</span><span class="p">];</span> <span class="c1">// variable index;</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">index</span> <span class="o">!=</span> <span class="mi">-1</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
					<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
					<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Percent&quot;</span><span class="p">))</span> <span class="p">{</span>
						<span class="n">um</span><span class="o">-&gt;</span><span class="n">ModifyPercent</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
					<span class="p">}</span>
				<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
					<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
					<span class="k">if</span> <span class="p">(</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">))</span> <span class="p">{</span>
						<span class="n">DefineVariableField</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">um</span><span class="o">-&gt;</span><span class="n">Modifier</span><span class="p">.</span><span class="n">Variables</span> <span class="o">+</span> <span class="n">index</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
					<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">lua_isnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">))</span> <span class="p">{</span>
						<span class="n">um</span><span class="o">-&gt;</span><span class="n">Modifier</span><span class="p">.</span><span class="n">Variables</span><span class="p">[</span><span class="n">index</span><span class="p">].</span><span class="n">Enable</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
						<span class="n">um</span><span class="o">-&gt;</span><span class="n">Modifier</span><span class="p">.</span><span class="n">Variables</span><span class="p">[</span><span class="n">index</span><span class="p">].</span><span class="n">Value</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
						<span class="n">um</span><span class="o">-&gt;</span><span class="n">Modifier</span><span class="p">.</span><span class="n">Variables</span><span class="p">[</span><span class="n">index</span><span class="p">].</span><span class="n">Max</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
					<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
						<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;bad argument type for &#39;%s&#39;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="n">_C_</span> <span class="n">key</span><span class="p">);</span>
					<span class="p">}</span>
					<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
				<span class="p">}</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;wrong tag: %s&quot;</span> <span class="n">_C_</span> <span class="n">key</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="n">UpgradeModifiers</span><span class="p">[</span><span class="n">NumUpgradeModifiers</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">um</span><span class="p">;</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>DefineAllow</summary>
                        <p><br>  Define which units/upgrades are allowed.</p>
                          <details>
                          <summary>/unit/upgrade.cpp:421 CclDefineAllow</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclDefineAllow</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">UnitMax</span> <span class="o">=</span> <span class="mi">65536</span><span class="p">;</span> <span class="c1">/// How many units supported</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">args</span> <span class="o">=</span> <span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>

	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">args</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">ident</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="o">++</span><span class="n">j</span><span class="p">;</span>
		<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">ids</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>

		<span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="n">strlen</span><span class="p">(</span><span class="n">ids</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">&gt;</span> <span class="n">PlayerMax</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;%s: Allow string too long %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">ident</span><span class="p">,</span> <span class="n">n</span><span class="p">);</span>
			<span class="n">n</span> <span class="o">=</span> <span class="n">PlayerMax</span><span class="p">;</span>
		<span class="p">}</span>

		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strncmp</span><span class="p">(</span><span class="n">ident</span><span class="p">,</span> <span class="s">&quot;unit-&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span> <span class="p">{</span>
			<span class="kt">int</span> <span class="n">id</span> <span class="o">=</span> <span class="n">UnitTypeIdByIdent</span><span class="p">(</span><span class="n">ident</span><span class="p">);</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">ids</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="sc">&#39;A&#39;</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">AllowUnitId</span><span class="p">(</span><span class="n">Players</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">id</span><span class="p">,</span> <span class="n">UnitMax</span><span class="p">);</span>
				<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">ids</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="sc">&#39;F&#39;</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">AllowUnitId</span><span class="p">(</span><span class="n">Players</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">id</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
				<span class="p">}</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strncmp</span><span class="p">(</span><span class="n">ident</span><span class="p">,</span> <span class="s">&quot;upgrade-&quot;</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span> <span class="p">{</span>
			<span class="kt">int</span> <span class="n">id</span> <span class="o">=</span> <span class="n">UpgradeIdByIdent</span><span class="p">(</span><span class="n">ident</span><span class="p">);</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">AllowUpgradeId</span><span class="p">(</span><span class="n">Players</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">id</span><span class="p">,</span> <span class="n">ids</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">DebugPrint</span><span class="p">(</span><span class="s">&quot; wrong ident %s</span><span class="se">\n</span><span class="s">&quot;</span> <span class="n">_C_</span> <span class="n">ident</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>DefineUnitAllow</summary>
                        <p><br>  Define which units are allowed and how much.</p>
                          <details>
                          <summary>/unit/upgrade.cpp:381 CclDefineUnitAllow</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclDefineUnitAllow</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">args</span> <span class="o">=</span> <span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>

	<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">ident</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">strncmp</span><span class="p">(</span><span class="n">ident</span><span class="p">,</span> <span class="s">&quot;unit-&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">DebugPrint</span><span class="p">(</span><span class="s">&quot; wrong ident %s</span><span class="se">\n</span><span class="s">&quot;</span> <span class="n">_C_</span> <span class="n">ident</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="kt">int</span> <span class="n">id</span> <span class="o">=</span> <span class="n">UnitTypeIdByIdent</span><span class="p">(</span><span class="n">ident</span><span class="p">);</span>

	<span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">args</span> <span class="o">&amp;&amp;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">PlayerMax</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">AllowUnitId</span><span class="p">(</span><span class="n">Players</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">id</span><span class="p">,</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">));</span>
		<span class="o">++</span><span class="n">i</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        <hr>/unit/unit_draw.cpp<hr>
                        <details>
                        <summary>DefineSprites</summary>
                        <p><br>  Define the sprite to show variables.<br><br>  @param l    Lua_state</p>
                          <details>
                          <summary>/unit/unit_draw.cpp:327 CclDefineSprites</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclDefineSprites</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">args</span> <span class="o">=</span> <span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>

	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">args</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">Decoration</span> <span class="n">deco</span><span class="p">;</span>

		<span class="n">lua_pushnil</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
		<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">name</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span><span class="c1">// name of the current sprite.</span>
		<span class="k">while</span> <span class="p">(</span><span class="n">lua_next</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">key</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-2</span><span class="p">);</span> <span class="c1">// key name</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s">&quot;Name&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">name</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s">&quot;File&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">deco</span><span class="p">.</span><span class="n">File</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s">&quot;Offset&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">CclGetPos</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">deco</span><span class="p">.</span><span class="n">HotPos</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">deco</span><span class="p">.</span><span class="n">HotPos</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s">&quot;Size&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">CclGetPos</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">deco</span><span class="p">.</span><span class="n">Width</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">deco</span><span class="p">.</span><span class="n">Height</span><span class="p">);</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="c1">// Error.</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect field &#39;%s&#39; for the DefineSprite.&quot;</span> <span class="n">_C_</span> <span class="n">key</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="c1">// pop the value;</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;CclDefineSprites requires the Name flag for sprite.&quot;</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="n">GetSpriteIndex</span><span class="p">(</span><span class="n">name</span><span class="p">);</span> <span class="c1">// Index of the Sprite.</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">index</span> <span class="o">==</span> <span class="mi">-1</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// new sprite.</span>
			<span class="n">index</span> <span class="o">=</span> <span class="n">DecoSprite</span><span class="p">.</span><span class="n">SpriteArray</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
			<span class="n">DecoSprite</span><span class="p">.</span><span class="n">Name</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
			<span class="n">DecoSprite</span><span class="p">.</span><span class="n">SpriteArray</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">deco</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">DecoSprite</span><span class="p">.</span><span class="n">SpriteArray</span><span class="p">[</span><span class="n">index</span><span class="p">].</span><span class="n">File</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
			<span class="n">DecoSprite</span><span class="p">.</span><span class="n">SpriteArray</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">deco</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="c1">// Now verify validity.</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">DecoSprite</span><span class="p">.</span><span class="n">SpriteArray</span><span class="p">[</span><span class="n">index</span><span class="p">].</span><span class="n">File</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span> <span class="p">{</span>
			<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;CclDefineSprites requires the File flag for sprite.&quot;</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="c1">// FIXME check if file is valid with good size ?</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        <hr>/unit/script_unittype.cpp<hr>
                        <details>
                        <summary>DefineUnitType</summary>
                        <p>/unit/script_unittype.cpp:1156 CclDefineUnitType</p>
                        <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclDefineUnitType</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="c1">// Slot identifier</span>
	<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">str</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">CUnitType</span> <span class="o">*</span><span class="n">type</span> <span class="o">=</span> <span class="n">UnitTypeByIdent</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>
	<span class="kt">int</span> <span class="n">redefine</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">type</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">redefine</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">type</span> <span class="o">=</span> <span class="n">NewUnitTypeSlot</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>
		<span class="n">redefine</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">type</span><span class="o">-&gt;</span><span class="n">NumDirections</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">type</span><span class="o">-&gt;</span><span class="n">Flip</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

	<span class="c1">//  Parse the list: (still everything could be changed!)</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">lua_pushnil</span><span class="p">(</span><span class="n">l</span><span class="p">);</span> <span class="n">lua_next</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span> <span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
		<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-2</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Name&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">Name</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Image&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="kt">int</span> <span class="n">subargs</span> <span class="o">=</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">subargs</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="o">++</span><span class="n">k</span><span class="p">;</span>

				<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;file&quot;</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">type</span><span class="o">-&gt;</span><span class="n">File</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;size&quot;</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
					<span class="n">CclGetPos</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">type</span><span class="o">-&gt;</span><span class="n">Width</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">type</span><span class="o">-&gt;</span><span class="n">Height</span><span class="p">);</span>
					<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
				<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
					<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Unsupported image tag: %s&quot;</span> <span class="n">_C_</span> <span class="n">value</span><span class="p">);</span>
				<span class="p">}</span>
			<span class="p">}</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">redefine</span> <span class="o">&amp;&amp;</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">Sprite</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">CGraphic</span><span class="o">::</span><span class="n">Free</span><span class="p">(</span><span class="n">type</span><span class="o">-&gt;</span><span class="n">Sprite</span><span class="p">);</span>
				<span class="n">type</span><span class="o">-&gt;</span><span class="n">Sprite</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">type</span><span class="o">-&gt;</span><span class="n">ShadowFile</span> <span class="o">==</span> <span class="n">shadowMarker</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">type</span><span class="o">-&gt;</span><span class="n">ShadowFile</span> <span class="o">=</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">File</span><span class="p">;</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">type</span><span class="o">-&gt;</span><span class="n">ShadowWidth</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">ShadowHeight</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">type</span><span class="o">-&gt;</span><span class="n">ShadowWidth</span> <span class="o">=</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">Width</span><span class="p">;</span>
					<span class="n">type</span><span class="o">-&gt;</span><span class="n">ShadowHeight</span> <span class="o">=</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">Height</span><span class="p">;</span>
				<span class="p">}</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Shadow&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="c1">// default to same spritemap as unit</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">type</span><span class="o">-&gt;</span><span class="n">File</span><span class="p">.</span><span class="n">length</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">type</span><span class="o">-&gt;</span><span class="n">ShadowFile</span> <span class="o">=</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">File</span><span class="p">;</span>
				<span class="n">type</span><span class="o">-&gt;</span><span class="n">ShadowWidth</span> <span class="o">=</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">Width</span><span class="p">;</span>
				<span class="n">type</span><span class="o">-&gt;</span><span class="n">ShadowHeight</span> <span class="o">=</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">Height</span><span class="p">;</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="n">type</span><span class="o">-&gt;</span><span class="n">ShadowFile</span> <span class="o">=</span> <span class="n">shadowMarker</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="k">const</span> <span class="kt">int</span> <span class="n">subargs</span> <span class="o">=</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">subargs</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="o">++</span><span class="n">k</span><span class="p">;</span>

				<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;file&quot;</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">type</span><span class="o">-&gt;</span><span class="n">ShadowFile</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;size&quot;</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
					<span class="n">CclGetPos</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">type</span><span class="o">-&gt;</span><span class="n">ShadowWidth</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">type</span><span class="o">-&gt;</span><span class="n">ShadowHeight</span><span class="p">);</span>
					<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
				<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;offset&quot;</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
					<span class="n">CclGetPos</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">type</span><span class="o">-&gt;</span><span class="n">ShadowOffsetX</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">type</span><span class="o">-&gt;</span><span class="n">ShadowOffsetY</span><span class="p">);</span>
					<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
				<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;sprite-frame&quot;</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">type</span><span class="o">-&gt;</span><span class="n">ShadowSpriteFrame</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;scale&quot;</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">type</span><span class="o">-&gt;</span><span class="n">ShadowScale</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
					<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Unsupported shadow tag: %s&quot;</span> <span class="n">_C_</span> <span class="n">value</span><span class="p">);</span>
				<span class="p">}</span>
			<span class="p">}</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">redefine</span> <span class="o">&amp;&amp;</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">ShadowSprite</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">CGraphic</span><span class="o">::</span><span class="n">Free</span><span class="p">(</span><span class="n">type</span><span class="o">-&gt;</span><span class="n">ShadowSprite</span><span class="p">);</span>
				<span class="n">type</span><span class="o">-&gt;</span><span class="n">ShadowSprite</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Offset&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">CclGetPos</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">type</span><span class="o">-&gt;</span><span class="n">OffsetX</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">type</span><span class="o">-&gt;</span><span class="n">OffsetY</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Flip&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">Flip</span> <span class="o">=</span> <span class="n">LuaToBoolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Animations&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">Animations</span> <span class="o">=</span> <span class="n">AnimationsByIdent</span><span class="p">(</span><span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">));</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">type</span><span class="o">-&gt;</span><span class="n">Animations</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">DebugPrint</span><span class="p">(</span><span class="s">&quot;Warning animation &#39;%s&#39; not found</span><span class="se">\n</span><span class="s">&quot;</span> <span class="n">_C_</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">));</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Icon&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">Icon</span><span class="p">.</span><span class="n">Name</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">Icon</span><span class="p">.</span><span class="n">Icon</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
<span class="cp">#ifdef USE_MNG</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Portrait&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="k">const</span> <span class="kt">int</span> <span class="n">subargs</span> <span class="o">=</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">Portrait</span><span class="p">.</span><span class="n">Num</span> <span class="o">=</span> <span class="n">subargs</span><span class="p">;</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">Portrait</span><span class="p">.</span><span class="n">Files</span> <span class="o">=</span> <span class="k">new</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">[</span><span class="n">type</span><span class="o">-&gt;</span><span class="n">Portrait</span><span class="p">.</span><span class="n">Num</span><span class="p">];</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">Portrait</span><span class="p">.</span><span class="n">Mngs</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Mng</span> <span class="o">*</span><span class="p">[</span><span class="n">type</span><span class="o">-&gt;</span><span class="n">Portrait</span><span class="p">.</span><span class="n">Num</span><span class="p">];</span>
			<span class="n">memset</span><span class="p">(</span><span class="n">type</span><span class="o">-&gt;</span><span class="n">Portrait</span><span class="p">.</span><span class="n">Mngs</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">Portrait</span><span class="p">.</span><span class="n">Num</span> <span class="o">*</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">Mng</span> <span class="o">*</span><span class="p">));</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">subargs</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">type</span><span class="o">-&gt;</span><span class="n">Portrait</span><span class="p">.</span><span class="n">Files</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="p">}</span>
<span class="cp">#endif</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Costs&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="k">const</span> <span class="kt">int</span> <span class="n">subargs</span> <span class="o">=</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">subargs</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="k">const</span> <span class="kt">int</span> <span class="n">res</span> <span class="o">=</span> <span class="n">CclGetResourceByName</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
				<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
				<span class="o">++</span><span class="n">k</span><span class="p">;</span>
				<span class="n">type</span><span class="o">-&gt;</span><span class="n">DefaultStat</span><span class="p">.</span><span class="n">Costs</span><span class="p">[</span><span class="n">res</span><span class="p">]</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Storing&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="k">const</span> <span class="kt">int</span> <span class="n">subargs</span> <span class="o">=</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">subargs</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="k">const</span> <span class="kt">int</span> <span class="n">res</span> <span class="o">=</span> <span class="n">CclGetResourceByName</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
				<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
				<span class="o">++</span><span class="n">k</span><span class="p">;</span>
				<span class="n">type</span><span class="o">-&gt;</span><span class="n">DefaultStat</span><span class="p">.</span><span class="n">Storing</span><span class="p">[</span><span class="n">res</span><span class="p">]</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;ImproveProduction&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="k">const</span> <span class="kt">int</span> <span class="n">subargs</span> <span class="o">=</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">subargs</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="k">const</span> <span class="kt">int</span> <span class="n">res</span> <span class="o">=</span> <span class="n">CclGetResourceByName</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
				<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
				<span class="o">++</span><span class="n">k</span><span class="p">;</span>
				<span class="n">type</span><span class="o">-&gt;</span><span class="n">DefaultStat</span><span class="p">.</span><span class="n">ImproveIncomes</span><span class="p">[</span><span class="n">res</span><span class="p">]</span> <span class="o">=</span> <span class="n">DefaultIncomes</span><span class="p">[</span><span class="n">res</span><span class="p">]</span> <span class="o">+</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Construction&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="c1">// FIXME: What if constructions aren&#39;t yet loaded?</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">Construction</span> <span class="o">=</span> <span class="n">ConstructionByIdent</span><span class="p">(</span><span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">));</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;DrawLevel&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">DrawLevel</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;MaxOnBoard&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">MaxOnBoard</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;BoardSize&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">BoardSize</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;ButtonLevelForTransporter&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">ButtonLevelForTransporter</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;StartingResources&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">StartingResources</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;RegenerationRate&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">DefaultStat</span><span class="p">.</span><span class="n">Variables</span><span class="p">[</span><span class="n">HP_INDEX</span><span class="p">].</span><span class="n">Increase</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;BurnPercent&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">BurnPercent</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;BurnDamageRate&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">BurnDamageRate</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;PoisonDrain&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">PoisonDrain</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;ShieldPoints&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">DefineVariableField</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">DefaultStat</span><span class="p">.</span><span class="n">Variables</span> <span class="o">+</span> <span class="n">SHIELD_INDEX</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">lua_isnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">type</span><span class="o">-&gt;</span><span class="n">DefaultStat</span><span class="p">.</span><span class="n">Variables</span><span class="p">[</span><span class="n">SHIELD_INDEX</span><span class="p">].</span><span class="n">Max</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
				<span class="n">type</span><span class="o">-&gt;</span><span class="n">DefaultStat</span><span class="p">.</span><span class="n">Variables</span><span class="p">[</span><span class="n">SHIELD_INDEX</span><span class="p">].</span><span class="n">Value</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
				<span class="n">type</span><span class="o">-&gt;</span><span class="n">DefaultStat</span><span class="p">.</span><span class="n">Variables</span><span class="p">[</span><span class="n">SHIELD_INDEX</span><span class="p">].</span><span class="n">Increase</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
				<span class="n">type</span><span class="o">-&gt;</span><span class="n">DefaultStat</span><span class="p">.</span><span class="n">Variables</span><span class="p">[</span><span class="n">SHIELD_INDEX</span><span class="p">].</span><span class="n">Enable</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;TileSize&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">CclGetPos</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">type</span><span class="o">-&gt;</span><span class="n">TileWidth</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">type</span><span class="o">-&gt;</span><span class="n">TileHeight</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;NeutralMinimapColor&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">NeutralMinimapColorRGB</span><span class="p">.</span><span class="n">Parse</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;BoxSize&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">CclGetPos</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">type</span><span class="o">-&gt;</span><span class="n">BoxWidth</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">type</span><span class="o">-&gt;</span><span class="n">BoxHeight</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;BoxOffset&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">CclGetPos</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">type</span><span class="o">-&gt;</span><span class="n">BoxOffsetX</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">type</span><span class="o">-&gt;</span><span class="n">BoxOffsetY</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;NumDirections&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">NumDirections</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;ComputerReactionRange&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">ReactRangeComputer</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;PersonReactionRange&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">ReactRangePerson</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Missile&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">Missile</span><span class="p">.</span><span class="n">Name</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">Missile</span><span class="p">.</span><span class="n">Missile</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;MinAttackRange&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">MinAttackRange</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;MaxAttackRange&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">DefaultStat</span><span class="p">.</span><span class="n">Variables</span><span class="p">[</span><span class="n">ATTACKRANGE_INDEX</span><span class="p">].</span><span class="n">Value</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">DefaultStat</span><span class="p">.</span><span class="n">Variables</span><span class="p">[</span><span class="n">ATTACKRANGE_INDEX</span><span class="p">].</span><span class="n">Max</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">DefaultStat</span><span class="p">.</span><span class="n">Variables</span><span class="p">[</span><span class="n">ATTACKRANGE_INDEX</span><span class="p">].</span><span class="n">Enable</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;MaxHarvesters&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">DefaultStat</span><span class="p">.</span><span class="n">Variables</span><span class="p">[</span><span class="n">MAXHARVESTERS_INDEX</span><span class="p">].</span><span class="n">Value</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">DefaultStat</span><span class="p">.</span><span class="n">Variables</span><span class="p">[</span><span class="n">MAXHARVESTERS_INDEX</span><span class="p">].</span><span class="n">Max</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Priority&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">DefaultStat</span><span class="p">.</span><span class="n">Variables</span><span class="p">[</span><span class="n">PRIORITY_INDEX</span><span class="p">].</span><span class="n">Value</span>  <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">DefaultStat</span><span class="p">.</span><span class="n">Variables</span><span class="p">[</span><span class="n">PRIORITY_INDEX</span><span class="p">].</span><span class="n">Max</span>  <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;AnnoyComputerFactor&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">AnnoyComputerFactor</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;AiAdjacentRange&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">AiAdjacentRange</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;DecayRate&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">DecayRate</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Corpse&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">CorpseName</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">CorpseType</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;DamageType&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="c1">//int check = ExtraDeathIndex(value);</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">DamageType</span> <span class="o">=</span> <span class="n">value</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;ExplodeWhenKilled&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">ExplodeWhenKilled</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">Explosion</span><span class="p">.</span><span class="n">Name</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">Explosion</span><span class="p">.</span><span class="n">Missile</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;TeleportCost&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">TeleportCost</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;TeleportEffectIn&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">TeleportEffectIn</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LuaCallback</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;TeleportEffectOut&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">TeleportEffectOut</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LuaCallback</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;DeathExplosion&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">DeathExplosion</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LuaCallback</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;OnHit&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">OnHit</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LuaCallback</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;OnEachCycle&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">OnEachCycle</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LuaCallback</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;OnEachSecond&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">OnEachSecond</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LuaCallback</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;OnInit&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">OnInit</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LuaCallback</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;OnReady&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">OnReady</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LuaCallback</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Type&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;land&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">type</span><span class="o">-&gt;</span><span class="n">UnitType</span> <span class="o">=</span> <span class="n">UnitTypeLand</span><span class="p">;</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;fly&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">type</span><span class="o">-&gt;</span><span class="n">UnitType</span> <span class="o">=</span> <span class="n">UnitTypeFly</span><span class="p">;</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;naval&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">type</span><span class="o">-&gt;</span><span class="n">UnitType</span> <span class="o">=</span> <span class="n">UnitTypeNaval</span><span class="p">;</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Unsupported Type: %s&quot;</span> <span class="n">_C_</span> <span class="n">value</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;MissileOffsets&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="k">const</span> <span class="kt">int</span> <span class="n">subargs</span> <span class="o">=</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">subargs</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">)</span> <span class="o">||</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">)</span> <span class="o">!=</span> <span class="n">UnitSides</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
				<span class="p">}</span>
				<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">m</span> <span class="o">&lt;</span> <span class="n">UnitSides</span><span class="p">;</span> <span class="o">++</span><span class="n">m</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
					<span class="n">CclGetPos</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">type</span><span class="o">-&gt;</span><span class="n">MissileOffsets</span><span class="p">[</span><span class="n">m</span><span class="p">][</span><span class="n">k</span><span class="p">].</span><span class="n">x</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">type</span><span class="o">-&gt;</span><span class="n">MissileOffsets</span><span class="p">[</span><span class="n">m</span><span class="p">][</span><span class="n">k</span><span class="p">].</span><span class="n">y</span><span class="p">);</span>
					<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
				<span class="p">}</span>
				<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Impact&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="k">const</span> <span class="kt">int</span> <span class="n">subargs</span> <span class="o">=</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">subargs</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="o">++</span><span class="n">k</span><span class="p">;</span>

				<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="s">&quot;general&quot;</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">type</span><span class="o">-&gt;</span><span class="n">Impact</span><span class="p">[</span><span class="n">ANIMATIONS_DEATHTYPES</span><span class="p">].</span><span class="n">Name</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
					<span class="n">type</span><span class="o">-&gt;</span><span class="n">Impact</span><span class="p">[</span><span class="n">ANIMATIONS_DEATHTYPES</span><span class="p">].</span><span class="n">Missile</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
				<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="s">&quot;shield&quot;</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">type</span><span class="o">-&gt;</span><span class="n">Impact</span><span class="p">[</span><span class="n">ANIMATIONS_DEATHTYPES</span> <span class="o">+</span> <span class="mi">1</span><span class="p">].</span><span class="n">Name</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
					<span class="n">type</span><span class="o">-&gt;</span><span class="n">Impact</span><span class="p">[</span><span class="n">ANIMATIONS_DEATHTYPES</span> <span class="o">+</span> <span class="mi">1</span><span class="p">].</span><span class="n">Missile</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
				<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
					<span class="kt">int</span> <span class="n">num</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
					<span class="k">for</span> <span class="p">(;</span> <span class="n">num</span> <span class="o">&lt;</span> <span class="n">ANIMATIONS_DEATHTYPES</span><span class="p">;</span> <span class="o">++</span><span class="n">num</span><span class="p">)</span> <span class="p">{</span>
						<span class="k">if</span> <span class="p">(</span><span class="n">dtype</span> <span class="o">==</span> <span class="n">ExtraDeathTypes</span><span class="p">[</span><span class="n">num</span><span class="p">])</span> <span class="p">{</span>
							<span class="k">break</span><span class="p">;</span>
						<span class="p">}</span>
					<span class="p">}</span>
					<span class="k">if</span> <span class="p">(</span><span class="n">num</span> <span class="o">==</span> <span class="n">ANIMATIONS_DEATHTYPES</span><span class="p">)</span> <span class="p">{</span>
						<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Death type not found: %s&quot;</span> <span class="n">_C_</span> <span class="n">dtype</span><span class="p">);</span>
					<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
						<span class="n">type</span><span class="o">-&gt;</span><span class="n">Impact</span><span class="p">[</span><span class="n">num</span><span class="p">].</span><span class="n">Name</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
						<span class="n">type</span><span class="o">-&gt;</span><span class="n">Impact</span><span class="p">[</span><span class="n">num</span><span class="p">].</span><span class="n">Missile</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
					<span class="p">}</span>
				<span class="p">}</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;RightMouseAction&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;none&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">type</span><span class="o">-&gt;</span><span class="n">MouseAction</span> <span class="o">=</span> <span class="n">MouseActionNone</span><span class="p">;</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;attack&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">type</span><span class="o">-&gt;</span><span class="n">MouseAction</span> <span class="o">=</span> <span class="n">MouseActionAttack</span><span class="p">;</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;move&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">type</span><span class="o">-&gt;</span><span class="n">MouseAction</span> <span class="o">=</span> <span class="n">MouseActionMove</span><span class="p">;</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;harvest&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">type</span><span class="o">-&gt;</span><span class="n">MouseAction</span> <span class="o">=</span> <span class="n">MouseActionHarvest</span><span class="p">;</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;spell-cast&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">type</span><span class="o">-&gt;</span><span class="n">MouseAction</span> <span class="o">=</span> <span class="n">MouseActionSpellCast</span><span class="p">;</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;sail&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">type</span><span class="o">-&gt;</span><span class="n">MouseAction</span> <span class="o">=</span> <span class="n">MouseActionSail</span><span class="p">;</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Unsupported RightMouseAction: %s&quot;</span> <span class="n">_C_</span> <span class="n">value</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;CanAttack&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">CanAttack</span> <span class="o">=</span> <span class="n">LuaToBoolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;RepairRange&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">RepairRange</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;RepairHp&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">RepairHP</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;RepairCosts&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="k">const</span> <span class="kt">int</span> <span class="n">subargs</span> <span class="o">=</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">subargs</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="k">const</span> <span class="kt">int</span> <span class="n">res</span> <span class="o">=</span> <span class="n">CclGetResourceByName</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
				<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
				<span class="o">++</span><span class="n">k</span><span class="p">;</span>
				<span class="n">type</span><span class="o">-&gt;</span><span class="n">RepairCosts</span><span class="p">[</span><span class="n">res</span><span class="p">]</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;CanTargetLand&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">LuaToBoolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">type</span><span class="o">-&gt;</span><span class="n">CanTarget</span> <span class="o">|=</span> <span class="n">CanTargetLand</span><span class="p">;</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="n">type</span><span class="o">-&gt;</span><span class="n">CanTarget</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="n">CanTargetLand</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;CanTargetSea&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">LuaToBoolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">type</span><span class="o">-&gt;</span><span class="n">CanTarget</span> <span class="o">|=</span> <span class="n">CanTargetSea</span><span class="p">;</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="n">type</span><span class="o">-&gt;</span><span class="n">CanTarget</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="n">CanTargetSea</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;CanTargetAir&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">LuaToBoolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">type</span><span class="o">-&gt;</span><span class="n">CanTarget</span> <span class="o">|=</span> <span class="n">CanTargetAir</span><span class="p">;</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="n">type</span><span class="o">-&gt;</span><span class="n">CanTarget</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="n">CanTargetAir</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Building&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">Building</span> <span class="o">=</span> <span class="n">LuaToBoolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;BuildingRules&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="k">const</span> <span class="kt">int</span> <span class="n">subargs</span> <span class="o">=</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="c1">// Free any old restrictions if they are redefined</span>
			<span class="k">for</span> <span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">CBuildRestriction</span> <span class="o">*&gt;::</span><span class="n">iterator</span> <span class="n">b</span> <span class="o">=</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">BuildingRules</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span>
				 <span class="n">b</span> <span class="o">!=</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">BuildingRules</span><span class="p">.</span><span class="n">end</span><span class="p">();</span> <span class="o">++</span><span class="n">b</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">delete</span> <span class="o">*</span><span class="n">b</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">BuildingRules</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">subargs</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
				<span class="p">}</span>
				<span class="n">ParseBuildingRules</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">BuildingRules</span><span class="p">);</span>
				<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;AiBuildingRules&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="k">const</span> <span class="kt">int</span> <span class="n">subargs</span> <span class="o">=</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="c1">// Free any old restrictions if they are redefined</span>
			<span class="k">for</span> <span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">CBuildRestriction</span> <span class="o">*&gt;::</span><span class="n">iterator</span> <span class="n">b</span> <span class="o">=</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">AiBuildingRules</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span>
				 <span class="n">b</span> <span class="o">!=</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">AiBuildingRules</span><span class="p">.</span><span class="n">end</span><span class="p">();</span> <span class="o">++</span><span class="n">b</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">delete</span> <span class="o">*</span><span class="n">b</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">AiBuildingRules</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">subargs</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
				<span class="p">}</span>
				<span class="n">ParseBuildingRules</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">AiBuildingRules</span><span class="p">);</span>
				<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;AutoBuildRate&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">AutoBuildRate</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;LandUnit&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">LandUnit</span> <span class="o">=</span> <span class="n">LuaToBoolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;AirUnit&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">AirUnit</span> <span class="o">=</span> <span class="n">LuaToBoolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;SeaUnit&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">SeaUnit</span> <span class="o">=</span> <span class="n">LuaToBoolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;RandomMovementProbability&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">RandomMovementProbability</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;RandomMovementDistance&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">RandomMovementDistance</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;ClicksToExplode&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">ClicksToExplode</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;CanTransport&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="c1">//  Warning: CanTransport should only be used AFTER all bool flags</span>
			<span class="c1">//  have been defined.</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">type</span><span class="o">-&gt;</span><span class="n">MaxOnBoard</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// set default value.</span>
				<span class="n">type</span><span class="o">-&gt;</span><span class="n">MaxOnBoard</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="p">}</span>

			<span class="k">if</span> <span class="p">(</span><span class="n">type</span><span class="o">-&gt;</span><span class="n">BoolFlag</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">UnitTypeVar</span><span class="p">.</span><span class="n">GetNumberBoolFlag</span><span class="p">())</span> <span class="p">{</span>
				<span class="n">type</span><span class="o">-&gt;</span><span class="n">BoolFlag</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">UnitTypeVar</span><span class="p">.</span><span class="n">GetNumberBoolFlag</span><span class="p">());</span>
			<span class="p">}</span>

			<span class="k">const</span> <span class="kt">int</span> <span class="n">subargs</span> <span class="o">=</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">subargs</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="o">++</span><span class="n">k</span><span class="p">;</span>

				<span class="k">const</span> <span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="n">UnitTypeVar</span><span class="p">.</span><span class="n">BoolFlagNameLookup</span><span class="p">[</span><span class="n">value</span><span class="p">];</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">index</span> <span class="o">!=</span> <span class="mi">-1</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
					<span class="n">type</span><span class="o">-&gt;</span><span class="n">BoolFlag</span><span class="p">[</span><span class="n">index</span><span class="p">].</span><span class="n">CanTransport</span> <span class="o">=</span> <span class="n">Ccl2Condition</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">value</span><span class="p">);</span>
					<span class="k">continue</span><span class="p">;</span>
				<span class="p">}</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Unsupported flag tag for CanTransport: %s&quot;</span> <span class="n">_C_</span> <span class="n">value</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;CanGatherResources&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">const</span> <span class="kt">int</span> <span class="n">args</span> <span class="o">=</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">args</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="n">ResourceInfo</span> <span class="o">*</span><span class="n">res</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ResourceInfo</span><span class="p">;</span>
				<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
				<span class="p">}</span>
				<span class="k">const</span> <span class="kt">int</span> <span class="n">subargs</span> <span class="o">=</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
				<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">subargs</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
					<span class="o">++</span><span class="n">k</span><span class="p">;</span>
					<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;resource-id&quot;</span><span class="p">))</span> <span class="p">{</span>
						<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
						<span class="n">res</span><span class="o">-&gt;</span><span class="n">ResourceId</span> <span class="o">=</span> <span class="n">CclGetResourceByName</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
						<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
						<span class="n">type</span><span class="o">-&gt;</span><span class="n">ResInfo</span><span class="p">[</span><span class="n">res</span><span class="o">-&gt;</span><span class="n">ResourceId</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span><span class="p">;</span>
					<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;resource-step&quot;</span><span class="p">))</span> <span class="p">{</span>
						<span class="n">res</span><span class="o">-&gt;</span><span class="n">ResourceStep</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
					<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;final-resource&quot;</span><span class="p">))</span> <span class="p">{</span>
						<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
						<span class="n">res</span><span class="o">-&gt;</span><span class="n">FinalResource</span> <span class="o">=</span> <span class="n">CclGetResourceByName</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
						<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
					<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;wait-at-resource&quot;</span><span class="p">))</span> <span class="p">{</span>
						<span class="n">res</span><span class="o">-&gt;</span><span class="n">WaitAtResource</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
					<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;wait-at-depot&quot;</span><span class="p">))</span> <span class="p">{</span>
						<span class="n">res</span><span class="o">-&gt;</span><span class="n">WaitAtDepot</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
					<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;resource-capacity&quot;</span><span class="p">))</span> <span class="p">{</span>
						<span class="n">res</span><span class="o">-&gt;</span><span class="n">ResourceCapacity</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
					<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;terrain-harvester&quot;</span><span class="p">))</span> <span class="p">{</span>
						<span class="n">res</span><span class="o">-&gt;</span><span class="n">TerrainHarvester</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
						<span class="o">--</span><span class="n">k</span><span class="p">;</span>
					<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;lose-resources&quot;</span><span class="p">))</span> <span class="p">{</span>
						<span class="n">res</span><span class="o">-&gt;</span><span class="n">LoseResources</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
						<span class="o">--</span><span class="n">k</span><span class="p">;</span>
					<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;harvest-from-outside&quot;</span><span class="p">))</span> <span class="p">{</span>
						<span class="n">res</span><span class="o">-&gt;</span><span class="n">HarvestFromOutside</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
						<span class="o">--</span><span class="n">k</span><span class="p">;</span>
					<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;refinery-harvester&quot;</span><span class="p">))</span> <span class="p">{</span>
						<span class="n">res</span><span class="o">-&gt;</span><span class="n">RefineryHarvester</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
						<span class="o">--</span><span class="n">k</span><span class="p">;</span>
					<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;file-when-empty&quot;</span><span class="p">))</span> <span class="p">{</span>
						<span class="n">res</span><span class="o">-&gt;</span><span class="n">FileWhenEmpty</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
					<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;file-when-loaded&quot;</span><span class="p">))</span> <span class="p">{</span>
						<span class="n">res</span><span class="o">-&gt;</span><span class="n">FileWhenLoaded</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
					<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
						<span class="n">printf</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">%s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">Name</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
						<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Unsupported tag: %s&quot;</span> <span class="n">_C_</span> <span class="n">value</span><span class="p">);</span>
					<span class="p">}</span>
				<span class="p">}</span>
				<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">res</span><span class="o">-&gt;</span><span class="n">FinalResource</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">res</span><span class="o">-&gt;</span><span class="n">FinalResource</span> <span class="o">=</span> <span class="n">res</span><span class="o">-&gt;</span><span class="n">ResourceId</span><span class="p">;</span>
				<span class="p">}</span>
				<span class="n">Assert</span><span class="p">(</span><span class="n">res</span><span class="o">-&gt;</span><span class="n">ResourceId</span><span class="p">);</span>
				<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">BoolFlag</span><span class="p">[</span><span class="n">HARVESTER_INDEX</span><span class="p">].</span><span class="n">value</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;GivesResource&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="n">type</span><span class="o">-&gt;</span><span class="n">GivesResource</span> <span class="o">=</span> <span class="n">CclGetResourceByName</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
			<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;CanStore&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="k">const</span> <span class="kt">int</span> <span class="n">subargs</span> <span class="o">=</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">subargs</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="n">type</span><span class="o">-&gt;</span><span class="n">CanStore</span><span class="p">[</span><span class="n">CclGetResourceByName</span><span class="p">(</span><span class="n">l</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
				<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;CanCastSpell&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="c1">//</span>
			<span class="c1">// Warning: can-cast-spell should only be used AFTER all spells</span>
			<span class="c1">// have been defined. FIXME: MaxSpellType=500 or something?</span>
			<span class="c1">//</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">type</span><span class="o">-&gt;</span><span class="n">CanCastSpell</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">type</span><span class="o">-&gt;</span><span class="n">CanCastSpell</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">char</span><span class="p">[</span><span class="n">SpellTypeTable</span><span class="p">.</span><span class="n">size</span><span class="p">()];</span>
				<span class="n">memset</span><span class="p">(</span><span class="n">type</span><span class="o">-&gt;</span><span class="n">CanCastSpell</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">SpellTypeTable</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">*</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">char</span><span class="p">));</span>
			<span class="p">}</span>
			<span class="k">const</span> <span class="kt">int</span> <span class="n">subargs</span> <span class="o">=</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">subargs</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">delete</span><span class="p">[]</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">CanCastSpell</span><span class="p">;</span>
				<span class="n">type</span><span class="o">-&gt;</span><span class="n">CanCastSpell</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">subargs</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="k">const</span> <span class="n">SpellType</span> <span class="o">*</span><span class="n">spell</span> <span class="o">=</span> <span class="n">SpellTypeByIdent</span><span class="p">(</span><span class="n">value</span><span class="p">);</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">spell</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Unknown spell type: %s&quot;</span> <span class="n">_C_</span> <span class="n">value</span><span class="p">);</span>
				<span class="p">}</span>
				<span class="n">type</span><span class="o">-&gt;</span><span class="n">CanCastSpell</span><span class="p">[</span><span class="n">spell</span><span class="o">-&gt;</span><span class="n">Slot</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;AutoCastActive&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="c1">//</span>
			<span class="c1">// Warning: AutoCastActive should only be used AFTER all spells</span>
			<span class="c1">// have been defined.</span>
			<span class="c1">//</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">type</span><span class="o">-&gt;</span><span class="n">AutoCastActive</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">type</span><span class="o">-&gt;</span><span class="n">AutoCastActive</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">char</span><span class="p">[</span><span class="n">SpellTypeTable</span><span class="p">.</span><span class="n">size</span><span class="p">()];</span>
				<span class="n">memset</span><span class="p">(</span><span class="n">type</span><span class="o">-&gt;</span><span class="n">AutoCastActive</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">SpellTypeTable</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">*</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">char</span><span class="p">));</span>
			<span class="p">}</span>
			<span class="k">const</span> <span class="kt">int</span> <span class="n">subargs</span> <span class="o">=</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">subargs</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">delete</span><span class="p">[]</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">AutoCastActive</span><span class="p">;</span>
				<span class="n">type</span><span class="o">-&gt;</span><span class="n">AutoCastActive</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>

			<span class="p">}</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">subargs</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="k">const</span> <span class="n">SpellType</span> <span class="o">*</span><span class="n">spell</span> <span class="o">=</span> <span class="n">SpellTypeByIdent</span><span class="p">(</span><span class="n">value</span><span class="p">);</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">spell</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;AutoCastActive : Unknown spell type: %s&quot;</span> <span class="n">_C_</span> <span class="n">value</span><span class="p">);</span>
				<span class="p">}</span>
				<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">spell</span><span class="o">-&gt;</span><span class="n">AutoCast</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;AutoCastActive : Define autocast method for %s.&quot;</span> <span class="n">_C_</span> <span class="n">value</span><span class="p">);</span>
				<span class="p">}</span>
				<span class="n">type</span><span class="o">-&gt;</span><span class="n">AutoCastActive</span><span class="p">[</span><span class="n">spell</span><span class="o">-&gt;</span><span class="n">Slot</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;CanTargetFlag&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="c1">//</span>
			<span class="c1">// Warning: can-target-flag should only be used AFTER all bool flags</span>
			<span class="c1">// have been defined.</span>
			<span class="c1">//</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">type</span><span class="o">-&gt;</span><span class="n">BoolFlag</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">UnitTypeVar</span><span class="p">.</span><span class="n">GetNumberBoolFlag</span><span class="p">())</span> <span class="p">{</span>
				<span class="n">type</span><span class="o">-&gt;</span><span class="n">BoolFlag</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">UnitTypeVar</span><span class="p">.</span><span class="n">GetNumberBoolFlag</span><span class="p">());</span>
			<span class="p">}</span>
			<span class="k">const</span> <span class="kt">int</span> <span class="n">subargs</span> <span class="o">=</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">subargs</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="o">++</span><span class="n">k</span><span class="p">;</span>
				<span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="n">UnitTypeVar</span><span class="p">.</span><span class="n">BoolFlagNameLookup</span><span class="p">[</span><span class="n">value</span><span class="p">];</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">index</span> <span class="o">!=</span> <span class="mi">-1</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
					<span class="n">type</span><span class="o">-&gt;</span><span class="n">BoolFlag</span><span class="p">[</span><span class="n">index</span><span class="p">].</span><span class="n">CanTargetFlag</span> <span class="o">=</span> <span class="n">Ccl2Condition</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">value</span><span class="p">);</span>
					<span class="k">continue</span><span class="p">;</span>
				<span class="p">}</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Unsupported flag tag for can-target-flag: %s&quot;</span> <span class="n">_C_</span> <span class="n">value</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;PriorityTarget&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="c1">//</span>
			<span class="c1">// Warning: ai-priority-target should only be used AFTER all bool flags</span>
			<span class="c1">// have been defined.</span>
			<span class="c1">//</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">type</span><span class="o">-&gt;</span><span class="n">BoolFlag</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">UnitTypeVar</span><span class="p">.</span><span class="n">GetNumberBoolFlag</span><span class="p">())</span> <span class="p">{</span>
				<span class="n">type</span><span class="o">-&gt;</span><span class="n">BoolFlag</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">UnitTypeVar</span><span class="p">.</span><span class="n">GetNumberBoolFlag</span><span class="p">());</span>
			<span class="p">}</span>
			<span class="k">const</span> <span class="kt">int</span> <span class="n">subargs</span> <span class="o">=</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">subargs</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="o">++</span><span class="n">k</span><span class="p">;</span>
				<span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="n">UnitTypeVar</span><span class="p">.</span><span class="n">BoolFlagNameLookup</span><span class="p">[</span><span class="n">value</span><span class="p">];</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">index</span> <span class="o">!=</span> <span class="mi">-1</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
					<span class="n">type</span><span class="o">-&gt;</span><span class="n">BoolFlag</span><span class="p">[</span><span class="n">index</span><span class="p">].</span><span class="n">AiPriorityTarget</span> <span class="o">=</span> <span class="n">Ccl2Condition</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">value</span><span class="p">);</span>
					<span class="k">continue</span><span class="p">;</span>
				<span class="p">}</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Unsupported flag tag for ai-priority-target: %s&quot;</span> <span class="n">_C_</span> <span class="n">value</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Sounds&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="k">const</span> <span class="kt">int</span> <span class="n">subargs</span> <span class="o">=</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">subargs</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="o">++</span><span class="n">k</span><span class="p">;</span>

				<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;selected&quot;</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">type</span><span class="o">-&gt;</span><span class="n">Sound</span><span class="p">.</span><span class="n">Selected</span><span class="p">.</span><span class="n">Name</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;acknowledge&quot;</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">type</span><span class="o">-&gt;</span><span class="n">Sound</span><span class="p">.</span><span class="n">Acknowledgement</span><span class="p">.</span><span class="n">Name</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;attack&quot;</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">type</span><span class="o">-&gt;</span><span class="n">Sound</span><span class="p">.</span><span class="n">Attack</span><span class="p">.</span><span class="n">Name</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;build&quot;</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">type</span><span class="o">-&gt;</span><span class="n">Sound</span><span class="p">.</span><span class="n">Build</span><span class="p">.</span><span class="n">Name</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;ready&quot;</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">type</span><span class="o">-&gt;</span><span class="n">Sound</span><span class="p">.</span><span class="n">Ready</span><span class="p">.</span><span class="n">Name</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;repair&quot;</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">type</span><span class="o">-&gt;</span><span class="n">Sound</span><span class="p">.</span><span class="n">Repair</span><span class="p">.</span><span class="n">Name</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;harvest&quot;</span><span class="p">))</span> <span class="p">{</span>
					<span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">name</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
					<span class="o">++</span><span class="n">k</span><span class="p">;</span>
					<span class="k">const</span> <span class="kt">int</span> <span class="n">resId</span> <span class="o">=</span> <span class="n">GetResourceIdByName</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">name</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
					<span class="n">type</span><span class="o">-&gt;</span><span class="n">Sound</span><span class="p">.</span><span class="n">Harvest</span><span class="p">[</span><span class="n">resId</span><span class="p">].</span><span class="n">Name</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;help&quot;</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">type</span><span class="o">-&gt;</span><span class="n">Sound</span><span class="p">.</span><span class="n">Help</span><span class="p">.</span><span class="n">Name</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;work-complete&quot;</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">type</span><span class="o">-&gt;</span><span class="n">Sound</span><span class="p">.</span><span class="n">WorkComplete</span><span class="p">.</span><span class="n">Name</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;dead&quot;</span><span class="p">))</span> <span class="p">{</span>
					<span class="kt">int</span> <span class="n">death</span><span class="p">;</span>

					<span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">name</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
					<span class="k">for</span> <span class="p">(</span><span class="n">death</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">death</span> <span class="o">&lt;</span> <span class="n">ANIMATIONS_DEATHTYPES</span><span class="p">;</span> <span class="o">++</span><span class="n">death</span><span class="p">)</span> <span class="p">{</span>
						<span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="o">==</span> <span class="n">ExtraDeathTypes</span><span class="p">[</span><span class="n">death</span><span class="p">])</span> <span class="p">{</span>
							<span class="o">++</span><span class="n">k</span><span class="p">;</span>
							<span class="k">break</span><span class="p">;</span>
						<span class="p">}</span>
					<span class="p">}</span>
					<span class="k">if</span> <span class="p">(</span><span class="n">death</span> <span class="o">==</span> <span class="n">ANIMATIONS_DEATHTYPES</span><span class="p">)</span> <span class="p">{</span>
						<span class="n">type</span><span class="o">-&gt;</span><span class="n">Sound</span><span class="p">.</span><span class="n">Dead</span><span class="p">[</span><span class="n">ANIMATIONS_DEATHTYPES</span><span class="p">].</span><span class="n">Name</span> <span class="o">=</span> <span class="n">name</span><span class="p">;</span>
					<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
						<span class="n">type</span><span class="o">-&gt;</span><span class="n">Sound</span><span class="p">.</span><span class="n">Dead</span><span class="p">[</span><span class="n">death</span><span class="p">].</span><span class="n">Name</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
					<span class="p">}</span>
				<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
					<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Unsupported sound tag: %s&quot;</span> <span class="n">_C_</span> <span class="n">value</span><span class="p">);</span>
				<span class="p">}</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="n">UnitTypeVar</span><span class="p">.</span><span class="n">VariableNameLookup</span><span class="p">[</span><span class="n">value</span><span class="p">];</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">index</span> <span class="o">!=</span> <span class="mi">-1</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// valid index</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">lua_isboolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">type</span><span class="o">-&gt;</span><span class="n">DefaultStat</span><span class="p">.</span><span class="n">Variables</span><span class="p">[</span><span class="n">index</span><span class="p">].</span><span class="n">Enable</span> <span class="o">=</span> <span class="n">LuaToBoolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
				<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">DefineVariableField</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">DefaultStat</span><span class="p">.</span><span class="n">Variables</span> <span class="o">+</span> <span class="n">index</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
				<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">lua_isnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">type</span><span class="o">-&gt;</span><span class="n">DefaultStat</span><span class="p">.</span><span class="n">Variables</span><span class="p">[</span><span class="n">index</span><span class="p">].</span><span class="n">Enable</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
					<span class="n">type</span><span class="o">-&gt;</span><span class="n">DefaultStat</span><span class="p">.</span><span class="n">Variables</span><span class="p">[</span><span class="n">index</span><span class="p">].</span><span class="n">Value</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
					<span class="n">type</span><span class="o">-&gt;</span><span class="n">DefaultStat</span><span class="p">.</span><span class="n">Variables</span><span class="p">[</span><span class="n">index</span><span class="p">].</span><span class="n">Max</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
				<span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="c1">// Error</span>
					<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument for the variable in unittype&quot;</span><span class="p">);</span>
				<span class="p">}</span>
				<span class="k">continue</span><span class="p">;</span>
			<span class="p">}</span>

			<span class="k">if</span> <span class="p">(</span><span class="n">type</span><span class="o">-&gt;</span><span class="n">BoolFlag</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">UnitTypeVar</span><span class="p">.</span><span class="n">GetNumberBoolFlag</span><span class="p">())</span> <span class="p">{</span>
				<span class="n">type</span><span class="o">-&gt;</span><span class="n">BoolFlag</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">UnitTypeVar</span><span class="p">.</span><span class="n">GetNumberBoolFlag</span><span class="p">());</span>
			<span class="p">}</span>

			<span class="n">index</span> <span class="o">=</span> <span class="n">UnitTypeVar</span><span class="p">.</span><span class="n">BoolFlagNameLookup</span><span class="p">[</span><span class="n">value</span><span class="p">];</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">index</span> <span class="o">!=</span> <span class="mi">-1</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">lua_isnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">type</span><span class="o">-&gt;</span><span class="n">BoolFlag</span><span class="p">[</span><span class="n">index</span><span class="p">].</span><span class="n">value</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
				<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
					<span class="n">type</span><span class="o">-&gt;</span><span class="n">BoolFlag</span><span class="p">[</span><span class="n">index</span><span class="p">].</span><span class="n">value</span> <span class="o">=</span> <span class="n">LuaToBoolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
				<span class="p">}</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="n">printf</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">%s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">Name</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Unsupported tag: %s&quot;</span> <span class="n">_C_</span> <span class="n">value</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="c1">// If number of directions is not specified, make a guess</span>
	<span class="c1">// Building have 1 direction and units 8</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">type</span><span class="o">-&gt;</span><span class="n">Building</span> <span class="o">&amp;&amp;</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">NumDirections</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">type</span><span class="o">-&gt;</span><span class="n">NumDirections</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">type</span><span class="o">-&gt;</span><span class="n">NumDirections</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">type</span><span class="o">-&gt;</span><span class="n">NumDirections</span> <span class="o">=</span> <span class="mi">8</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="c1">// FIXME: try to simplify/combine the flags instead</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">type</span><span class="o">-&gt;</span><span class="n">MouseAction</span> <span class="o">==</span> <span class="n">MouseActionAttack</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">type</span><span class="o">-&gt;</span><span class="n">CanAttack</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Unit-type &#39;%s&#39;: right-attack is set, but can-attack is not</span><span class="se">\n</span><span class="s">&quot;</span> <span class="n">_C_</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">Name</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
	<span class="p">}</span>
	<span class="n">UpdateDefaultBoolFlags</span><span class="p">(</span><span class="o">*</span><span class="n">type</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">CclInConfigFile</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">UpdateUnitStats</span><span class="p">(</span><span class="o">*</span><span class="n">type</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                        </details>
                        
                        <details>
                        <summary>DefineUnitStats</summary>
                        <p><br>  Parse unit-stats.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/unit/script_unittype.cpp:1247 CclDefineUnitStats</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclDefineUnitStats</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">CUnitType</span> <span class="o">*</span><span class="n">type</span> <span class="o">=</span> <span class="n">UnitTypeByIdent</span><span class="p">(</span><span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">));</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">playerId</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>

	<span class="n">Assert</span><span class="p">(</span><span class="n">type</span><span class="p">);</span>
	<span class="n">Assert</span><span class="p">(</span><span class="n">playerId</span> <span class="o">&lt;</span> <span class="n">PlayerMax</span><span class="p">);</span>

	<span class="n">CUnitStats</span> <span class="o">*</span><span class="n">stats</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">type</span><span class="o">-&gt;</span><span class="n">Stats</span><span class="p">[</span><span class="n">playerId</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">stats</span><span class="o">-&gt;</span><span class="n">Variables</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">stats</span><span class="o">-&gt;</span><span class="n">Variables</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CVariable</span><span class="p">[</span><span class="n">UnitTypeVar</span><span class="p">.</span><span class="n">GetNumberVariable</span><span class="p">()];</span>
	<span class="p">}</span>

	<span class="c1">// Parse the list: (still everything could be changed!)</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">args</span> <span class="o">=</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">args</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="o">++</span><span class="n">j</span><span class="p">;</span>

		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;costs&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="k">const</span> <span class="kt">int</span> <span class="n">subargs</span> <span class="o">=</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>

			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">subargs</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="o">++</span><span class="n">k</span><span class="p">;</span>
				<span class="k">const</span> <span class="kt">int</span> <span class="n">resId</span> <span class="o">=</span> <span class="n">GetResourceIdByName</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">value</span><span class="p">);</span>
				<span class="n">stats</span><span class="o">-&gt;</span><span class="n">Costs</span><span class="p">[</span><span class="n">resId</span><span class="p">]</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;storing&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="k">const</span> <span class="kt">int</span> <span class="n">subargs</span> <span class="o">=</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>

			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">subargs</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="o">++</span><span class="n">k</span><span class="p">;</span>
				<span class="k">const</span> <span class="kt">int</span> <span class="n">resId</span> <span class="o">=</span> <span class="n">GetResourceIdByName</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">value</span><span class="p">);</span>
				<span class="n">stats</span><span class="o">-&gt;</span><span class="n">Storing</span><span class="p">[</span><span class="n">resId</span><span class="p">]</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;improve-production&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="k">const</span> <span class="kt">int</span> <span class="n">subargs</span> <span class="o">=</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>

			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">subargs</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="o">++</span><span class="n">k</span><span class="p">;</span>
				<span class="k">const</span> <span class="kt">int</span> <span class="n">resId</span> <span class="o">=</span> <span class="n">GetResourceIdByName</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">value</span><span class="p">);</span>
				<span class="n">stats</span><span class="o">-&gt;</span><span class="n">ImproveIncomes</span><span class="p">[</span><span class="n">resId</span><span class="p">]</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">UnitTypeVar</span><span class="p">.</span><span class="n">VariableNameLookup</span><span class="p">[</span><span class="n">value</span><span class="p">];</span><span class="c1">// User variables</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">!=</span> <span class="mi">-1</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// valid index</span>
				<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">DefineVariableField</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">stats</span><span class="o">-&gt;</span><span class="n">Variables</span> <span class="o">+</span> <span class="n">i</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
				<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">lua_isnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">stats</span><span class="o">-&gt;</span><span class="n">Variables</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">Enable</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
					<span class="n">stats</span><span class="o">-&gt;</span><span class="n">Variables</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">Value</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
					<span class="n">stats</span><span class="o">-&gt;</span><span class="n">Variables</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">Max</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
				<span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="c1">// Error</span>
					<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument for the variable in unittype&quot;</span><span class="p">);</span>
				<span class="p">}</span>
				<span class="k">continue</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="c1">// This leaves a half initialized unit</span>
			<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Unsupported tag: %s&quot;</span> <span class="n">_C_</span> <span class="n">value</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>DefineBoolFlags</summary>
                        <p><br>  Define boolean flag.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/unit/script_unittype.cpp:1672 CclDefineBoolFlags</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclDefineBoolFlags</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">old</span> <span class="o">=</span> <span class="n">UnitTypeVar</span><span class="p">.</span><span class="n">GetNumberBoolFlag</span><span class="p">();</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">args</span> <span class="o">=</span> <span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">args</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">str</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>

		<span class="n">UnitTypeVar</span><span class="p">.</span><span class="n">BoolFlagNameLookup</span><span class="p">.</span><span class="n">AddKey</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>

	<span class="p">}</span>

	<span class="k">if</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&lt;</span> <span class="n">old</span> <span class="o">&amp;&amp;</span> <span class="n">old</span> <span class="o">!=</span> <span class="n">UnitTypeVar</span><span class="p">.</span><span class="n">GetNumberBoolFlag</span><span class="p">())</span> <span class="p">{</span>
		<span class="kt">size_t</span> <span class="n">new_size</span> <span class="o">=</span> <span class="n">UnitTypeVar</span><span class="p">.</span><span class="n">GetNumberBoolFlag</span><span class="p">();</span>
		<span class="k">for</span> <span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">CUnitType</span> <span class="o">*&gt;::</span><span class="n">size_type</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">UnitTypes</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// adjust array for unit already defined</span>
			<span class="n">UnitTypes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">BoolFlag</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">new_size</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>DefineVariables</summary>
                        <p><br>  Define user variables.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/unit/script_unittype.cpp:1647 CclDefineVariables</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclDefineVariables</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">old</span> <span class="o">=</span> <span class="n">UnitTypeVar</span><span class="p">.</span><span class="n">GetNumberVariable</span><span class="p">();</span>

	<span class="k">const</span> <span class="kt">int</span> <span class="n">args</span> <span class="o">=</span> <span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">args</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">str</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>

		<span class="k">const</span> <span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="n">UnitTypeVar</span><span class="p">.</span><span class="n">VariableNameLookup</span><span class="p">.</span><span class="n">AddKey</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">index</span> <span class="o">==</span> <span class="n">old</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">old</span><span class="o">++</span><span class="p">;</span>
			<span class="n">UnitTypeVar</span><span class="p">.</span><span class="n">Variable</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">old</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">DebugPrint</span><span class="p">(</span><span class="s">&quot;Warning, User Variable </span><span class="se">\&quot;</span><span class="s">%s</span><span class="se">\&quot;</span><span class="s"> redefined</span><span class="se">\n</span><span class="s">&quot;</span> <span class="n">_C_</span> <span class="n">str</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">2</span><span class="p">))</span> <span class="p">{</span> <span class="c1">// No change =&gt; default value.</span>
			<span class="k">continue</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="o">++</span><span class="n">j</span><span class="p">;</span>
		<span class="n">DefineVariableField</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="o">&amp;</span><span class="p">(</span><span class="n">UnitTypeVar</span><span class="p">.</span><span class="n">Variable</span><span class="p">[</span><span class="n">index</span><span class="p">]),</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>DefineDecorations</summary>
                        <p><br>  Define Decorations for user variables<br><br>  @param l  Lua state.<br><br>  @todo modify Assert with luastate with User Error.<br>  @todo continue to add configuration.</p>
                          <details>
                          <summary>/unit/script_unittype.cpp:1850 CclDefineDecorations</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclDefineDecorations</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="p">{</span>
		<span class="kt">int</span> <span class="n">Index</span><span class="p">;</span>
		<span class="kt">int</span> <span class="n">OffsetX</span><span class="p">;</span>
		<span class="kt">int</span> <span class="n">OffsetY</span><span class="p">;</span>
		<span class="kt">int</span> <span class="n">OffsetXPercent</span><span class="p">;</span>
		<span class="kt">int</span> <span class="n">OffsetYPercent</span><span class="p">;</span>
		<span class="kt">bool</span> <span class="n">IsCenteredInX</span><span class="p">;</span>
		<span class="kt">bool</span> <span class="n">IsCenteredInY</span><span class="p">;</span>
		<span class="kt">bool</span> <span class="n">ShowIfNotEnable</span><span class="p">;</span>
		<span class="kt">bool</span> <span class="n">ShowWhenNull</span><span class="p">;</span>
		<span class="kt">bool</span> <span class="n">HideHalf</span><span class="p">;</span>
		<span class="kt">bool</span> <span class="n">ShowWhenMax</span><span class="p">;</span>
		<span class="kt">bool</span> <span class="n">ShowOnlySelected</span><span class="p">;</span>
		<span class="kt">bool</span> <span class="n">HideNeutral</span><span class="p">;</span>
		<span class="kt">bool</span> <span class="n">HideAllied</span><span class="p">;</span>
		<span class="kt">bool</span> <span class="n">ShowOpponent</span><span class="p">;</span>
	<span class="p">}</span> <span class="n">tmp</span><span class="p">;</span>

	<span class="k">const</span> <span class="kt">int</span> <span class="n">nargs</span> <span class="o">=</span> <span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nargs</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">Assert</span><span class="p">(</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">));</span>
		<span class="n">CDecoVar</span> <span class="o">*</span><span class="n">decovar</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
		<span class="n">memset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tmp</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">tmp</span><span class="p">));</span>
		<span class="n">lua_pushnil</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
		<span class="k">while</span> <span class="p">(</span><span class="n">lua_next</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">key</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-2</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s">&quot;Index&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="k">const</span> <span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
				<span class="n">tmp</span><span class="p">.</span><span class="n">Index</span> <span class="o">=</span> <span class="n">UnitTypeVar</span><span class="p">.</span><span class="n">VariableNameLookup</span><span class="p">[</span><span class="n">value</span><span class="p">];</span><span class="c1">// User variables</span>
				<span class="n">Assert</span><span class="p">(</span><span class="n">tmp</span><span class="p">.</span><span class="n">Index</span> <span class="o">!=</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s">&quot;Offset&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">CclGetPos</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">tmp</span><span class="p">.</span><span class="n">OffsetX</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">tmp</span><span class="p">.</span><span class="n">OffsetY</span><span class="p">);</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s">&quot;OffsetPercent&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">CclGetPos</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">tmp</span><span class="p">.</span><span class="n">OffsetXPercent</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">tmp</span><span class="p">.</span><span class="n">OffsetYPercent</span><span class="p">);</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s">&quot;CenterX&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">tmp</span><span class="p">.</span><span class="n">IsCenteredInX</span> <span class="o">=</span> <span class="n">LuaToBoolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s">&quot;CenterY&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">tmp</span><span class="p">.</span><span class="n">IsCenteredInY</span> <span class="o">=</span> <span class="n">LuaToBoolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s">&quot;ShowIfNotEnable&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">tmp</span><span class="p">.</span><span class="n">ShowIfNotEnable</span> <span class="o">=</span> <span class="n">LuaToBoolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s">&quot;ShowWhenNull&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">tmp</span><span class="p">.</span><span class="n">ShowWhenNull</span> <span class="o">=</span> <span class="n">LuaToBoolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s">&quot;HideHalf&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">tmp</span><span class="p">.</span><span class="n">HideHalf</span> <span class="o">=</span> <span class="n">LuaToBoolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s">&quot;ShowWhenMax&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">tmp</span><span class="p">.</span><span class="n">ShowWhenMax</span> <span class="o">=</span> <span class="n">LuaToBoolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s">&quot;ShowOnlySelected&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">tmp</span><span class="p">.</span><span class="n">ShowOnlySelected</span> <span class="o">=</span> <span class="n">LuaToBoolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s">&quot;HideNeutral&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">tmp</span><span class="p">.</span><span class="n">HideNeutral</span> <span class="o">=</span> <span class="n">LuaToBoolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s">&quot;HideAllied&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">tmp</span><span class="p">.</span><span class="n">HideAllied</span> <span class="o">=</span> <span class="n">LuaToBoolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s">&quot;ShowOpponent&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">tmp</span><span class="p">.</span><span class="n">ShowOpponent</span> <span class="o">=</span> <span class="n">LuaToBoolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s">&quot;Method&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">Assert</span><span class="p">(</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">));</span>
				<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="c1">// MethodName</span>
				<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-2</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span> <span class="c1">// Data</span>
				<span class="n">Assert</span><span class="p">(</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">));</span>
				<span class="n">key</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-2</span><span class="p">);</span>
				<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s">&quot;bar&quot;</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">CDecoVarBar</span> <span class="o">*</span><span class="n">decovarbar</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CDecoVarBar</span><span class="p">;</span>
					<span class="n">lua_pushnil</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
					<span class="k">while</span> <span class="p">(</span><span class="n">lua_next</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-2</span><span class="p">))</span> <span class="p">{</span>
						<span class="n">key</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-2</span><span class="p">);</span>
						<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s">&quot;Height&quot;</span><span class="p">))</span> <span class="p">{</span>
							<span class="n">decovarbar</span><span class="o">-&gt;</span><span class="n">Height</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
						<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s">&quot;Width&quot;</span><span class="p">))</span> <span class="p">{</span>
							<span class="n">decovarbar</span><span class="o">-&gt;</span><span class="n">Width</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
						<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s">&quot;Orientation&quot;</span><span class="p">))</span> <span class="p">{</span>
							<span class="n">key</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
							<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s">&quot;horizontal&quot;</span><span class="p">))</span> <span class="p">{</span>
								<span class="n">decovarbar</span><span class="o">-&gt;</span><span class="n">IsVertical</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
							<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s">&quot;vertical&quot;</span><span class="p">))</span> <span class="p">{</span>
								<span class="n">decovarbar</span><span class="o">-&gt;</span><span class="n">IsVertical</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
							<span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="c1">// Error</span>
								<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;invalid Orientation &#39;%s&#39; for bar in DefineDecorations&quot;</span> <span class="n">_C_</span> <span class="n">key</span><span class="p">);</span>
							<span class="p">}</span>
						<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s">&quot;SEToNW&quot;</span><span class="p">))</span> <span class="p">{</span>
							<span class="n">decovarbar</span><span class="o">-&gt;</span><span class="n">SEToNW</span> <span class="o">=</span> <span class="n">LuaToBoolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
						<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s">&quot;BorderSize&quot;</span><span class="p">))</span> <span class="p">{</span>
							<span class="n">decovarbar</span><span class="o">-&gt;</span><span class="n">BorderSize</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
						<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s">&quot;ShowFullBackground&quot;</span><span class="p">))</span> <span class="p">{</span>
							<span class="n">decovarbar</span><span class="o">-&gt;</span><span class="n">ShowFullBackground</span> <span class="o">=</span> <span class="n">LuaToBoolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
<span class="cp">#if 0</span><span class="c"> // FIXME Color configuration</span>
<span class="c">						} else if (!strcmp(key, &quot;Color&quot;)) {</span>
<span class="c">							decovar-&gt;Color = // FIXME</span>
<span class="c">						} else if (!strcmp(key, &quot;BColor&quot;)) {</span>
<span class="c">							decovar-&gt;BColor = // FIXME</span>
<span class="cp">#endif</span>
						<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
							<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;&#39;%s&#39; invalid for Method bar&quot;</span> <span class="n">_C_</span> <span class="n">key</span><span class="p">);</span>
						<span class="p">}</span>
						<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="c1">// Pop value</span>
					<span class="p">}</span>
					<span class="n">decovar</span> <span class="o">=</span> <span class="n">decovarbar</span><span class="p">;</span>
				<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s">&quot;frame&quot;</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">CDecoVarFrame</span> <span class="o">*</span><span class="n">frame</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CDecoVarFrame</span><span class="p">;</span>
					<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">))</span> <span class="p">{</span>
						<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument, need table with Thickness= and Color=&quot;</span><span class="p">);</span>
					<span class="p">}</span>
					<span class="k">for</span> <span class="p">(</span><span class="n">lua_pushnil</span><span class="p">(</span><span class="n">l</span><span class="p">);</span> <span class="n">lua_next</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-2</span><span class="p">);</span> <span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
						<span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">innerkey</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-2</span><span class="p">);</span>
						<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">innerkey</span><span class="p">,</span> <span class="s">&quot;Thickness&quot;</span><span class="p">))</span> <span class="p">{</span>
							<span class="n">frame</span><span class="o">-&gt;</span><span class="n">Thickness</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
						<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">innerkey</span><span class="p">,</span> <span class="s">&quot;ColorName&quot;</span><span class="p">))</span> <span class="p">{</span>
							<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="k">const</span> <span class="n">colorName</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
							<span class="n">frame</span><span class="o">-&gt;</span><span class="n">ColorIndex</span> <span class="o">=</span> <span class="n">GetColorIndexByName</span><span class="p">(</span><span class="n">colorName</span><span class="p">);</span>
						<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
							<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;&#39;%s&#39; invalid for Method frame&quot;</span> <span class="n">_C_</span> <span class="n">innerkey</span><span class="p">);</span>
						<span class="p">}</span>
					<span class="p">}</span>
					<span class="n">decovar</span> <span class="o">=</span> <span class="n">frame</span><span class="p">;</span>
				<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s">&quot;text&quot;</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">CDecoVarText</span> <span class="o">*</span><span class="n">decovartext</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CDecoVarText</span><span class="p">;</span>

					<span class="n">decovartext</span><span class="o">-&gt;</span><span class="n">Font</span> <span class="o">=</span> <span class="n">CFont</span><span class="o">::</span><span class="n">Get</span><span class="p">(</span><span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="mi">1</span><span class="p">));</span>
					<span class="c1">// FIXME : More arguments ? color...</span>
					<span class="n">decovar</span> <span class="o">=</span> <span class="n">decovartext</span><span class="p">;</span>
				<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s">&quot;sprite&quot;</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">CDecoVarSpriteBar</span> <span class="o">*</span><span class="n">decovarspritebar</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CDecoVarSpriteBar</span><span class="p">;</span>
					<span class="n">decovarspritebar</span><span class="o">-&gt;</span><span class="n">NSprite</span> <span class="o">=</span> <span class="n">GetSpriteIndex</span><span class="p">(</span><span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="mi">1</span><span class="p">));</span>
					<span class="k">if</span> <span class="p">(</span><span class="n">decovarspritebar</span><span class="o">-&gt;</span><span class="n">NSprite</span> <span class="o">==</span> <span class="mi">-1</span><span class="p">)</span> <span class="p">{</span>
						<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;invalid sprite-name &#39;%s&#39; for Method in DefineDecorations&quot;</span> <span class="n">_C_</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="mi">1</span><span class="p">));</span>
					<span class="p">}</span>
					<span class="c1">// FIXME : More arguments ?</span>
					<span class="n">decovar</span> <span class="o">=</span> <span class="n">decovarspritebar</span><span class="p">;</span>
				<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s">&quot;static-sprite&quot;</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">CDecoVarStaticSprite</span> <span class="o">*</span><span class="n">decovarstaticsprite</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CDecoVarStaticSprite</span><span class="p">;</span>
					<span class="k">if</span> <span class="p">(</span><span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
						<span class="n">decovarstaticsprite</span><span class="o">-&gt;</span><span class="n">NSprite</span> <span class="o">=</span> <span class="n">GetSpriteIndex</span><span class="p">(</span><span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="mi">1</span><span class="p">));</span>
						<span class="n">decovarstaticsprite</span><span class="o">-&gt;</span><span class="n">n</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
					<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
						<span class="n">decovarstaticsprite</span><span class="o">-&gt;</span><span class="n">NSprite</span> <span class="o">=</span> <span class="n">GetSpriteIndex</span><span class="p">(</span><span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="mi">1</span><span class="p">));</span>
						<span class="n">decovarstaticsprite</span><span class="o">-&gt;</span><span class="n">n</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
						<span class="n">decovarstaticsprite</span><span class="o">-&gt;</span><span class="n">FadeValue</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
					<span class="p">}</span>
					<span class="n">decovar</span> <span class="o">=</span> <span class="n">decovarstaticsprite</span><span class="p">;</span>
				<span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="c1">// Error</span>
					<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;invalid method &#39;%s&#39; for Method in DefineDecorations&quot;</span> <span class="n">_C_</span> <span class="n">key</span><span class="p">);</span>
				<span class="p">}</span>
				<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span> <span class="c1">// MethodName and data</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="c1">// Error</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;invalid key &#39;%s&#39; for DefineDecorations&quot;</span> <span class="n">_C_</span> <span class="n">key</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="c1">// Pop the value</span>
		<span class="p">}</span>
		<span class="n">decovar</span><span class="o">-&gt;</span><span class="n">Index</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">.</span><span class="n">Index</span><span class="p">;</span>
		<span class="n">decovar</span><span class="o">-&gt;</span><span class="n">OffsetX</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">.</span><span class="n">OffsetX</span><span class="p">;</span>
		<span class="n">decovar</span><span class="o">-&gt;</span><span class="n">OffsetY</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">.</span><span class="n">OffsetY</span><span class="p">;</span>
		<span class="n">decovar</span><span class="o">-&gt;</span><span class="n">OffsetXPercent</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">.</span><span class="n">OffsetXPercent</span><span class="p">;</span>
		<span class="n">decovar</span><span class="o">-&gt;</span><span class="n">OffsetYPercent</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">.</span><span class="n">OffsetYPercent</span><span class="p">;</span>
		<span class="n">decovar</span><span class="o">-&gt;</span><span class="n">IsCenteredInX</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">.</span><span class="n">IsCenteredInX</span><span class="p">;</span>
		<span class="n">decovar</span><span class="o">-&gt;</span><span class="n">IsCenteredInY</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">.</span><span class="n">IsCenteredInY</span><span class="p">;</span>
		<span class="n">decovar</span><span class="o">-&gt;</span><span class="n">ShowIfNotEnable</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">.</span><span class="n">ShowIfNotEnable</span><span class="p">;</span>
		<span class="n">decovar</span><span class="o">-&gt;</span><span class="n">ShowWhenNull</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">.</span><span class="n">ShowWhenNull</span><span class="p">;</span>
		<span class="n">decovar</span><span class="o">-&gt;</span><span class="n">HideHalf</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">.</span><span class="n">HideHalf</span><span class="p">;</span>
		<span class="n">decovar</span><span class="o">-&gt;</span><span class="n">ShowWhenMax</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">.</span><span class="n">ShowWhenMax</span><span class="p">;</span>
		<span class="n">decovar</span><span class="o">-&gt;</span><span class="n">ShowOnlySelected</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">.</span><span class="n">ShowOnlySelected</span><span class="p">;</span>
		<span class="n">decovar</span><span class="o">-&gt;</span><span class="n">HideNeutral</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">.</span><span class="n">HideNeutral</span><span class="p">;</span>
		<span class="n">decovar</span><span class="o">-&gt;</span><span class="n">HideAllied</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">.</span><span class="n">HideAllied</span><span class="p">;</span>
		<span class="n">decovar</span><span class="o">-&gt;</span><span class="n">ShowOpponent</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">.</span><span class="n">ShowOpponent</span><span class="p">;</span>
		<span class="n">UnitTypeVar</span><span class="p">.</span><span class="n">DecoVar</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">decovar</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">Assert</span><span class="p">(</span><span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">));</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>DefineExtraDeathTypes</summary>
                        <p><br>  Define default extra death types.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/unit/script_unittype.cpp:1869 CclDefineExtraDeathTypes</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclDefineExtraDeathTypes</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">args</span><span class="p">;</span>

	<span class="k">for</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">ANIMATIONS_DEATHTYPES</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">ExtraDeathTypes</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">clear</span><span class="p">();</span>
	<span class="p">}</span>
	<span class="n">args</span> <span class="o">=</span> <span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">ANIMATIONS_DEATHTYPES</span> <span class="o">&amp;&amp;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">args</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">ExtraDeathTypes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>UnitType</summary>
                        <p><br>  Get unit-type structure.<br><br>  @param l  Lua state.<br><br>  @return   Unit-type structure.</p>
                          <details>
                          <summary>/unit/script_unittype.cpp:1289 CclUnitType</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclUnitType</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

	<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">str</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">CUnitType</span> <span class="o">*</span><span class="n">type</span> <span class="o">=</span> <span class="n">UnitTypeByIdent</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>
	<span class="n">LuaUserData</span> <span class="o">*</span><span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="n">LuaUserData</span> <span class="o">*</span><span class="p">)</span><span class="n">lua_newuserdata</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">LuaUserData</span><span class="p">));</span>
	<span class="n">data</span><span class="o">-&gt;</span><span class="n">Type</span> <span class="o">=</span> <span class="n">LuaUnitType</span><span class="p">;</span>
	<span class="n">data</span><span class="o">-&gt;</span><span class="n">Data</span> <span class="o">=</span> <span class="n">type</span><span class="p">;</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>UnitTypeArray</summary>
                        <p><br>  Get all unit-type structures.<br><br>  @param l  Lua state.<br><br>  @return   An array of all unit-type structures.</p>
                          <details>
                          <summary>/unit/script_unittype.cpp:1311 CclUnitTypeArray</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclUnitTypeArray</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

	<span class="n">lua_newtable</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">CUnitType</span> <span class="o">*&gt;::</span><span class="n">size_type</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">UnitTypes</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">LuaUserData</span> <span class="o">*</span><span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="n">LuaUserData</span> <span class="o">*</span><span class="p">)</span><span class="n">lua_newuserdata</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">LuaUserData</span><span class="p">));</span>
		<span class="n">data</span><span class="o">-&gt;</span><span class="n">Type</span> <span class="o">=</span> <span class="n">LuaUnitType</span><span class="p">;</span>
		<span class="n">data</span><span class="o">-&gt;</span><span class="n">Data</span> <span class="o">=</span> <span class="n">UnitTypes</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
		<span class="n">lua_rawseti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>GetUnitTypeIdent</summary>
                        <p><br>  Get the ident of the unit-type structure.<br><br>  @param l  Lua state.<br><br>  @return   The identifier of the unit-type.</p>
                          <details>
                          <summary>/unit/script_unittype.cpp:1331 CclGetUnitTypeIdent</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclGetUnitTypeIdent</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

	<span class="k">const</span> <span class="n">CUnitType</span> <span class="o">*</span><span class="n">type</span> <span class="o">=</span> <span class="n">CclGetUnitType</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">type</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">lua_pushstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">Ident</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;unit &#39;%s&#39; not defined&quot;</span> <span class="n">_C_</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">));</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>GetUnitTypeName</summary>
                        <p><br>  Get the name of the unit-type structure.<br><br>  @param l  Lua state.<br><br>  @return   The name of the unit-type.</p>
                          <details>
                          <summary>/unit/script_unittype.cpp:1347 CclGetUnitTypeName</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclGetUnitTypeName</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

	<span class="k">const</span> <span class="n">CUnitType</span> <span class="o">*</span><span class="n">type</span> <span class="o">=</span> <span class="n">CclGetUnitType</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="n">lua_pushstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">Name</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SetUnitTypeName</summary>
                        <p><br>  Set the name of the unit-type structure.<br><br>  @param l  Lua state.<br><br>  @return   The name of the unit-type.</p>
                          <details>
                          <summary>/unit/script_unittype.cpp:1367 CclSetUnitTypeName</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetUnitTypeName</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>

	<span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">CUnitType</span> <span class="o">*</span><span class="n">type</span> <span class="o">=</span> <span class="n">CclGetUnitType</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">type</span><span class="o">-&gt;</span><span class="n">Name</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>

	<span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>GetUnitTypeData</summary>
                        <p><br>  Get unit type data.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/unit/script_unittype.cpp:1583 CclGetUnitTypeData</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclGetUnitTypeData</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">const</span> <span class="n">CUnitType</span> <span class="o">*</span><span class="n">type</span> <span class="o">=</span> <span class="n">CclGetUnitType</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">data</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;Name&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">lua_pushstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">Name</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;Icon&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">lua_pushstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">Icon</span><span class="p">.</span><span class="n">Name</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;Costs&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
		<span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">res</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
		<span class="k">const</span> <span class="kt">int</span> <span class="n">resId</span> <span class="o">=</span> <span class="n">GetResourceIdByName</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">res</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">GameRunning</span> <span class="o">&amp;&amp;</span> <span class="n">Editor</span><span class="p">.</span><span class="n">Running</span> <span class="o">!=</span> <span class="n">EditorEditing</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">DefaultStat</span><span class="p">.</span><span class="n">Costs</span><span class="p">[</span><span class="n">resId</span><span class="p">]);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">MapDefaultStat</span><span class="p">.</span><span class="n">Costs</span><span class="p">[</span><span class="n">resId</span><span class="p">]);</span>
		<span class="p">}</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;ImproveProduction&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
		<span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">res</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
		<span class="k">const</span> <span class="kt">int</span> <span class="n">resId</span> <span class="o">=</span> <span class="n">GetResourceIdByName</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">res</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">GameRunning</span> <span class="o">&amp;&amp;</span> <span class="n">Editor</span><span class="p">.</span><span class="n">Running</span> <span class="o">!=</span> <span class="n">EditorEditing</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">DefaultStat</span><span class="p">.</span><span class="n">ImproveIncomes</span><span class="p">[</span><span class="n">resId</span><span class="p">]);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">MapDefaultStat</span><span class="p">.</span><span class="n">ImproveIncomes</span><span class="p">[</span><span class="n">resId</span><span class="p">]);</span>
		<span class="p">}</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;DrawLevel&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">DrawLevel</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;TileWidth&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">TileWidth</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;TileHeight&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">TileHeight</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;ComputerReactionRange&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">ReactRangeComputer</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;PersonReactionRange&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">ReactRangePerson</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;Missile&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">lua_pushstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">Missile</span><span class="p">.</span><span class="n">Name</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;MinAttackRange&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">MinAttackRange</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;MaxAttackRange&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">GameRunning</span> <span class="o">&amp;&amp;</span> <span class="n">Editor</span><span class="p">.</span><span class="n">Running</span> <span class="o">!=</span> <span class="n">EditorEditing</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">DefaultStat</span><span class="p">.</span><span class="n">Variables</span><span class="p">[</span><span class="n">ATTACKRANGE_INDEX</span><span class="p">].</span><span class="n">Value</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">MapDefaultStat</span><span class="p">.</span><span class="n">Variables</span><span class="p">[</span><span class="n">ATTACKRANGE_INDEX</span><span class="p">].</span><span class="n">Value</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;Priority&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">GameRunning</span> <span class="o">&amp;&amp;</span> <span class="n">Editor</span><span class="p">.</span><span class="n">Running</span> <span class="o">!=</span> <span class="n">EditorEditing</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">DefaultStat</span><span class="p">.</span><span class="n">Variables</span><span class="p">[</span><span class="n">PRIORITY_INDEX</span><span class="p">].</span><span class="n">Value</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">MapDefaultStat</span><span class="p">.</span><span class="n">Variables</span><span class="p">[</span><span class="n">PRIORITY_INDEX</span><span class="p">].</span><span class="n">Value</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;Type&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">type</span><span class="o">-&gt;</span><span class="n">UnitType</span> <span class="o">==</span> <span class="n">UnitTypeLand</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">lua_pushstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;land&quot;</span><span class="p">);</span>
			<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">type</span><span class="o">-&gt;</span><span class="n">UnitType</span> <span class="o">==</span> <span class="n">UnitTypeFly</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">lua_pushstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;fly&quot;</span><span class="p">);</span>
			<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">type</span><span class="o">-&gt;</span><span class="n">UnitType</span> <span class="o">==</span> <span class="n">UnitTypeNaval</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">lua_pushstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;naval&quot;</span><span class="p">);</span>
			<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;Corpse&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">lua_pushstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">CorpseName</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;CanAttack&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">lua_pushboolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">CanAttack</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;Building&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">lua_pushboolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">Building</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;LandUnit&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">lua_pushboolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">LandUnit</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;GivesResource&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">type</span><span class="o">-&gt;</span><span class="n">GivesResource</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">lua_pushstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">DefaultResourceNames</span><span class="p">[</span><span class="n">type</span><span class="o">-&gt;</span><span class="n">GivesResource</span><span class="p">].</span><span class="n">c_str</span><span class="p">());</span>
			<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">lua_pushstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">);</span>
			<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&quot;Sounds&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
		<span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">sound_type</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">sound_type</span> <span class="o">==</span> <span class="s">&quot;selected&quot;</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">GameRunning</span> <span class="o">&amp;&amp;</span> <span class="n">Editor</span><span class="p">.</span><span class="n">Running</span> <span class="o">!=</span> <span class="n">EditorEditing</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">lua_pushstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">Sound</span><span class="p">.</span><span class="n">Selected</span><span class="p">.</span><span class="n">Name</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="n">lua_pushstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">MapSound</span><span class="p">.</span><span class="n">Selected</span><span class="p">.</span><span class="n">Name</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">sound_type</span> <span class="o">==</span> <span class="s">&quot;acknowledge&quot;</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">GameRunning</span> <span class="o">&amp;&amp;</span> <span class="n">Editor</span><span class="p">.</span><span class="n">Running</span> <span class="o">!=</span> <span class="n">EditorEditing</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">lua_pushstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">Sound</span><span class="p">.</span><span class="n">Acknowledgement</span><span class="p">.</span><span class="n">Name</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="n">lua_pushstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">MapSound</span><span class="p">.</span><span class="n">Acknowledgement</span><span class="p">.</span><span class="n">Name</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">sound_type</span> <span class="o">==</span> <span class="s">&quot;attack&quot;</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">GameRunning</span> <span class="o">&amp;&amp;</span> <span class="n">Editor</span><span class="p">.</span><span class="n">Running</span> <span class="o">!=</span> <span class="n">EditorEditing</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">lua_pushstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">Sound</span><span class="p">.</span><span class="n">Attack</span><span class="p">.</span><span class="n">Name</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="n">lua_pushstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">MapSound</span><span class="p">.</span><span class="n">Attack</span><span class="p">.</span><span class="n">Name</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">sound_type</span> <span class="o">==</span> <span class="s">&quot;build&quot;</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">GameRunning</span> <span class="o">&amp;&amp;</span> <span class="n">Editor</span><span class="p">.</span><span class="n">Running</span> <span class="o">!=</span> <span class="n">EditorEditing</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">lua_pushstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">Sound</span><span class="p">.</span><span class="n">Build</span><span class="p">.</span><span class="n">Name</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="n">lua_pushstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">MapSound</span><span class="p">.</span><span class="n">Build</span><span class="p">.</span><span class="n">Name</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">sound_type</span> <span class="o">==</span> <span class="s">&quot;ready&quot;</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">GameRunning</span> <span class="o">&amp;&amp;</span> <span class="n">Editor</span><span class="p">.</span><span class="n">Running</span> <span class="o">!=</span> <span class="n">EditorEditing</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">lua_pushstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">Sound</span><span class="p">.</span><span class="n">Ready</span><span class="p">.</span><span class="n">Name</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="n">lua_pushstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">MapSound</span><span class="p">.</span><span class="n">Ready</span><span class="p">.</span><span class="n">Name</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">sound_type</span> <span class="o">==</span> <span class="s">&quot;repair&quot;</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">GameRunning</span> <span class="o">&amp;&amp;</span> <span class="n">Editor</span><span class="p">.</span><span class="n">Running</span> <span class="o">!=</span> <span class="n">EditorEditing</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">lua_pushstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">Sound</span><span class="p">.</span><span class="n">Repair</span><span class="p">.</span><span class="n">Name</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="n">lua_pushstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">MapSound</span><span class="p">.</span><span class="n">Repair</span><span class="p">.</span><span class="n">Name</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">sound_type</span> <span class="o">==</span> <span class="s">&quot;harvest&quot;</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
			<span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">sound_subtype</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
			<span class="k">const</span> <span class="kt">int</span> <span class="n">resId</span> <span class="o">=</span> <span class="n">GetResourceIdByName</span><span class="p">(</span><span class="n">sound_subtype</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">GameRunning</span> <span class="o">&amp;&amp;</span> <span class="n">Editor</span><span class="p">.</span><span class="n">Running</span> <span class="o">!=</span> <span class="n">EditorEditing</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">lua_pushstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">Sound</span><span class="p">.</span><span class="n">Harvest</span><span class="p">[</span><span class="n">resId</span><span class="p">].</span><span class="n">Name</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="n">lua_pushstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">MapSound</span><span class="p">.</span><span class="n">Harvest</span><span class="p">[</span><span class="n">resId</span><span class="p">].</span><span class="n">Name</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">sound_type</span> <span class="o">==</span> <span class="s">&quot;help&quot;</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">GameRunning</span> <span class="o">&amp;&amp;</span> <span class="n">Editor</span><span class="p">.</span><span class="n">Running</span> <span class="o">!=</span> <span class="n">EditorEditing</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">lua_pushstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">Sound</span><span class="p">.</span><span class="n">Help</span><span class="p">.</span><span class="n">Name</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="n">lua_pushstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">MapSound</span><span class="p">.</span><span class="n">Help</span><span class="p">.</span><span class="n">Name</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">sound_type</span> <span class="o">==</span> <span class="s">&quot;dead&quot;</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">GameRunning</span> <span class="o">&amp;&amp;</span> <span class="n">Editor</span><span class="p">.</span><span class="n">Running</span> <span class="o">!=</span> <span class="n">EditorEditing</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">lua_pushstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">Sound</span><span class="p">.</span><span class="n">Dead</span><span class="p">[</span><span class="n">ANIMATIONS_DEATHTYPES</span><span class="p">].</span><span class="n">Name</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
				<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
					<span class="n">lua_pushstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">MapSound</span><span class="p">.</span><span class="n">Dead</span><span class="p">[</span><span class="n">ANIMATIONS_DEATHTYPES</span><span class="p">].</span><span class="n">Name</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
				<span class="p">}</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="kt">int</span> <span class="n">death</span><span class="p">;</span>
				<span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">sound_subtype</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>

				<span class="k">for</span> <span class="p">(</span><span class="n">death</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">death</span> <span class="o">&lt;</span> <span class="n">ANIMATIONS_DEATHTYPES</span><span class="p">;</span> <span class="o">++</span><span class="n">death</span><span class="p">)</span> <span class="p">{</span>
					<span class="k">if</span> <span class="p">(</span><span class="n">sound_subtype</span> <span class="o">==</span> <span class="n">ExtraDeathTypes</span><span class="p">[</span><span class="n">death</span><span class="p">])</span> <span class="p">{</span>
						<span class="k">break</span><span class="p">;</span>
					<span class="p">}</span>
				<span class="p">}</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">death</span> <span class="o">==</span> <span class="n">ANIMATIONS_DEATHTYPES</span><span class="p">)</span> <span class="p">{</span>
					<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">GameRunning</span> <span class="o">&amp;&amp;</span> <span class="n">Editor</span><span class="p">.</span><span class="n">Running</span> <span class="o">!=</span> <span class="n">EditorEditing</span><span class="p">)</span> <span class="p">{</span>
						<span class="n">lua_pushstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">Sound</span><span class="p">.</span><span class="n">Dead</span><span class="p">[</span><span class="n">ANIMATIONS_DEATHTYPES</span><span class="p">].</span><span class="n">Name</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
					<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
						<span class="n">lua_pushstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">MapSound</span><span class="p">.</span><span class="n">Dead</span><span class="p">[</span><span class="n">ANIMATIONS_DEATHTYPES</span><span class="p">].</span><span class="n">Name</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
					<span class="p">}</span>
				<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
					<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">GameRunning</span> <span class="o">&amp;&amp;</span> <span class="n">Editor</span><span class="p">.</span><span class="n">Running</span> <span class="o">!=</span> <span class="n">EditorEditing</span><span class="p">)</span> <span class="p">{</span>
						<span class="n">lua_pushstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">Sound</span><span class="p">.</span><span class="n">Dead</span><span class="p">[</span><span class="n">death</span><span class="p">].</span><span class="n">Name</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
					<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
						<span class="n">lua_pushstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">MapSound</span><span class="p">.</span><span class="n">Dead</span><span class="p">[</span><span class="n">death</span><span class="p">].</span><span class="n">Name</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
					<span class="p">}</span>
				<span class="p">}</span>
			<span class="p">}</span>
		<span class="p">}</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="n">UnitTypeVar</span><span class="p">.</span><span class="n">VariableNameLookup</span><span class="p">[</span><span class="n">data</span><span class="p">];</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">index</span> <span class="o">!=</span> <span class="mi">-1</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// valid index</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">GameRunning</span> <span class="o">&amp;&amp;</span> <span class="n">Editor</span><span class="p">.</span><span class="n">Running</span> <span class="o">!=</span> <span class="n">EditorEditing</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">DefaultStat</span><span class="p">.</span><span class="n">Variables</span><span class="p">[</span><span class="n">index</span><span class="p">].</span><span class="n">Value</span><span class="p">);</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">MapDefaultStat</span><span class="p">.</span><span class="n">Variables</span><span class="p">[</span><span class="n">index</span><span class="p">].</span><span class="n">Value</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>

		<span class="n">index</span> <span class="o">=</span> <span class="n">UnitTypeVar</span><span class="p">.</span><span class="n">BoolFlagNameLookup</span><span class="p">[</span><span class="n">data</span><span class="p">];</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">index</span> <span class="o">!=</span> <span class="mi">-1</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">lua_pushboolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">type</span><span class="o">-&gt;</span><span class="n">BoolFlag</span><span class="p">[</span><span class="n">index</span><span class="p">].</span><span class="n">value</span><span class="p">);</span>
			<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Invalid field: %s&quot;</span> <span class="n">_C_</span> <span class="n">data</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        <hr>/unit/script_unit.cpp<hr>
                        <details>
                        <summary>SetTrainingQueue</summary>
                        <p><br>  Set training queue<br><br>  @param l  Lua state.<br><br>  @return  The old state of the training queue</p>
                          <details>
                          <summary>/unit/script_unit.cpp:77 CclSetTrainingQueue</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetTrainingQueue</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">EnableTrainingQueue</span> <span class="o">=</span> <span class="n">LuaToBoolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SetBuildingCapture</summary>
                        <p><br>  Set capture buildings<br><br>  @param l  Lua state.<br><br>  @return   The old state of the flag</p>
                          <details>
                          <summary>/unit/script_unit.cpp:91 CclSetBuildingCapture</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetBuildingCapture</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">EnableBuildingCapture</span> <span class="o">=</span> <span class="n">LuaToBoolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SetRevealAttacker</summary>
                        <p><br>  Set reveal attacker<br><br>  @param l  Lua state.<br><br>  @return   The old state of the flag</p>
                          <details>
                          <summary>/unit/script_unit.cpp:105 CclSetRevealAttacker</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetRevealAttacker</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">RevealAttacker</span> <span class="o">=</span> <span class="n">LuaToBoolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>ResourcesMultiBuildersMultiplier</summary>
                        <p><br>  Set cost multiplier to RepairCost for buildings additional workers helping (0 = no additional cost)<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/unit/script_unit.cpp:117 CclResourcesMultiBuildersMultiplier</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclResourcesMultiBuildersMultiplier</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">ResourcesMultiBuildersMultiplier</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>Unit</summary>
                        <p><br>  Parse unit<br><br>  @param l  Lua state.<br><br>  @todo  Verify that vision table is always correct (transporter)<br>  @todo (PlaceUnit() and host-info).</p>
                          <details>
                          <summary>/unit/script_unit.cpp:604 CclUnit</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclUnit</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">slot</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="n">CUnit</span> <span class="o">*</span><span class="n">unit</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
	<span class="n">CUnitType</span> <span class="o">*</span><span class="n">type</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
	<span class="n">CUnitType</span> <span class="o">*</span><span class="n">seentype</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
	<span class="n">CPlayer</span> <span class="o">*</span><span class="n">player</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>

	<span class="c1">// Parse the list:</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">args</span> <span class="o">=</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">args</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="o">++</span><span class="n">j</span><span class="p">;</span>

		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;type&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">type</span> <span class="o">=</span> <span class="n">UnitTypeByIdent</span><span class="p">(</span><span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">));</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;seen-type&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">seentype</span> <span class="o">=</span> <span class="n">UnitTypeByIdent</span><span class="p">(</span><span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">));</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;player&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">player</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">Players</span><span class="p">[</span><span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)];</span>

			<span class="c1">// During a unit&#39;s death animation (when action is &quot;die&quot; but the</span>
			<span class="c1">// unit still has its original type, i.e. it&#39;s still not a corpse)</span>
			<span class="c1">// the unit is already removed from map and from player&#39;s</span>
			<span class="c1">// unit list (=the unit went through LetUnitDie() which</span>
			<span class="c1">// calls RemoveUnit() and UnitLost()).  Such a unit should not</span>
			<span class="c1">// be put on player&#39;s unit list!  However, this state is not</span>
			<span class="c1">// easily detected from this place.  It seems that it is</span>
			<span class="c1">// characterized by</span>
			<span class="c1">// unit-&gt;CurrentAction()==UnitActionDie so we have to wait</span>
			<span class="c1">// until we parsed at least Unit::Orders[].</span>
			<span class="n">Assert</span><span class="p">(</span><span class="n">type</span><span class="p">);</span>
			<span class="n">unit</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">UnitManager</span><span class="p">.</span><span class="n">GetSlotUnit</span><span class="p">(</span><span class="n">slot</span><span class="p">);</span>
			<span class="n">unit</span><span class="o">-&gt;</span><span class="n">Init</span><span class="p">(</span><span class="o">*</span><span class="n">type</span><span class="p">);</span>
			<span class="n">unit</span><span class="o">-&gt;</span><span class="n">Seen</span><span class="p">.</span><span class="n">Type</span> <span class="o">=</span> <span class="n">seentype</span><span class="p">;</span>
			<span class="n">unit</span><span class="o">-&gt;</span><span class="n">Active</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">unit</span><span class="o">-&gt;</span><span class="n">Removed</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">Assert</span><span class="p">(</span><span class="n">UnitNumber</span><span class="p">(</span><span class="o">*</span><span class="n">unit</span><span class="p">)</span> <span class="o">==</span> <span class="n">slot</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;current-sight-range&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">unit</span><span class="o">-&gt;</span><span class="n">CurrentSightRange</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;refs&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">unit</span><span class="o">-&gt;</span><span class="n">Refs</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;host-info&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">)</span> <span class="o">||</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">4</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="n">Vec2i</span> <span class="n">pos</span><span class="p">;</span>
			<span class="kt">int</span> <span class="n">w</span><span class="p">;</span>
			<span class="kt">int</span> <span class="n">h</span><span class="p">;</span>

			<span class="n">pos</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
			<span class="n">pos</span><span class="p">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
			<span class="n">w</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
			<span class="n">h</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
			<span class="n">MapSight</span><span class="p">(</span><span class="o">*</span><span class="n">player</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">unit</span><span class="o">-&gt;</span><span class="n">CurrentSightRange</span><span class="p">,</span> <span class="n">MapMarkTileSight</span><span class="p">);</span>
			<span class="c1">// Detectcloak works in container</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">unit</span><span class="o">-&gt;</span><span class="n">Type</span><span class="o">-&gt;</span><span class="n">BoolFlag</span><span class="p">[</span><span class="n">DETECTCLOAK_INDEX</span><span class="p">].</span><span class="n">value</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">MapSight</span><span class="p">(</span><span class="o">*</span><span class="n">player</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">unit</span><span class="o">-&gt;</span><span class="n">CurrentSightRange</span><span class="p">,</span> <span class="n">MapMarkTileDetectCloak</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="c1">// Radar(Jammer) not.</span>
			<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;tile&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="n">CclGetPos</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">unit</span><span class="o">-&gt;</span><span class="n">tilePos</span><span class="p">.</span><span class="n">x</span> <span class="p">,</span> <span class="o">&amp;</span><span class="n">unit</span><span class="o">-&gt;</span><span class="n">tilePos</span><span class="p">.</span><span class="n">y</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
			<span class="n">unit</span><span class="o">-&gt;</span><span class="n">Offset</span> <span class="o">=</span> <span class="n">Map</span><span class="p">.</span><span class="n">getIndex</span><span class="p">(</span><span class="n">unit</span><span class="o">-&gt;</span><span class="n">tilePos</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;seen-tile&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="n">CclGetPos</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">unit</span><span class="o">-&gt;</span><span class="n">Seen</span><span class="p">.</span><span class="n">tilePos</span><span class="p">.</span><span class="n">x</span> <span class="p">,</span> <span class="o">&amp;</span><span class="n">unit</span><span class="o">-&gt;</span><span class="n">Seen</span><span class="p">.</span><span class="n">tilePos</span><span class="p">.</span><span class="n">y</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;stats&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">unit</span><span class="o">-&gt;</span><span class="n">Stats</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">type</span><span class="o">-&gt;</span><span class="n">Stats</span><span class="p">[</span><span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)];</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;pixel&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="n">CclGetPos</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">unit</span><span class="o">-&gt;</span><span class="n">IX</span> <span class="p">,</span> <span class="o">&amp;</span><span class="n">unit</span><span class="o">-&gt;</span><span class="n">IY</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;seen-pixel&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="n">CclGetPos</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">unit</span><span class="o">-&gt;</span><span class="n">Seen</span><span class="p">.</span><span class="n">IX</span> <span class="p">,</span> <span class="o">&amp;</span><span class="n">unit</span><span class="o">-&gt;</span><span class="n">Seen</span><span class="p">.</span><span class="n">IY</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;frame&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">unit</span><span class="o">-&gt;</span><span class="n">Frame</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;seen&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">unit</span><span class="o">-&gt;</span><span class="n">Seen</span><span class="p">.</span><span class="n">Frame</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;not-seen&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">unit</span><span class="o">-&gt;</span><span class="n">Seen</span><span class="p">.</span><span class="n">Frame</span> <span class="o">=</span> <span class="n">UnitNotSeen</span><span class="p">;</span>
			<span class="o">--</span><span class="n">j</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;direction&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">unit</span><span class="o">-&gt;</span><span class="n">Direction</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;damage-type&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">unit</span><span class="o">-&gt;</span><span class="n">DamagedType</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;attacked&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="c1">// FIXME : unsigned long should be better handled</span>
			<span class="n">unit</span><span class="o">-&gt;</span><span class="n">Attacked</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;auto-repair&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">unit</span><span class="o">-&gt;</span><span class="n">AutoRepair</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="o">--</span><span class="n">j</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;burning&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">unit</span><span class="o">-&gt;</span><span class="n">Burning</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="o">--</span><span class="n">j</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;destroyed&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">unit</span><span class="o">-&gt;</span><span class="n">Destroyed</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="o">--</span><span class="n">j</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;removed&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">unit</span><span class="o">-&gt;</span><span class="n">Removed</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="o">--</span><span class="n">j</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;selected&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">unit</span><span class="o">-&gt;</span><span class="n">Selected</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="o">--</span><span class="n">j</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;summoned&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="c1">// FIXME : unsigned long should be better handled</span>
			<span class="n">unit</span><span class="o">-&gt;</span><span class="n">Summoned</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;waiting&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">unit</span><span class="o">-&gt;</span><span class="n">Waiting</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="o">--</span><span class="n">j</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;mine-low&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">unit</span><span class="o">-&gt;</span><span class="n">MineLow</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="o">--</span><span class="n">j</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;rescued-from&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">unit</span><span class="o">-&gt;</span><span class="n">RescuedFrom</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">Players</span><span class="p">[</span><span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)];</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;seen-by-player&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">s</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="n">unit</span><span class="o">-&gt;</span><span class="n">Seen</span><span class="p">.</span><span class="n">ByPlayer</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">PlayerMax</span> <span class="o">&amp;&amp;</span> <span class="o">*</span><span class="n">s</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">,</span> <span class="o">++</span><span class="n">s</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">if</span> <span class="p">(</span><span class="o">*</span><span class="n">s</span> <span class="o">==</span> <span class="sc">&#39;-&#39;</span> <span class="o">||</span> <span class="o">*</span><span class="n">s</span> <span class="o">==</span> <span class="sc">&#39;_&#39;</span> <span class="o">||</span> <span class="o">*</span><span class="n">s</span> <span class="o">==</span> <span class="sc">&#39; &#39;</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">unit</span><span class="o">-&gt;</span><span class="n">Seen</span><span class="p">.</span><span class="n">ByPlayer</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">i</span><span class="p">);</span>
				<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
					<span class="n">unit</span><span class="o">-&gt;</span><span class="n">Seen</span><span class="p">.</span><span class="n">ByPlayer</span> <span class="o">|=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">i</span><span class="p">);</span>
				<span class="p">}</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;seen-destroyed&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">s</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="n">unit</span><span class="o">-&gt;</span><span class="n">Seen</span><span class="p">.</span><span class="n">Destroyed</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">PlayerMax</span> <span class="o">&amp;&amp;</span> <span class="o">*</span><span class="n">s</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">,</span> <span class="o">++</span><span class="n">s</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">if</span> <span class="p">(</span><span class="o">*</span><span class="n">s</span> <span class="o">==</span> <span class="sc">&#39;-&#39;</span> <span class="o">||</span> <span class="o">*</span><span class="n">s</span> <span class="o">==</span> <span class="sc">&#39;_&#39;</span> <span class="o">||</span> <span class="o">*</span><span class="n">s</span> <span class="o">==</span> <span class="sc">&#39; &#39;</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">unit</span><span class="o">-&gt;</span><span class="n">Seen</span><span class="p">.</span><span class="n">Destroyed</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">i</span><span class="p">);</span>
				<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
					<span class="n">unit</span><span class="o">-&gt;</span><span class="n">Seen</span><span class="p">.</span><span class="n">Destroyed</span> <span class="o">|=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">i</span><span class="p">);</span>
				<span class="p">}</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;constructed&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">unit</span><span class="o">-&gt;</span><span class="n">Constructed</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="o">--</span><span class="n">j</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;seen-constructed&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">unit</span><span class="o">-&gt;</span><span class="n">Seen</span><span class="p">.</span><span class="n">Constructed</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="o">--</span><span class="n">j</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;seen-state&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">unit</span><span class="o">-&gt;</span><span class="n">Seen</span><span class="p">.</span><span class="n">State</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;active&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">unit</span><span class="o">-&gt;</span><span class="n">Active</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="o">--</span><span class="n">j</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;ttl&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="c1">// FIXME : unsigned long should be better handled</span>
			<span class="n">unit</span><span class="o">-&gt;</span><span class="n">TTL</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;threshold&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="c1">// FIXME : unsigned long should be better handled</span>
			<span class="n">unit</span><span class="o">-&gt;</span><span class="n">Threshold</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;group-id&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">unit</span><span class="o">-&gt;</span><span class="n">GroupId</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;last-group&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">unit</span><span class="o">-&gt;</span><span class="n">LastGroup</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;resources-held&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">unit</span><span class="o">-&gt;</span><span class="n">ResourcesHeld</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;current-resource&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="n">unit</span><span class="o">-&gt;</span><span class="n">CurrentResource</span> <span class="o">=</span> <span class="n">CclGetResourceByName</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
			<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;pathfinder-input&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="n">unit</span><span class="o">-&gt;</span><span class="n">pathFinderData</span><span class="o">-&gt;</span><span class="n">input</span><span class="p">.</span><span class="n">Load</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
			<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;pathfinder-output&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="n">unit</span><span class="o">-&gt;</span><span class="n">pathFinderData</span><span class="o">-&gt;</span><span class="n">output</span><span class="p">.</span><span class="n">Load</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
			<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;wait&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">unit</span><span class="o">-&gt;</span><span class="n">Wait</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;anim-data&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="n">CAnimations</span><span class="o">::</span><span class="n">LoadUnitAnim</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="o">*</span><span class="n">unit</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;wait-anim-data&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="n">CAnimations</span><span class="o">::</span><span class="n">LoadWaitUnitAnim</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="o">*</span><span class="n">unit</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;blink&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">unit</span><span class="o">-&gt;</span><span class="n">Blink</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;moving&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">unit</span><span class="o">-&gt;</span><span class="n">Moving</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="o">--</span><span class="n">j</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;re-cast&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">unit</span><span class="o">-&gt;</span><span class="n">ReCast</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="o">--</span><span class="n">j</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;boarded&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">unit</span><span class="o">-&gt;</span><span class="n">Boarded</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="o">--</span><span class="n">j</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;next-worker&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="n">unit</span><span class="o">-&gt;</span><span class="n">NextWorker</span> <span class="o">=</span> <span class="n">CclGetUnitFromRef</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
			<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;resource-workers&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="n">unit</span><span class="o">-&gt;</span><span class="n">Resource</span><span class="p">.</span><span class="n">Workers</span> <span class="o">=</span> <span class="n">CclGetUnitFromRef</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
			<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;resource-assigned&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="n">unit</span><span class="o">-&gt;</span><span class="n">Resource</span><span class="p">.</span><span class="n">Assigned</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;resource-active&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="n">unit</span><span class="o">-&gt;</span><span class="n">Resource</span><span class="p">.</span><span class="n">Active</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;units-boarded-count&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">unit</span><span class="o">-&gt;</span><span class="n">BoardCount</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;units-contained&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="kt">int</span> <span class="n">subargs</span><span class="p">;</span>
			<span class="kt">int</span> <span class="n">k</span><span class="p">;</span>
			<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="n">subargs</span> <span class="o">=</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="k">for</span> <span class="p">(</span><span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">subargs</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="n">CUnit</span> <span class="o">*</span><span class="n">u</span> <span class="o">=</span> <span class="n">CclGetUnitFromRef</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
				<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
				<span class="n">u</span><span class="o">-&gt;</span><span class="n">AddInContainer</span><span class="p">(</span><span class="o">*</span><span class="n">unit</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;orders&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="n">CclParseOrders</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="o">*</span><span class="n">unit</span><span class="p">);</span>
			<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
			<span class="c1">// now we know unit&#39;s action so we can assign it to a player</span>
			<span class="n">Assert</span><span class="p">(</span><span class="n">player</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">);</span>
			<span class="n">unit</span><span class="o">-&gt;</span><span class="n">AssignToPlayer</span><span class="p">(</span><span class="o">*</span><span class="n">player</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">unit</span><span class="o">-&gt;</span><span class="n">CurrentAction</span><span class="p">()</span> <span class="o">==</span> <span class="n">UnitActionBuilt</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">DebugPrint</span><span class="p">(</span><span class="s">&quot;HACK: the building is not ready yet</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
				<span class="c1">// HACK: the building is not ready yet</span>
				<span class="n">unit</span><span class="o">-&gt;</span><span class="n">Player</span><span class="o">-&gt;</span><span class="n">UnitTypesCount</span><span class="p">[</span><span class="n">type</span><span class="o">-&gt;</span><span class="n">Slot</span><span class="p">]</span><span class="o">--</span><span class="p">;</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">unit</span><span class="o">-&gt;</span><span class="n">Active</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">unit</span><span class="o">-&gt;</span><span class="n">Player</span><span class="o">-&gt;</span><span class="n">UnitTypesAiActiveCount</span><span class="p">[</span><span class="n">type</span><span class="o">-&gt;</span><span class="n">Slot</span><span class="p">]</span><span class="o">--</span><span class="p">;</span>
				<span class="p">}</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;critical-order&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="n">CclParseOrder</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="o">*</span><span class="n">unit</span> <span class="p">,</span> <span class="o">&amp;</span><span class="n">unit</span><span class="o">-&gt;</span><span class="n">CriticalOrder</span><span class="p">);</span>
			<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;saved-order&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="n">CclParseOrder</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="o">*</span><span class="n">unit</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">unit</span><span class="o">-&gt;</span><span class="n">SavedOrder</span><span class="p">);</span>
			<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;new-order&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
			<span class="n">CclParseOrder</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="o">*</span><span class="n">unit</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">unit</span><span class="o">-&gt;</span><span class="n">NewOrder</span><span class="p">);</span>
			<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;goal&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">unit</span><span class="o">-&gt;</span><span class="n">Goal</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">UnitManager</span><span class="p">.</span><span class="n">GetSlotUnit</span><span class="p">(</span><span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">));</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;auto-cast&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">s</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="n">Assert</span><span class="p">(</span><span class="n">SpellTypeByIdent</span><span class="p">(</span><span class="n">s</span><span class="p">));</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">unit</span><span class="o">-&gt;</span><span class="n">AutoCastSpell</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">unit</span><span class="o">-&gt;</span><span class="n">AutoCastSpell</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">char</span><span class="p">[</span><span class="n">SpellTypeTable</span><span class="p">.</span><span class="n">size</span><span class="p">()];</span>
				<span class="n">memset</span><span class="p">(</span><span class="n">unit</span><span class="o">-&gt;</span><span class="n">AutoCastSpell</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">SpellTypeTable</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>
			<span class="p">}</span>
			<span class="n">unit</span><span class="o">-&gt;</span><span class="n">AutoCastSpell</span><span class="p">[</span><span class="n">SpellTypeByIdent</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">Slot</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;spell-cooldown&quot;</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">)</span> <span class="o">||</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">)</span> <span class="o">!=</span> <span class="n">SpellTypeTable</span><span class="p">.</span><span class="n">size</span><span class="p">())</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">unit</span><span class="o">-&gt;</span><span class="n">SpellCoolDownTimers</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">unit</span><span class="o">-&gt;</span><span class="n">SpellCoolDownTimers</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">int</span><span class="p">[</span><span class="n">SpellTypeTable</span><span class="p">.</span><span class="n">size</span><span class="p">()];</span>
				<span class="n">memset</span><span class="p">(</span><span class="n">unit</span><span class="o">-&gt;</span><span class="n">SpellCoolDownTimers</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">SpellTypeTable</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">*</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">));</span>
			<span class="p">}</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">SpellTypeTable</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">unit</span><span class="o">-&gt;</span><span class="n">SpellCoolDownTimers</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="k">const</span> <span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="n">UnitTypeVar</span><span class="p">.</span><span class="n">VariableNameLookup</span><span class="p">[</span><span class="n">value</span><span class="p">];</span><span class="c1">// User variables</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">index</span> <span class="o">!=</span> <span class="mi">-1</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// Valid index</span>
				<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
				<span class="n">DefineVariableField</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">unit</span><span class="o">-&gt;</span><span class="n">Variable</span> <span class="o">+</span> <span class="n">index</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
				<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
				<span class="k">continue</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Unit: Unsupported tag: %s&quot;</span> <span class="n">_C_</span> <span class="n">value</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="c1">// Unit may not have been assigned to a player before now. If not,</span>
	<span class="c1">// do so now. It is only assigned earlier if we have orders.</span>
	<span class="c1">// for loading of units from a MAP, and not a savegame, we won&#39;t</span>
	<span class="c1">// have orders for those units.  They should appear here as if</span>
	<span class="c1">// they were just created.</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">unit</span><span class="o">-&gt;</span><span class="n">Player</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">Assert</span><span class="p">(</span><span class="n">player</span><span class="p">);</span>
		<span class="n">unit</span><span class="o">-&gt;</span><span class="n">AssignToPlayer</span><span class="p">(</span><span class="o">*</span><span class="n">player</span><span class="p">);</span>
		<span class="n">UpdateForNewUnit</span><span class="p">(</span><span class="o">*</span><span class="n">unit</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="c1">//  Revealers are units that can see while removed</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">unit</span><span class="o">-&gt;</span><span class="n">Removed</span> <span class="o">&amp;&amp;</span> <span class="n">unit</span><span class="o">-&gt;</span><span class="n">Type</span><span class="o">-&gt;</span><span class="n">BoolFlag</span><span class="p">[</span><span class="n">REVEALER_INDEX</span><span class="p">].</span><span class="n">value</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">MapMarkUnitSight</span><span class="p">(</span><span class="o">*</span><span class="n">unit</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="c1">// Fix Colors for rescued units.</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">unit</span><span class="o">-&gt;</span><span class="n">RescuedFrom</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">unit</span><span class="o">-&gt;</span><span class="n">Colors</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">unit</span><span class="o">-&gt;</span><span class="n">RescuedFrom</span><span class="o">-&gt;</span><span class="n">UnitColors</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>MoveUnit</summary>
                        <p><br>  Move a unit on map.<br><br>  @param l  Lua state.<br><br>  @return   Returns the slot number of the made placed.</p>
                          <details>
                          <summary>/unit/script_unit.cpp:634 CclMoveUnit</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclMoveUnit</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>

	<span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">CUnit</span> <span class="o">*</span><span class="n">unit</span> <span class="o">=</span> <span class="n">CclGetUnit</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

	<span class="n">Vec2i</span> <span class="n">ipos</span><span class="p">;</span>
	<span class="n">CclGetPos</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ipos</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ipos</span><span class="p">.</span><span class="n">y</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">UnitCanBeAt</span><span class="p">(</span><span class="o">*</span><span class="n">unit</span><span class="p">,</span> <span class="n">ipos</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">unit</span><span class="o">-&gt;</span><span class="n">Place</span><span class="p">(</span><span class="n">ipos</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="k">const</span> <span class="kt">int</span> <span class="n">heading</span> <span class="o">=</span> <span class="n">SyncRand</span><span class="p">()</span> <span class="o">%</span> <span class="mi">256</span><span class="p">;</span>

		<span class="n">unit</span><span class="o">-&gt;</span><span class="n">tilePos</span> <span class="o">=</span> <span class="n">ipos</span><span class="p">;</span>
		<span class="n">DropOutOnSide</span><span class="p">(</span><span class="o">*</span><span class="n">unit</span><span class="p">,</span> <span class="n">heading</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>RemoveUnit</summary>
                        <p><br>  Remove unit from the map.<br><br>  @param l  Lua state.<br><br>  @return   Returns 1.</p>
                          <details>
                          <summary>/unit/script_unit.cpp:653 CclRemoveUnit</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclRemoveUnit</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">CUnit</span> <span class="o">*</span><span class="n">unit</span> <span class="o">=</span> <span class="n">CclGetUnit</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">unit</span><span class="o">-&gt;</span><span class="n">Remove</span><span class="p">(</span><span class="nb">NULL</span><span class="p">);</span>
	<span class="n">LetUnitDie</span><span class="p">(</span><span class="o">*</span><span class="n">unit</span><span class="p">);</span>
	<span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>CreateUnit</summary>
                        <p><br>  Create a unit and place it on the map<br><br>  @param l  Lua state.<br><br>  @return   Returns the slot number of the made unit.</p>
                          <details>
                          <summary>/unit/script_unit.cpp:707 CclCreateUnit</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclCreateUnit</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>

	<span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">CUnitType</span> <span class="o">*</span><span class="n">unittype</span> <span class="o">=</span> <span class="n">CclGetUnitType</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">unittype</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Bad unittype&quot;</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">Vec2i</span> <span class="n">ipos</span><span class="p">;</span>
	<span class="n">CclGetPos</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ipos</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ipos</span><span class="p">.</span><span class="n">y</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>

	<span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">playerno</span> <span class="o">=</span> <span class="n">TriggerGetPlayer</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">playerno</span> <span class="o">==</span> <span class="mi">-1</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">&quot;CreateUnit: You cannot use </span><span class="se">\&quot;</span><span class="s">any</span><span class="se">\&quot;</span><span class="s"> in create-unit, specify a player</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;bad player&quot;</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">Players</span><span class="p">[</span><span class="n">playerno</span><span class="p">].</span><span class="n">Type</span> <span class="o">==</span> <span class="n">PlayerNobody</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">&quot;CreateUnit: player %d does not exist</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">playerno</span><span class="p">);</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;bad player&quot;</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">CUnit</span> <span class="o">*</span><span class="n">unit</span> <span class="o">=</span> <span class="n">MakeUnit</span><span class="p">(</span><span class="o">*</span><span class="n">unittype</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">Players</span><span class="p">[</span><span class="n">playerno</span><span class="p">]);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">unit</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">DebugPrint</span><span class="p">(</span><span class="s">&quot;Unable to allocate unit&quot;</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">UnitCanBeAt</span><span class="p">(</span><span class="o">*</span><span class="n">unit</span><span class="p">,</span> <span class="n">ipos</span><span class="p">)</span>
			<span class="o">||</span> <span class="p">(</span><span class="n">unit</span><span class="o">-&gt;</span><span class="n">Type</span><span class="o">-&gt;</span><span class="n">Building</span> <span class="o">&amp;&amp;</span> <span class="n">CanBuildUnitType</span><span class="p">(</span><span class="nb">NULL</span><span class="p">,</span> <span class="o">*</span><span class="n">unit</span><span class="o">-&gt;</span><span class="n">Type</span><span class="p">,</span> <span class="n">ipos</span><span class="p">,</span> <span class="mi">0</span><span class="p">)))</span> <span class="p">{</span>
			<span class="n">unit</span><span class="o">-&gt;</span><span class="n">Place</span><span class="p">(</span><span class="n">ipos</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="k">const</span> <span class="kt">int</span> <span class="n">heading</span> <span class="o">=</span> <span class="n">SyncRand</span><span class="p">()</span> <span class="o">%</span> <span class="mi">256</span><span class="p">;</span>

			<span class="n">unit</span><span class="o">-&gt;</span><span class="n">tilePos</span> <span class="o">=</span> <span class="n">ipos</span><span class="p">;</span>
			<span class="n">DropOutOnSide</span><span class="p">(</span><span class="o">*</span><span class="n">unit</span><span class="p">,</span> <span class="n">heading</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="n">UpdateForNewUnit</span><span class="p">(</span><span class="o">*</span><span class="n">unit</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

		<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">UnitNumber</span><span class="p">(</span><span class="o">*</span><span class="n">unit</span><span class="p">));</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>TransformUnit</summary>
                        <p><br>  'Upgrade' a unit in place to a unit of different type.<br><br>  @param l  Lua state.<br><br>  @return   Returns success.</p>
                          <details>
                          <summary>/unit/script_unit.cpp:727 CclTransformUnit</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclTransformUnit</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">CUnit</span> <span class="o">*</span><span class="n">targetUnit</span> <span class="o">=</span> <span class="n">CclGetUnit</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="k">const</span> <span class="n">CUnitType</span> <span class="o">*</span><span class="n">unittype</span> <span class="o">=</span> <span class="n">TriggerGetUnitType</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">CommandUpgradeTo</span><span class="p">(</span><span class="o">*</span><span class="n">targetUnit</span><span class="p">,</span> <span class="o">*</span><span class="p">(</span><span class="n">CUnitType</span><span class="o">*</span><span class="p">)</span><span class="n">unittype</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>DamageUnit</summary>
                        <p><br>  Damages unit, additionally using another unit as first's attacker<br><br>  @param l  Lua state.<br><br>  @return   Returns the slot number of the made unit.</p>
                          <details>
                          <summary>/unit/script_unit.cpp:752 CclDamageUnit</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclDamageUnit</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>

	<span class="k">const</span> <span class="kt">int</span> <span class="n">attacker</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">CUnit</span> <span class="o">*</span><span class="n">attackerUnit</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">attacker</span> <span class="o">!=</span> <span class="mi">-1</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">attackerUnit</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">UnitManager</span><span class="p">.</span><span class="n">GetSlotUnit</span><span class="p">(</span><span class="n">attacker</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="n">CUnit</span> <span class="o">*</span><span class="n">targetUnit</span> <span class="o">=</span> <span class="n">CclGetUnit</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">damage</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
	<span class="n">HitUnit</span><span class="p">(</span><span class="n">attackerUnit</span><span class="p">,</span> <span class="o">*</span><span class="n">targetUnit</span><span class="p">,</span> <span class="n">damage</span><span class="p">);</span>

	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SetResourcesHeld</summary>
                        <p><br>  Set resources held by a unit<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/unit/script_unit.cpp:777 CclSetResourcesHeld</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetResourcesHeld</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">lua_isnil</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">CUnit</span> <span class="o">*</span><span class="n">unit</span> <span class="o">=</span> <span class="n">CclGetUnit</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">value</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="n">unit</span><span class="o">-&gt;</span><span class="n">ResourcesHeld</span> <span class="o">=</span> <span class="n">value</span><span class="p">;</span>
	<span class="n">unit</span><span class="o">-&gt;</span><span class="n">Variable</span><span class="p">[</span><span class="n">GIVERESOURCE_INDEX</span><span class="p">].</span><span class="n">Value</span> <span class="o">=</span> <span class="n">value</span><span class="p">;</span>
	<span class="n">unit</span><span class="o">-&gt;</span><span class="n">Variable</span><span class="p">[</span><span class="n">GIVERESOURCE_INDEX</span><span class="p">].</span><span class="n">Max</span> <span class="o">=</span> <span class="n">value</span><span class="p">;</span>
	<span class="n">unit</span><span class="o">-&gt;</span><span class="n">Variable</span><span class="p">[</span><span class="n">GIVERESOURCE_INDEX</span><span class="p">].</span><span class="n">Enable</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SetTeleportDestination</summary>
                        <p><br>  Set teleport deastination for teleporter unit<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/unit/script_unit.cpp:802 CclSetTeleportDestination</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetTeleportDestination</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>

	<span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">CUnit</span> <span class="o">*</span><span class="n">unit</span> <span class="o">=</span> <span class="n">CclGetUnit</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">unit</span><span class="o">-&gt;</span><span class="n">Type</span><span class="o">-&gt;</span><span class="n">BoolFlag</span><span class="p">[</span><span class="n">TELEPORTER_INDEX</span><span class="p">].</span><span class="n">value</span> <span class="o">==</span> <span class="nb">false</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Unit not a teleporter&quot;</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="n">CUnit</span> <span class="o">*</span><span class="n">dest</span> <span class="o">=</span> <span class="n">CclGetUnit</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">dest</span><span class="o">-&gt;</span><span class="n">IsAliveOnMap</span><span class="p">())</span> <span class="p">{</span>
		<span class="n">unit</span><span class="o">-&gt;</span><span class="n">Goal</span> <span class="o">=</span> <span class="n">dest</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>OrderUnit</summary>
                        <p><br>  Order a unit<br><br>  @param l  Lua state.<br><br>  OrderUnit(player, unit-type, sloc, dloc, order)</p>
                          <details>
                          <summary>/unit/script_unit.cpp:875 CclOrderUnit</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclOrderUnit</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>

	<span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">plynr</span> <span class="o">=</span> <span class="n">TriggerGetPlayer</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="k">const</span> <span class="n">CUnitType</span> <span class="o">*</span><span class="n">unittype</span> <span class="o">=</span> <span class="n">TriggerGetUnitType</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">Vec2i</span> <span class="n">pos1</span><span class="p">;</span>
	<span class="n">pos1</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">pos1</span><span class="p">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>

	<span class="n">Vec2i</span> <span class="n">pos2</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">pos2</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
		<span class="n">pos2</span><span class="p">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">pos2</span> <span class="o">=</span> <span class="n">pos1</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">Vec2i</span> <span class="n">dpos1</span><span class="p">;</span>
	<span class="n">Vec2i</span> <span class="n">dpos2</span><span class="p">;</span>
	<span class="n">dpos1</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">dpos1</span><span class="p">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">dpos2</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
		<span class="n">dpos2</span><span class="p">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">dpos2</span> <span class="o">=</span> <span class="n">dpos1</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">order</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>
	<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">CUnit</span> <span class="o">*&gt;</span> <span class="n">table</span><span class="p">;</span>
	<span class="n">Select</span><span class="p">(</span><span class="n">pos1</span><span class="p">,</span> <span class="n">pos2</span><span class="p">,</span> <span class="n">table</span><span class="p">);</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">table</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">CUnit</span> <span class="o">&amp;</span><span class="n">unit</span> <span class="o">=</span> <span class="o">*</span><span class="n">table</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>

		<span class="k">if</span> <span class="p">(</span><span class="n">unittype</span> <span class="o">==</span> <span class="n">ANY_UNIT</span>
			<span class="o">||</span> <span class="p">(</span><span class="n">unittype</span> <span class="o">==</span> <span class="n">ALL_FOODUNITS</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">unit</span><span class="p">.</span><span class="n">Type</span><span class="o">-&gt;</span><span class="n">Building</span><span class="p">)</span>
			<span class="o">||</span> <span class="p">(</span><span class="n">unittype</span> <span class="o">==</span> <span class="n">ALL_BUILDINGS</span> <span class="o">&amp;&amp;</span> <span class="n">unit</span><span class="p">.</span><span class="n">Type</span><span class="o">-&gt;</span><span class="n">Building</span><span class="p">)</span>
			<span class="o">||</span> <span class="n">unittype</span> <span class="o">==</span> <span class="n">unit</span><span class="p">.</span><span class="n">Type</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">plynr</span> <span class="o">==</span> <span class="mi">-1</span> <span class="o">||</span> <span class="n">plynr</span> <span class="o">==</span> <span class="n">unit</span><span class="p">.</span><span class="n">Player</span><span class="o">-&gt;</span><span class="n">Index</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="s">&quot;move&quot;</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">CommandMove</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="p">(</span><span class="n">dpos1</span> <span class="o">+</span> <span class="n">dpos2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
				<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="s">&quot;attack&quot;</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">CUnit</span> <span class="o">*</span><span class="n">attack</span> <span class="o">=</span> <span class="n">TargetOnMap</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="n">dpos1</span><span class="p">,</span> <span class="n">dpos2</span><span class="p">);</span>
					<span class="n">CommandAttack</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="p">(</span><span class="n">dpos1</span> <span class="o">+</span> <span class="n">dpos2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">attack</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
				<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="s">&quot;explore&quot;</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">CommandExplore</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
				<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="s">&quot;patrol&quot;</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">CommandPatrolUnit</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="p">(</span><span class="n">dpos1</span> <span class="o">+</span> <span class="n">dpos2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
				<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
					<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Unsupported order: %s&quot;</span> <span class="n">_C_</span> <span class="n">order</span><span class="p">);</span>
				<span class="p">}</span>
			<span class="p">}</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>KillUnit</summary>
                        <p><br>  Kill a unit<br><br>  @param l  Lua state.<br><br>  @return   Returns true if a unit was killed.</p>
                          <details>
                          <summary>/unit/script_unit.cpp:927 CclKillUnit</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclKillUnit</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>

	<span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">const</span> <span class="n">CUnitType</span> <span class="o">*</span><span class="n">unittype</span> <span class="o">=</span> <span class="n">TriggerGetUnitType</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">plynr</span> <span class="o">=</span> <span class="n">TriggerGetPlayer</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">plynr</span> <span class="o">==</span> <span class="mi">-1</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">CUnitManager</span><span class="o">::</span><span class="n">Iterator</span> <span class="n">it</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">find_if</span><span class="p">(</span><span class="n">UnitManager</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">UnitManager</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span> <span class="n">HasSameUnitTypeAs</span><span class="p">(</span><span class="n">unittype</span><span class="p">));</span>

		<span class="k">if</span> <span class="p">(</span><span class="n">it</span> <span class="o">!=</span> <span class="n">UnitManager</span><span class="p">.</span><span class="n">end</span><span class="p">())</span> <span class="p">{</span>
			<span class="n">LetUnitDie</span><span class="p">(</span><span class="o">**</span><span class="n">it</span><span class="p">);</span>
			<span class="n">lua_pushboolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
			<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">CPlayer</span> <span class="o">&amp;</span><span class="n">player</span> <span class="o">=</span> <span class="n">Players</span><span class="p">[</span><span class="n">plynr</span><span class="p">];</span>
		<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">CUnit</span> <span class="o">*&gt;::</span><span class="n">iterator</span> <span class="n">it</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">find_if</span><span class="p">(</span><span class="n">player</span><span class="p">.</span><span class="n">UnitBegin</span><span class="p">(),</span> <span class="n">player</span><span class="p">.</span><span class="n">UnitEnd</span><span class="p">(),</span> <span class="n">HasSameUnitTypeAs</span><span class="p">(</span><span class="n">unittype</span><span class="p">));</span>

		<span class="k">if</span> <span class="p">(</span><span class="n">it</span> <span class="o">!=</span> <span class="n">player</span><span class="p">.</span><span class="n">UnitEnd</span><span class="p">())</span> <span class="p">{</span>
			<span class="n">LetUnitDie</span><span class="p">(</span><span class="o">**</span><span class="n">it</span><span class="p">);</span>
			<span class="n">lua_pushboolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
			<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="n">lua_pushboolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>KillUnitAt</summary>
                        <p><br>  Kill a unit at a location<br><br>  @param l  Lua state.<br><br>  @return   Returns the number of units killed.</p>
                          <details>
                          <summary>/unit/script_unit.cpp:976 CclKillUnitAt</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclKillUnitAt</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>

	<span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">const</span> <span class="n">CUnitType</span> <span class="o">*</span><span class="n">unittype</span> <span class="o">=</span> <span class="n">TriggerGetUnitType</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="kt">int</span> <span class="n">plynr</span> <span class="o">=</span> <span class="n">TriggerGetPlayer</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="kt">int</span> <span class="n">q</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">||</span> <span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">Vec2i</span> <span class="n">pos1</span><span class="p">;</span>
	<span class="n">Vec2i</span> <span class="n">pos2</span><span class="p">;</span>
	<span class="n">CclGetPos</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">pos1</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">pos1</span><span class="p">.</span><span class="n">y</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
	<span class="n">CclGetPos</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">pos2</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">pos2</span><span class="p">.</span><span class="n">y</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>

	<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">CUnit</span> <span class="o">*&gt;</span> <span class="n">table</span><span class="p">;</span>

	<span class="n">Select</span><span class="p">(</span><span class="n">pos1</span><span class="p">,</span> <span class="n">pos2</span><span class="p">,</span> <span class="n">table</span><span class="p">);</span>

	<span class="kt">int</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">CUnit</span> <span class="o">*&gt;::</span><span class="n">iterator</span> <span class="n">it</span> <span class="o">=</span> <span class="n">table</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span> <span class="n">it</span> <span class="o">!=</span> <span class="n">table</span><span class="p">.</span><span class="n">end</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="n">s</span> <span class="o">&lt;</span> <span class="n">q</span><span class="p">;</span> <span class="o">++</span><span class="n">it</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">CUnit</span> <span class="o">&amp;</span><span class="n">unit</span> <span class="o">=</span> <span class="o">**</span><span class="n">it</span><span class="p">;</span>

		<span class="k">if</span> <span class="p">(</span><span class="n">unittype</span> <span class="o">==</span> <span class="n">ANY_UNIT</span>
			<span class="o">||</span> <span class="p">(</span><span class="n">unittype</span> <span class="o">==</span> <span class="n">ALL_FOODUNITS</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">unit</span><span class="p">.</span><span class="n">Type</span><span class="o">-&gt;</span><span class="n">Building</span><span class="p">)</span>
			<span class="o">||</span> <span class="p">(</span><span class="n">unittype</span> <span class="o">==</span> <span class="n">ALL_BUILDINGS</span> <span class="o">&amp;&amp;</span> <span class="n">unit</span><span class="p">.</span><span class="n">Type</span><span class="o">-&gt;</span><span class="n">Building</span><span class="p">)</span>
			<span class="o">||</span> <span class="n">unittype</span> <span class="o">==</span> <span class="n">unit</span><span class="p">.</span><span class="n">Type</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">((</span><span class="n">plynr</span> <span class="o">==</span> <span class="mi">-1</span> <span class="o">||</span> <span class="n">plynr</span> <span class="o">==</span> <span class="n">unit</span><span class="p">.</span><span class="n">Player</span><span class="o">-&gt;</span><span class="n">Index</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">unit</span><span class="p">.</span><span class="n">IsAlive</span><span class="p">())</span> <span class="p">{</span>
				<span class="n">LetUnitDie</span><span class="p">(</span><span class="n">unit</span><span class="p">);</span>
				<span class="o">++</span><span class="n">s</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">s</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>GetUnits</summary>
                        <p><br>  Get a player's units<br><br>  @param l  Lua state.<br><br>  @return   Array of units.</p>
                          <details>
                          <summary>/unit/script_unit.cpp:1006 CclGetUnits</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclGetUnits</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

	<span class="k">const</span> <span class="kt">int</span> <span class="n">plynr</span> <span class="o">=</span> <span class="n">TriggerGetPlayer</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>

	<span class="n">lua_newtable</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">plynr</span> <span class="o">==</span> <span class="mi">-1</span><span class="p">)</span> <span class="p">{</span>
		<span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">for</span> <span class="p">(</span><span class="n">CUnitManager</span><span class="o">::</span><span class="n">Iterator</span> <span class="n">it</span> <span class="o">=</span> <span class="n">UnitManager</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span> <span class="n">it</span> <span class="o">!=</span> <span class="n">UnitManager</span><span class="p">.</span><span class="n">end</span><span class="p">();</span> <span class="o">++</span><span class="n">it</span><span class="p">,</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">const</span> <span class="n">CUnit</span> <span class="o">&amp;</span><span class="n">unit</span> <span class="o">=</span> <span class="o">**</span><span class="n">it</span><span class="p">;</span>
			<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">UnitNumber</span><span class="p">(</span><span class="n">unit</span><span class="p">));</span>
			<span class="n">lua_rawseti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-2</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">Players</span><span class="p">[</span><span class="n">plynr</span><span class="p">].</span><span class="n">GetUnitCount</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">UnitNumber</span><span class="p">(</span><span class="n">Players</span><span class="p">[</span><span class="n">plynr</span><span class="p">].</span><span class="n">GetUnit</span><span class="p">(</span><span class="n">i</span><span class="p">)));</span>
			<span class="n">lua_rawseti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-2</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>GetUnitsAroundUnit</summary>
                        <p><br>  Get a player's units in rectangle box specified with 2 coordinates<br><br>  @param l  Lua state.<br><br>  @return   Array of units.</p>
                          <details>
                          <summary>/unit/script_unit.cpp:1044 CclGetUnitsAroundUnit</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclGetUnitsAroundUnit</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">nargs</span> <span class="o">=</span> <span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">nargs</span> <span class="o">!=</span> <span class="mi">2</span> <span class="o">&amp;&amp;</span> <span class="n">nargs</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="k">const</span> <span class="kt">int</span> <span class="n">slot</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">const</span> <span class="n">CUnit</span> <span class="o">&amp;</span><span class="n">unit</span> <span class="o">=</span> <span class="n">UnitManager</span><span class="p">.</span><span class="n">GetSlotUnit</span><span class="p">(</span><span class="n">slot</span><span class="p">);</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">range</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="kt">bool</span> <span class="n">allUnits</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">nargs</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">allUnits</span> <span class="o">=</span> <span class="n">LuaToBoolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">lua_newtable</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">CUnit</span> <span class="o">*&gt;</span> <span class="n">table</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">allUnits</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">SelectAroundUnit</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="n">range</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">HasNotSamePlayerAs</span><span class="p">(</span><span class="n">Players</span><span class="p">[</span><span class="n">PlayerNumNeutral</span><span class="p">]));</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">SelectAroundUnit</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="n">range</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">HasSamePlayerAs</span><span class="p">(</span><span class="o">*</span><span class="n">unit</span><span class="p">.</span><span class="n">Player</span><span class="p">));</span>
	<span class="p">}</span>
	<span class="kt">size_t</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">table</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">IsAliveOnMap</span><span class="p">())</span> <span class="p">{</span>
			<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">UnitNumber</span><span class="p">(</span><span class="o">*</span><span class="n">table</span><span class="p">[</span><span class="n">i</span><span class="p">]));</span>
			<span class="n">lua_rawseti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-2</span><span class="p">,</span> <span class="o">++</span><span class="n">n</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>GetUnitBoolFlag</summary>
                        <p><br><br>  Get the value of the unit bool-flag.<br><br>  @param l  Lua state.<br><br>  @return   The value of the bool-flag of the unit.</p>
                          <details>
                          <summary>/unit/script_unit.cpp:1069 CclGetUnitBoolFlag</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclGetUnitBoolFlag</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>

	<span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">const</span> <span class="n">CUnit</span> <span class="o">*</span><span class="n">unit</span> <span class="o">=</span> <span class="n">CclGetUnit</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

	<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="k">const</span> <span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="n">UnitTypeVar</span><span class="p">.</span><span class="n">BoolFlagNameLookup</span><span class="p">[</span><span class="n">value</span><span class="p">];</span><span class="c1">// User bool flags</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">index</span> <span class="o">==</span> <span class="mi">-1</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Bad bool-flag name &#39;%s&#39;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="n">_C_</span> <span class="n">value</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">lua_pushboolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">unit</span><span class="o">-&gt;</span><span class="n">Type</span><span class="o">-&gt;</span><span class="n">BoolFlag</span><span class="p">[</span><span class="n">index</span><span class="p">].</span><span class="n">value</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>GetUnitVariable</summary>
                        <p><br>  Get the value of the unit variable.<br><br>  @param l  Lua state.<br><br>  @return   The value of the variable of the unit.</p>
                          <details>
                          <summary>/unit/script_unit.cpp:1156 CclGetUnitVariable</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclGetUnitVariable</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">nargs</span> <span class="o">=</span> <span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="n">Assert</span><span class="p">(</span><span class="n">nargs</span> <span class="o">==</span> <span class="mi">2</span> <span class="o">||</span> <span class="n">nargs</span> <span class="o">==</span> <span class="mi">3</span><span class="p">);</span>

	<span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">CUnit</span> <span class="o">*</span><span class="n">unit</span> <span class="o">=</span> <span class="n">CclGetUnit</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">unit</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">UpdateUnitVariables</span><span class="p">(</span><span class="o">*</span><span class="n">unit</span><span class="p">);</span>
	<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

	<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="k">const</span> <span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;RegenerationRate&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">unit</span><span class="o">-&gt;</span><span class="n">Variable</span><span class="p">[</span><span class="n">HP_INDEX</span><span class="p">].</span><span class="n">Increase</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Ident&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">lua_pushstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">unit</span><span class="o">-&gt;</span><span class="n">Type</span><span class="o">-&gt;</span><span class="n">Ident</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;ResourcesHeld&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">unit</span><span class="o">-&gt;</span><span class="n">ResourcesHeld</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;GiveResourceType&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">unit</span><span class="o">-&gt;</span><span class="n">Type</span><span class="o">-&gt;</span><span class="n">GivesResource</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;CurrentResource&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">unit</span><span class="o">-&gt;</span><span class="n">CurrentResource</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Name&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">lua_pushstring</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">unit</span><span class="o">-&gt;</span><span class="n">Type</span><span class="o">-&gt;</span><span class="n">Name</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;PlayerType&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">lua_pushinteger</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">unit</span><span class="o">-&gt;</span><span class="n">Player</span><span class="o">-&gt;</span><span class="n">Type</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;TTLPercent&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">unit</span><span class="o">-&gt;</span><span class="n">Summoned</span> <span class="o">&amp;&amp;</span> <span class="n">unit</span><span class="o">-&gt;</span><span class="n">TTL</span><span class="p">)</span> <span class="p">{</span>
			<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">time_lived</span> <span class="o">=</span> <span class="n">GameCycle</span> <span class="o">-</span> <span class="n">unit</span><span class="o">-&gt;</span><span class="n">Summoned</span><span class="p">;</span>
			<span class="n">Assert</span><span class="p">(</span><span class="n">time_lived</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">);</span>
			<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">time_to_live</span> <span class="o">=</span> <span class="n">unit</span><span class="o">-&gt;</span><span class="n">TTL</span> <span class="o">-</span> <span class="n">unit</span><span class="o">-&gt;</span><span class="n">Summoned</span><span class="p">;</span>
			<span class="n">Assert</span><span class="p">(</span><span class="n">time_to_live</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">);</span>
			<span class="kt">double</span> <span class="n">pcnt</span> <span class="o">=</span> <span class="n">time_lived</span> <span class="o">*</span> <span class="mf">100.0</span> <span class="o">/</span> <span class="n">time_to_live</span><span class="p">;</span>
			<span class="kt">int</span> <span class="n">pcnt_i</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">round</span><span class="p">(</span><span class="n">pcnt</span><span class="p">);</span>
			<span class="n">lua_pushinteger</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">pcnt_i</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">lua_pushinteger</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;IndividualUpgrade&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
		<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">upgrade_ident</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">CUpgrade</span><span class="o">::</span><span class="n">Get</span><span class="p">(</span><span class="n">upgrade_ident</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">lua_pushboolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">unit</span><span class="o">-&gt;</span><span class="n">IndividualUpgrades</span><span class="p">[</span><span class="n">CUpgrade</span><span class="o">::</span><span class="n">Get</span><span class="p">(</span><span class="n">upgrade_ident</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">ID</span><span class="p">]);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Individual upgrade </span><span class="se">\&quot;</span><span class="s">%s</span><span class="se">\&quot;</span><span class="s"> doesn&#39;t exist.&quot;</span> <span class="n">_C_</span> <span class="n">upgrade_ident</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
		<span class="p">}</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Active&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">lua_pushboolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">unit</span><span class="o">-&gt;</span><span class="n">Active</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;Idle&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">lua_pushboolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">unit</span><span class="o">-&gt;</span><span class="n">IsIdle</span><span class="p">());</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="n">UnitTypeVar</span><span class="p">.</span><span class="n">VariableNameLookup</span><span class="p">[</span><span class="n">value</span><span class="p">];</span><span class="c1">// User variables</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">index</span> <span class="o">==</span> <span class="mi">-1</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Bad variable name &#39;%s&#39;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="n">_C_</span> <span class="n">value</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">nargs</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">unit</span><span class="o">-&gt;</span><span class="n">Variable</span><span class="p">[</span><span class="n">index</span><span class="p">].</span><span class="n">Value</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="k">const</span> <span class="n">type</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="s">&quot;Value&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">unit</span><span class="o">-&gt;</span><span class="n">Variable</span><span class="p">[</span><span class="n">index</span><span class="p">].</span><span class="n">Value</span><span class="p">);</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="s">&quot;Max&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">unit</span><span class="o">-&gt;</span><span class="n">Variable</span><span class="p">[</span><span class="n">index</span><span class="p">].</span><span class="n">Max</span><span class="p">);</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="s">&quot;Increase&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">unit</span><span class="o">-&gt;</span><span class="n">Variable</span><span class="p">[</span><span class="n">index</span><span class="p">].</span><span class="n">Increase</span><span class="p">);</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="s">&quot;Enable&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">unit</span><span class="o">-&gt;</span><span class="n">Variable</span><span class="p">[</span><span class="n">index</span><span class="p">].</span><span class="n">Enable</span><span class="p">);</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Bad variable type &#39;%s&#39;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="n">_C_</span> <span class="n">type</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SetUnitVariable</summary>
                        <p><br>  Set the value of the unit variable.<br><br>  @param l  Lua state.<br><br>  @return The new value of the unit.</p>
                          <details>
                          <summary>/unit/script_unit.cpp:1255 CclSetUnitVariable</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSetUnitVariable</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">nargs</span> <span class="o">=</span> <span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="n">Assert</span><span class="p">(</span><span class="n">nargs</span> <span class="o">&gt;=</span> <span class="mi">3</span> <span class="o">&amp;&amp;</span> <span class="n">nargs</span> <span class="o">&lt;=</span> <span class="mi">5</span><span class="p">);</span>

	<span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">CUnit</span> <span class="o">*</span><span class="n">unit</span> <span class="o">=</span> <span class="n">CclGetUnit</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="k">const</span> <span class="n">name</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="kt">int</span> <span class="n">value</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s">&quot;Player&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">value</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
		<span class="n">unit</span><span class="o">-&gt;</span><span class="n">AssignToPlayer</span><span class="p">(</span><span class="n">Players</span><span class="p">[</span><span class="n">value</span><span class="p">]);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s">&quot;TTL&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">value</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
		<span class="n">unit</span><span class="o">-&gt;</span><span class="n">TTL</span> <span class="o">=</span> <span class="n">GameCycle</span> <span class="o">+</span> <span class="n">value</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s">&quot;Summoned&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">value</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
		<span class="n">unit</span><span class="o">-&gt;</span><span class="n">Summoned</span> <span class="o">=</span> <span class="n">value</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s">&quot;RegenerationRate&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">value</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
		<span class="n">unit</span><span class="o">-&gt;</span><span class="n">Variable</span><span class="p">[</span><span class="n">HP_INDEX</span><span class="p">].</span><span class="n">Increase</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">min</span><span class="p">(</span><span class="n">unit</span><span class="o">-&gt;</span><span class="n">Variable</span><span class="p">[</span><span class="n">HP_INDEX</span><span class="p">].</span><span class="n">Max</span><span class="p">,</span> <span class="n">value</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s">&quot;IndividualUpgrade&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
		<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">upgrade_ident</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
		<span class="kt">bool</span> <span class="n">has_upgrade</span> <span class="o">=</span> <span class="n">LuaToBoolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">CUpgrade</span><span class="o">::</span><span class="n">Get</span><span class="p">(</span><span class="n">upgrade_ident</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">has_upgrade</span> <span class="o">&amp;&amp;</span> <span class="n">unit</span><span class="o">-&gt;</span><span class="n">IndividualUpgrades</span><span class="p">[</span><span class="n">CUpgrade</span><span class="o">::</span><span class="n">Get</span><span class="p">(</span><span class="n">upgrade_ident</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">ID</span><span class="p">]</span> <span class="o">==</span> <span class="nb">false</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">IndividualUpgradeAcquire</span><span class="p">(</span><span class="o">*</span><span class="n">unit</span><span class="p">,</span> <span class="n">CUpgrade</span><span class="o">::</span><span class="n">Get</span><span class="p">(</span><span class="n">upgrade_ident</span><span class="p">));</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">has_upgrade</span> <span class="o">&amp;&amp;</span> <span class="n">unit</span><span class="o">-&gt;</span><span class="n">IndividualUpgrades</span><span class="p">[</span><span class="n">CUpgrade</span><span class="o">::</span><span class="n">Get</span><span class="p">(</span><span class="n">upgrade_ident</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">ID</span><span class="p">])</span> <span class="p">{</span>
				<span class="n">IndividualUpgradeLost</span><span class="p">(</span><span class="o">*</span><span class="n">unit</span><span class="p">,</span> <span class="n">CUpgrade</span><span class="o">::</span><span class="n">Get</span><span class="p">(</span><span class="n">upgrade_ident</span><span class="p">));</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Individual upgrade </span><span class="se">\&quot;</span><span class="s">%s</span><span class="se">\&quot;</span><span class="s"> doesn&#39;t exist.&quot;</span> <span class="n">_C_</span> <span class="n">upgrade_ident</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
		<span class="p">}</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s">&quot;Active&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="kt">bool</span> <span class="n">ai_active</span> <span class="o">=</span> <span class="n">LuaToBoolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">ai_active</span> <span class="o">!=</span> <span class="n">unit</span><span class="o">-&gt;</span><span class="n">Active</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">ai_active</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">unit</span><span class="o">-&gt;</span><span class="n">Player</span><span class="o">-&gt;</span><span class="n">UnitTypesAiActiveCount</span><span class="p">[</span><span class="n">unit</span><span class="o">-&gt;</span><span class="n">Type</span><span class="o">-&gt;</span><span class="n">Slot</span><span class="p">]</span><span class="o">++</span><span class="p">;</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="n">unit</span><span class="o">-&gt;</span><span class="n">Player</span><span class="o">-&gt;</span><span class="n">UnitTypesAiActiveCount</span><span class="p">[</span><span class="n">unit</span><span class="o">-&gt;</span><span class="n">Type</span><span class="o">-&gt;</span><span class="n">Slot</span><span class="p">]</span><span class="o">--</span><span class="p">;</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">unit</span><span class="o">-&gt;</span><span class="n">Player</span><span class="o">-&gt;</span><span class="n">UnitTypesAiActiveCount</span><span class="p">[</span><span class="n">unit</span><span class="o">-&gt;</span><span class="n">Type</span><span class="o">-&gt;</span><span class="n">Slot</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// if unit AI active count is negative, something wrong happened</span>
					<span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;Player %d has a negative %s AI active count of %d.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">unit</span><span class="o">-&gt;</span><span class="n">Player</span><span class="o">-&gt;</span><span class="n">Index</span><span class="p">,</span> <span class="n">unit</span><span class="o">-&gt;</span><span class="n">Type</span><span class="o">-&gt;</span><span class="n">Ident</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span> <span class="n">unit</span><span class="o">-&gt;</span><span class="n">Player</span><span class="o">-&gt;</span><span class="n">UnitTypesAiActiveCount</span><span class="p">[</span><span class="n">unit</span><span class="o">-&gt;</span><span class="n">Type</span><span class="o">-&gt;</span><span class="n">Slot</span><span class="p">]);</span>
				<span class="p">}</span>
			<span class="p">}</span>
		<span class="p">}</span>
		<span class="n">unit</span><span class="o">-&gt;</span><span class="n">Active</span> <span class="o">=</span> <span class="n">ai_active</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="k">const</span> <span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="n">UnitTypeVar</span><span class="p">.</span><span class="n">VariableNameLookup</span><span class="p">[</span><span class="n">name</span><span class="p">];</span><span class="c1">// User variables</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">index</span> <span class="o">==</span> <span class="mi">-1</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Bad variable name &#39;%s&#39;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="n">_C_</span> <span class="n">name</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="n">value</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
		<span class="kt">bool</span> <span class="n">stats</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">nargs</span> <span class="o">==</span> <span class="mi">5</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">stats</span> <span class="o">=</span> <span class="n">LuaToBoolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">stats</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// stat variables</span>
			<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="k">const</span> <span class="n">type</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="s">&quot;Value&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">unit</span><span class="o">-&gt;</span><span class="n">Stats</span><span class="o">-&gt;</span><span class="n">Variables</span><span class="p">[</span><span class="n">index</span><span class="p">].</span><span class="n">Value</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">min</span><span class="p">(</span><span class="n">unit</span><span class="o">-&gt;</span><span class="n">Stats</span><span class="o">-&gt;</span><span class="n">Variables</span><span class="p">[</span><span class="n">index</span><span class="p">].</span><span class="n">Max</span><span class="p">,</span> <span class="n">value</span><span class="p">);</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="s">&quot;Max&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">unit</span><span class="o">-&gt;</span><span class="n">Stats</span><span class="o">-&gt;</span><span class="n">Variables</span><span class="p">[</span><span class="n">index</span><span class="p">].</span><span class="n">Max</span> <span class="o">=</span> <span class="n">value</span><span class="p">;</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="s">&quot;Increase&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">unit</span><span class="o">-&gt;</span><span class="n">Stats</span><span class="o">-&gt;</span><span class="n">Variables</span><span class="p">[</span><span class="n">index</span><span class="p">].</span><span class="n">Increase</span> <span class="o">=</span> <span class="n">value</span><span class="p">;</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="s">&quot;Enable&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">unit</span><span class="o">-&gt;</span><span class="n">Stats</span><span class="o">-&gt;</span><span class="n">Variables</span><span class="p">[</span><span class="n">index</span><span class="p">].</span><span class="n">Enable</span> <span class="o">=</span> <span class="n">value</span><span class="p">;</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Bad variable type &#39;%s&#39;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="n">_C_</span> <span class="n">type</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">nargs</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">unit</span><span class="o">-&gt;</span><span class="n">Variable</span><span class="p">[</span><span class="n">index</span><span class="p">].</span><span class="n">Value</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">min</span><span class="p">(</span><span class="n">unit</span><span class="o">-&gt;</span><span class="n">Variable</span><span class="p">[</span><span class="n">index</span><span class="p">].</span><span class="n">Max</span><span class="p">,</span> <span class="n">value</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="k">const</span> <span class="n">type</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="s">&quot;Value&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">unit</span><span class="o">-&gt;</span><span class="n">Variable</span><span class="p">[</span><span class="n">index</span><span class="p">].</span><span class="n">Value</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">min</span><span class="p">(</span><span class="n">unit</span><span class="o">-&gt;</span><span class="n">Variable</span><span class="p">[</span><span class="n">index</span><span class="p">].</span><span class="n">Max</span><span class="p">,</span> <span class="n">value</span><span class="p">);</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="s">&quot;Max&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">unit</span><span class="o">-&gt;</span><span class="n">Variable</span><span class="p">[</span><span class="n">index</span><span class="p">].</span><span class="n">Max</span> <span class="o">=</span> <span class="n">value</span><span class="p">;</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="s">&quot;Increase&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">unit</span><span class="o">-&gt;</span><span class="n">Variable</span><span class="p">[</span><span class="n">index</span><span class="p">].</span><span class="n">Increase</span> <span class="o">=</span> <span class="n">value</span><span class="p">;</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="s">&quot;Enable&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">unit</span><span class="o">-&gt;</span><span class="n">Variable</span><span class="p">[</span><span class="n">index</span><span class="p">].</span><span class="n">Enable</span> <span class="o">=</span> <span class="n">value</span><span class="p">;</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;Bad variable type &#39;%s&#39;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="n">_C_</span> <span class="n">type</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">value</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SlotUsage</summary>
                        <p><br>  Get the usage of unit slots during load to allocate memory<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/unit/script_unit.cpp:1266 CclSlotUsage</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSlotUsage</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">UnitManager</span><span class="p">.</span><span class="n">Load</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>SelectSingleUnit</summary>
                        <p>/unit/script_unit.cpp:1278 CclSelectSingleUnit</p>
                        <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclSelectSingleUnit</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">nargs</span> <span class="o">=</span> <span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="n">Assert</span><span class="p">(</span><span class="n">nargs</span> <span class="o">==</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">CUnit</span> <span class="o">*</span><span class="n">unit</span> <span class="o">=</span> <span class="n">CclGetUnit</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">SelectSingleUnit</span><span class="p">(</span><span class="o">*</span><span class="n">unit</span><span class="p">);</span>
	<span class="n">SelectionChanged</span><span class="p">();</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                        </details>
                        <hr>/unit/depend.cpp<hr>
                        <details>
                        <summary>DefineDependency</summary>
                        <p><br>  Define a new dependency.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/unit/depend.cpp:461 CclDefineDependency</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclDefineDependency</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">args</span> <span class="o">=</span> <span class="n">lua_gettop</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">target</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

	<span class="c1">//  All or rules.</span>
	<span class="kt">int</span> <span class="n">or_flag</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">args</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;incorrect argument&quot;</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="k">const</span> <span class="kt">int</span> <span class="n">subargs</span> <span class="o">=</span> <span class="n">lua_rawlen</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>

		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">subargs</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">required</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">subargs</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">2</span><span class="p">);</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">lua_isnumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">count</span> <span class="o">=</span> <span class="n">LuaToNumber</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">-1</span><span class="p">);</span>
					<span class="o">++</span><span class="n">k</span><span class="p">;</span>
				<span class="p">}</span>
				<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="n">AddDependency</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">required</span><span class="p">,</span> <span class="n">count</span><span class="p">,</span> <span class="n">or_flag</span><span class="p">);</span>
			<span class="n">or_flag</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>
			<span class="o">++</span><span class="n">j</span><span class="p">;</span>
			<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">value</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">strcmp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&quot;or&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;not or symbol: %s&quot;</span> <span class="n">_C_</span> <span class="n">value</span><span class="p">);</span>
				<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="n">or_flag</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>GetDependency</summary>
                        <p><br>  Get the dependency.<br><br>  @todo not written.<br><br>  @param l  Lua state.</p>
                          <details>
                          <summary>/unit/depend.cpp:475 CclGetDependency</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclGetDependency</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">DebugPrint</span><span class="p">(</span><span class="s">&quot;FIXME: write this %p</span><span class="se">\n</span><span class="s">&quot;</span> <span class="n">_C_</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">)</span><span class="n">l</span><span class="p">);</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        
                        <details>
                        <summary>CheckDependency</summary>
                        <p><br>  Checks if dependencies are met.<br><br>  @return true if the dependencies are met.<br><br>  @param l  Lua state.<br>  Argument 1: player<br>  Argument 2: object which we want to check the dependencies of</p>
                          <details>
                          <summary>/unit/depend.cpp:499 CclCheckDependency</summary>
                          <p><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">int</span> <span class="n">CclCheckDependency</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">LuaCheckArgs</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">object</span> <span class="o">=</span> <span class="n">LuaToString</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="n">lua_pop</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">plynr</span> <span class="o">=</span> <span class="n">TriggerGetPlayer</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">plynr</span> <span class="o">==</span> <span class="mi">-1</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">LuaError</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&quot;bad player: %i&quot;</span> <span class="n">_C_</span> <span class="n">plynr</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">CPlayer</span> <span class="o">&amp;</span><span class="n">player</span> <span class="o">=</span> <span class="n">Players</span><span class="p">[</span><span class="n">plynr</span><span class="p">];</span>

	<span class="n">lua_pushboolean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">CheckDependByIdent</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">object</span><span class="p">));</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</p>
                          </details>
                        </details>
                        <hr>/tolua/minimap.pkg<hr>
                    <details>
                    <summary>class CMinimap</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CMinimap</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">X</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">Y</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">W</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">H</span><span class="p">;</span>
	<span class="kt">bool</span> <span class="n">WithTerrain</span><span class="p">;</span>
	<span class="kt">bool</span> <span class="n">ShowSelected</span><span class="p">;</span>
	<span class="kt">bool</span> <span class="n">Transparent</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    <hr>/tolua/game.pkg<hr>
                    <details>
                    <summary>StartMap(const string str, bool clean = true)</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>StartReplay(const string str, bool reveal = false)</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>StartSavedGame(const string str)</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>int SaveReplay(const std::string filename)</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>enum GameResults {</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">enum</span> <span class="nc">GameResults</span> <span class="p">{</span>
    <span class="n">GameNoResult</span><span class="p">,</span>
    <span class="n">GameVictory</span><span class="p">,</span>
    <span class="n">GameDefeat</span><span class="p">,</span>
    <span class="n">GameDraw</span><span class="p">,</span>
    <span class="n">GameQuitToMenu</span><span class="p">,</span>
    <span class="n">GameRestart</span><span class="p">,</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>GameResults GameResult</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>StopGame(GameResults result)</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>bool GameRunning</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>SetGamePaused(bool paused)</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>SetGameSpeed(int speed)</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>bool GameObserve</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>bool GameEstablishing</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>unsigned long GameCycle</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>unsigned long FastForwardCycle</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>class Settings {</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Settings</span> <span class="p">{</span>
	<span class="kt">int</span> <span class="n">NetGameType</span><span class="p">;</span>

	<span class="n">SettingsPresets</span> <span class="n">Presets</span><span class="p">[</span><span class="n">PlayerMax</span><span class="p">];</span>

	<span class="kt">int</span> <span class="n">Resources</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">NumUnits</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">Opponents</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">Difficulty</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">GameType</span><span class="p">;</span>
	<span class="kt">bool</span> <span class="n">NoFogOfWar</span><span class="p">;</span>
	<span class="kt">bool</span> <span class="n">Inside</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">RevealMap</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">MapRichness</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>Settings GameSettings</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>enum GameTypes {</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">enum</span> <span class="nc">GameTypes</span> <span class="p">{</span>
	<span class="n">SettingsGameTypeMapDefault</span> <span class="o">=</span> <span class="n">SettingsPresetMapDefault</span><span class="p">,</span>
	<span class="n">SettingsGameTypeMelee</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">SettingsGameTypeFreeForAll</span><span class="p">,</span>
	<span class="n">SettingsGameTypeTopVsBottom</span><span class="p">,</span>
	<span class="n">SettingsGameTypeLeftVsRight</span><span class="p">,</span>
	<span class="n">SettingsGameTypeManVsMachine</span><span class="p">,</span>
	<span class="n">SettingsGameTypeManTeamVsMachine</span><span class="p">,</span>
	<span class="n">SettingsGameTypeMachineVsMachine</span><span class="p">,</span>
        <span class="n">SettingsGameTypeMachineVsMachineTraining</span><span class="p">,</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    <hr>/tolua/sound.pkg<hr>
                    <details>
                    <summary>int GetEffectsVolume(void)</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>SetEffectsVolume(int volume)</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>int GetMusicVolume(void)</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>SetMusicVolume(int volume)</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>SetEffectsEnabled(bool enabled)</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>bool IsEffectsEnabled(void)</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>SetMusicEnabled(bool enabled)</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>bool IsMusicEnabled(void)</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>int PlayFile(const std::string name, LuaActionListener *listener = NULL)</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>int PlayMusic(const std::string name)</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>StopMusic(void)</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>int SetChannelVolume(int channel, int volume)</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>SetChannelStereo(int channel, int stereo)</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>StopChannel(int channel)</summary>
                    <p></p>
                    </details>
                    <hr>/tolua/video.pkg<hr>
                    <details>
                    <summary>int PlayMovie(const std::string name)</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>ShowFullImage(const std::string name, unsigned int timeOutInSecond)</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>SaveMapPNG(const char *name)</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>class CVideo</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CVideo</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
	<span class="kt">int</span> <span class="n">Width</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">Height</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">Depth</span><span class="p">;</span>
	<span class="kt">bool</span> <span class="n">FullScreen</span><span class="p">;</span>
	<span class="kt">bool</span> <span class="nf">ResizeScreen</span><span class="p">(</span><span class="kt">int</span> <span class="n">width</span><span class="p">,</span> <span class="kt">int</span> <span class="n">height</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>CVideo Video</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>ToggleFullScreen(void)</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>class CGraphic</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CGraphic</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
	<span class="k">static</span> <span class="n">CGraphic</span> <span class="o">*</span><span class="n">New</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">file</span><span class="p">,</span> <span class="kt">int</span> <span class="n">w</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="kt">int</span> <span class="n">h</span> <span class="o">=</span> <span class="mi">0</span><span class="p">);</span>
	<span class="k">static</span> <span class="n">CGraphic</span> <span class="o">*</span><span class="n">Get</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">file</span><span class="p">);</span>
	<span class="k">static</span> <span class="kt">void</span> <span class="n">Free</span><span class="p">(</span><span class="n">CGraphic</span> <span class="o">*</span><span class="p">);</span>
	<span class="kt">void</span> <span class="nf">Load</span><span class="p">();</span>
	<span class="kt">void</span> <span class="nf">Resize</span><span class="p">(</span><span class="kt">int</span> <span class="n">w</span><span class="p">,</span> <span class="kt">int</span> <span class="n">h</span><span class="p">);</span>
        <span class="kt">void</span> <span class="nf">SetPaletteColor</span><span class="p">(</span><span class="kt">int</span> <span class="n">idx</span><span class="p">,</span> <span class="kt">int</span> <span class="n">r</span><span class="p">,</span> <span class="kt">int</span> <span class="n">g</span><span class="p">,</span> <span class="kt">int</span> <span class="n">b</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>class CPlayerColorGraphic : public CGraphic</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CPlayerColorGraphic</span> <span class="o">:</span> <span class="k">public</span> <span class="n">CGraphic</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
	<span class="k">static</span> <span class="n">CPlayerColorGraphic</span> <span class="o">*</span><span class="n">New</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">file</span><span class="p">,</span> <span class="kt">int</span> <span class="n">w</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="kt">int</span> <span class="n">h</span> <span class="o">=</span> <span class="mi">0</span><span class="p">);</span>
	<span class="k">static</span> <span class="n">CPlayerColorGraphic</span> <span class="o">*</span><span class="n">Get</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">file</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>class CColor {</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CColor</span> <span class="p">{</span>
	<span class="n">CColor</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">r</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">g</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
		<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">0</span><span class="p">);</span>

	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">R</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">G</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">B</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">A</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>SetColorCycleAll(bool value)</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>AddColorCyclingRange(unsigned int startColorIndex, unsigned int endColorIndex)</summary>
                    <p></p>
                    </details>
                    <hr>/tolua/ai.pkg<hr>
                    <details>
                    <summary>AiAttackWithForceAt(unsigned int force, unsigned int x, unsigned int y)</summary>
                    <p>/// Attack with force at position<br></p>
                    </details>
                    
                    <details>
                    <summary>AiAttackWithForce(unsigned int force)</summary>
                    <p>/// Attack with force<br></p>
                    </details>
                    <hr>/tolua/network.pkg<hr>
                    <details>
                    <summary>InitNetwork1(void)</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>ExitNetwork1(void)</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>int NetworkSetupServerAddress(const std::string serveraddr, int port = 0)</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>NetworkInitClientConnect(void)</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>NetworkInitServerConnect(int openslots)</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>NetworkServerStartGame(void)</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>NetworkProcessClientRequest(void)</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>NetworkServerResyncClients(void)</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>NetworkDetachFromServer(void)</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>class CServerSetup {</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CServerSetup</span> <span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">ResourcesOption</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">UnitsOption</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">FogOfWar</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">Inside</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">RevealMap</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">GameTypeOption</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">Difficulty</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">MapRichness</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">Opponents</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">CompOpt</span><span class="p">[</span><span class="n">PlayerMax</span><span class="p">];</span> <span class="c1">// cannot use char since tolua interpret variable as string else.</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">Ready</span><span class="p">[</span><span class="n">PlayerMax</span><span class="p">];</span>   <span class="c1">// cannot use char since tolua interpret variable as string else.</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">Race</span><span class="p">[</span><span class="n">PlayerMax</span><span class="p">];</span>    <span class="c1">// cannot use char since tolua interpret variable as string else.</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>CServerSetup LocalSetupState</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>CServerSetup ServerSetupState</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>int NetLocalHostsSlot</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>CNetworkHost Hosts[PlayerMax]</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>string NetworkMapName</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>NetworkGamePrepareGameSettings(void)</summary>
                    <p></p>
                    </details>
                    <hr>/tolua/trigger.pkg<hr>
                    <details>
                    <summary>int GetNumOpponents(int player)</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>ActionSetTimer(int cycles, bool increasing)</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>SetTrigger(int trigger)</summary>
                    <p></p>
                    </details>
                    <hr>/tolua/translate.pkg<hr>
                    <details>
                    <summary>AddTranslation(const char *str1, const char *str2)</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>LoadPO(const char *file)</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>SetTranslationsFiles(const char *stratagusfile, const char *gamefile)</summary>
                    <p></p>
                    </details>
                    <hr>/tolua/pathfinder.pkg<hr>
                    <details>
                    <summary>bool AStarKnowUnseenTerrain</summary>
                    <p></p>
                    </details>
                    <hr>/tolua/editor.pkg<hr>
                    <details>
                    <summary>enum EditorRunningType {</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">enum</span> <span class="nc">EditorRunningType</span> <span class="p">{</span>
	<span class="n">EditorNotRunning</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>    <span class="c1">/// Not Running</span>
	<span class="n">EditorStarted</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>       <span class="c1">/// Editor Enabled at all</span>
	<span class="n">EditorCommandLine</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>   <span class="c1">/// Called from Command Line</span>
	<span class="n">EditorEditing</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>       <span class="c1">/// Editor is fully running</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>class CEditor</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CEditor</span>
<span class="p">{</span>
	<span class="n">vector</span><span class="o">&lt;</span><span class="n">string</span><span class="o">&gt;</span> <span class="n">UnitTypes</span><span class="p">;</span>
	<span class="kt">bool</span> <span class="n">TerrainEditable</span><span class="p">;</span>
	<span class="k">const</span> <span class="n">CUnitType</span> <span class="o">*</span><span class="n">StartUnit</span><span class="p">;</span>
	<span class="kt">bool</span> <span class="n">WriteCompressedMaps</span><span class="p">;</span>
	<span class="n">EditorRunningType</span> <span class="n">Running</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>CEditor Editor</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>StartEditor(const char *filename)</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>int EditorSaveMap(const std::string &file)</summary>
                    <p></p>
                    </details>
                    <hr>/tolua/stratagus.pkg<hr>
                    <details>
                    <summary>int SaveGame(const std::string filename)</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>DeleteSaveGame(const std::string filename)</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>int SyncRand(void)</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>int SyncRand(int max)</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>bool CanAccessFile(const char *filename)</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>Exit(int err)</summary>
                    <p></p>
                    </details>
                    <hr>/tolua/unittype.pkg<hr>
                    <details>
                    <summary>class CUnitType</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CUnitType</span>
<span class="p">{</span>
	<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">Ident</span><span class="p">;</span>
	<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">Name</span><span class="p">;</span>
	<span class="n">tolua_readonly</span> <span class="kt">int</span> <span class="n">Slot</span><span class="p">;</span>

	<span class="kt">int</span> <span class="n">MinAttackRange</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">ClicksToExplode</span><span class="p">;</span>

	<span class="kt">int</span> <span class="n">GivesResource</span><span class="p">;</span>

	<span class="kt">int</span> <span class="n">TileWidth</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">TileHeight</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>CUnitType *UnitTypeByIdent(const std::string ident)</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>CUnitType *UnitTypeHumanWall</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>CUnitType *UnitTypeOrcWall</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>SetMapStat(std::string ident, std::string variable_key, int value, std::string variable_type)</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>SetMapSound(std::string ident, std::string sound, std::string sound_type, std::string sound_subtype = "")</summary>
                    <p></p>
                    </details>
                    <hr>/tolua/upgrade.pkg<hr>
                    <details>
                    <summary>class CUpgrade</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CUpgrade</span>
<span class="p">{</span>
  <span class="k">static</span> <span class="n">CUpgrade</span> <span class="o">*</span><span class="n">New</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">ident</span><span class="p">);</span>
  <span class="k">static</span> <span class="n">CUpgrade</span> <span class="o">*</span><span class="n">Get</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">ident</span><span class="p">);</span>

  <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">Name</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">Costs</span><span class="p">[</span><span class="n">MaxCosts</span><span class="p">];</span>
  <span class="n">CIcon</span> <span class="o">*</span><span class="n">Icon</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    <hr>/tolua/particle.pkg<hr>
                    <details>
                    <summary>class GraphicAnimation</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">GraphicAnimation</span>
<span class="p">{</span>
	<span class="n">GraphicAnimation</span><span class="p">(</span><span class="n">CGraphic</span> <span class="o">*</span><span class="n">g</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ticksPerFrame</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="n">GraphicAnimation</span> <span class="o">*</span> <span class="n">clone</span><span class="p">();</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>class CParticle</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CParticle</span>
<span class="p">{</span>
	<span class="k">virtual</span> <span class="n">CParticle</span><span class="o">*</span> <span class="n">clone</span><span class="p">();</span>
	<span class="kt">void</span> <span class="nf">setDrawLevel</span><span class="p">(</span><span class="kt">int</span> <span class="n">value</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>class StaticParticle : public CParticle</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">StaticParticle</span> <span class="o">:</span> <span class="k">public</span> <span class="n">CParticle</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
	<span class="n">StaticParticle</span><span class="p">(</span><span class="n">CPosition</span> <span class="n">position</span><span class="p">,</span> <span class="n">GraphicAnimation</span> <span class="o">*</span><span class="n">animation</span><span class="p">,</span> <span class="kt">int</span> <span class="n">drawlevel</span> <span class="o">=</span> <span class="mi">0</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>class CChunkParticle : public CParticle</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CChunkParticle</span> <span class="o">:</span> <span class="k">public</span> <span class="n">CParticle</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
	<span class="n">CChunkParticle</span><span class="p">(</span><span class="n">CPosition</span> <span class="n">position</span><span class="p">,</span> <span class="n">GraphicAnimation</span> <span class="o">*</span><span class="n">smokeAnimation</span><span class="p">,</span> <span class="n">GraphicAnimation</span> <span class="o">*</span><span class="n">debrisAnimation</span><span class="p">,</span> <span class="n">GraphicAnimation</span> <span class="o">*</span><span class="n">destroyAnimation</span><span class="p">,</span> <span class="kt">int</span> <span class="n">minVelocity</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="kt">int</span> <span class="n">maxVelocity</span> <span class="o">=</span> <span class="mi">400</span><span class="p">,</span> <span class="kt">int</span> <span class="n">minTrajectoryAngle</span> <span class="o">=</span> <span class="mi">77</span><span class="p">,</span> <span class="kt">int</span> <span class="n">maxTTL</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="kt">int</span> <span class="n">drawlevel</span> <span class="o">=</span> <span class="mi">0</span><span class="p">);</span>
	<span class="kt">int</span> <span class="nf">getSmokeDrawLevel</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>
	<span class="kt">int</span> <span class="nf">getDestroyDrawLevel</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>
	<span class="kt">void</span> <span class="nf">setSmokeDrawLevel</span><span class="p">(</span><span class="kt">int</span> <span class="n">value</span><span class="p">);</span>
	<span class="kt">void</span> <span class="nf">setDestroyDrawLevel</span><span class="p">(</span><span class="kt">int</span> <span class="n">value</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>class CSmokeParticle : public CParticle</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CSmokeParticle</span> <span class="o">:</span> <span class="k">public</span> <span class="n">CParticle</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
	<span class="n">CSmokeParticle</span><span class="p">(</span><span class="n">CPosition</span> <span class="n">position</span><span class="p">,</span> <span class="n">GraphicAnimation</span> <span class="o">*</span><span class="n">animation</span><span class="p">,</span> <span class="kt">float</span> <span class="n">speedx</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="kt">float</span> <span class="n">speedy</span> <span class="o">=</span> <span class="mf">-22.0</span><span class="p">,</span> <span class="kt">int</span> <span class="n">drawlevel</span> <span class="o">=</span> <span class="mi">0</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>class CRadialParticle : public CParticle</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CRadialParticle</span> <span class="o">:</span> <span class="k">public</span> <span class="n">CParticle</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
	<span class="n">CRadialParticle</span><span class="p">(</span><span class="n">CPosition</span> <span class="n">position</span><span class="p">,</span> <span class="n">GraphicAnimation</span> <span class="o">*</span><span class="n">smokeAnimation</span><span class="p">,</span> <span class="kt">int</span> <span class="n">maxSpeed</span><span class="p">,</span> <span class="kt">int</span> <span class="n">drawlevel</span> <span class="o">=</span> <span class="mi">0</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>class CParticleManager</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CParticleManager</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
	<span class="n">CParticleManager</span><span class="p">();</span>
	<span class="o">~</span><span class="n">CParticleManager</span><span class="p">();</span>

	<span class="kt">void</span> <span class="nf">add</span><span class="p">(</span><span class="n">CParticle</span> <span class="o">*</span><span class="n">particle</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>CParticleManager ParticleManager</summary>
                    <p></p>
                    </details>
                    <hr>/tolua/ui.pkg<hr>
                    <details>
                    <summary>enum ViewportModeType {</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">enum</span> <span class="nc">ViewportModeType</span> <span class="p">{</span>
	<span class="n">VIEWPORT_SINGLE</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">VIEWPORT_SPLIT_HORIZ</span><span class="p">,</span>
	<span class="n">VIEWPORT_SPLIT_HORIZ3</span><span class="p">,</span>
	<span class="n">VIEWPORT_SPLIT_VERT</span><span class="p">,</span>
	<span class="n">VIEWPORT_QUAD</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>class LuaActionListener</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">LuaActionListener</span>
<span class="p">{</span>
	<span class="n">LuaActionListener</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">lua</span><span class="p">,</span> <span class="n">lua_Object</span> <span class="n">luaref</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>class CUIButton</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CUIButton</span>
<span class="p">{</span>
	<span class="n">CUIButton</span><span class="p">();</span>

	<span class="kt">int</span> <span class="n">X</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">Y</span><span class="p">;</span>
	<span class="n">string</span> <span class="n">Text</span><span class="p">;</span>
	<span class="n">ButtonStyle</span> <span class="o">*</span><span class="n">Style</span><span class="p">;</span>
	<span class="n">LuaActionListener</span> <span class="o">*</span><span class="n">Callback</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>class CMapArea</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CMapArea</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">X</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">Y</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">EndX</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">EndY</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">ScrollPaddingLeft</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">ScrollPaddingRight</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">ScrollPaddingTop</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">ScrollPaddingBottom</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>class CViewport</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CViewport</span>
<span class="p">{</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>class CFiller</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CFiller</span>
<span class="p">{</span>
	<span class="n">CFiller</span><span class="p">();</span>

	<span class="n">CGraphic</span> <span class="o">*</span><span class="n">G</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">X</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">Y</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>class vector</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">vector</span>
<span class="p">{</span>
	<span class="n">TOLUA_TEMPLATE_BIND</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">CFiller</span><span class="p">,</span> <span class="n">CUIButton</span><span class="p">,</span> <span class="n">CUIUserButton</span><span class="p">,</span> <span class="n">string</span><span class="p">)</span>

	<span class="n">vector</span><span class="p">();</span>
	<span class="o">~</span><span class="n">vector</span><span class="p">();</span>

	<span class="k">const</span> <span class="n">T</span><span class="o">&amp;</span> <span class="k">operator</span><span class="p">[](</span><span class="kt">int</span> <span class="n">index</span><span class="p">)</span> <span class="k">const</span><span class="p">;</span>
	<span class="n">T</span><span class="o">&amp;</span> <span class="k">operator</span><span class="p">[](</span><span class="kt">int</span> <span class="n">index</span><span class="p">);</span>
	<span class="k">const</span> <span class="n">T</span><span class="o">&amp;</span> <span class="n">at</span><span class="p">(</span><span class="kt">int</span> <span class="n">index</span><span class="p">)</span> <span class="k">const</span><span class="p">;</span>
	<span class="n">T</span><span class="o">&amp;</span> <span class="nf">at</span><span class="p">(</span><span class="kt">int</span> <span class="n">index</span><span class="p">);</span>

	<span class="k">const</span> <span class="n">T</span><span class="o">&amp;</span> <span class="n">front</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>
	<span class="n">T</span><span class="o">&amp;</span> <span class="nf">front</span><span class="p">();</span>
	<span class="k">const</span> <span class="n">T</span><span class="o">&amp;</span> <span class="n">back</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>
	<span class="n">T</span><span class="o">&amp;</span> <span class="nf">back</span><span class="p">();</span>

	<span class="kt">void</span> <span class="nf">push_back</span><span class="p">(</span><span class="n">T</span> <span class="n">val</span><span class="p">);</span>
	<span class="kt">void</span> <span class="nf">pop_back</span><span class="p">();</span>

	<span class="kt">void</span> <span class="nf">assign</span><span class="p">(</span><span class="kt">int</span> <span class="n">num</span><span class="p">,</span> <span class="k">const</span> <span class="n">T</span><span class="o">&amp;</span> <span class="n">val</span><span class="p">);</span>
	<span class="kt">void</span> <span class="nf">clear</span><span class="p">();</span>
	<span class="kt">bool</span> <span class="nf">empty</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>
	<span class="kt">int</span> <span class="nf">size</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>class CButtonPanel</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CButtonPanel</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">X</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">Y</span><span class="p">;</span>
	<span class="n">vector</span><span class="o">&lt;</span><span class="n">CUIButton</span><span class="o">&gt;</span> <span class="n">Buttons</span><span class="p">;</span>
	<span class="n">CColor</span> <span class="n">AutoCastBorderColorRGB</span><span class="p">;</span>
	<span class="kt">bool</span> <span class="n">ShowCommandKey</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>class CPieMenu</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CPieMenu</span>
<span class="p">{</span>
	<span class="n">CGraphic</span> <span class="o">*</span><span class="n">G</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">MouseButton</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">X</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>
	<span class="kt">int</span> <span class="n">Y</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>

	<span class="kt">void</span> <span class="nf">SetRadius</span><span class="p">(</span><span class="kt">int</span> <span class="n">radius</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>class CResourceInfo</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CResourceInfo</span>
<span class="p">{</span>
	<span class="n">CGraphic</span> <span class="o">*</span><span class="n">G</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">IconFrame</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">IconX</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">IconY</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">IconWidth</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">TextX</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">TextY</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>class CInfoPanel</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CInfoPanel</span>
<span class="p">{</span>
	<span class="n">CGraphic</span> <span class="o">*</span><span class="n">G</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">X</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">Y</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>class CUIUserButton</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CUIUserButton</span>
<span class="p">{</span>
	<span class="n">CUIUserButton</span><span class="p">();</span> 

	<span class="kt">bool</span> <span class="n">Clicked</span><span class="p">;</span>
	<span class="n">CUIButton</span> <span class="n">Button</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>class CStatusLine</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CStatusLine</span>
<span class="p">{</span>
	<span class="kt">void</span> <span class="nf">Set</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">status</span><span class="p">);</span>
	<span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">Get</span><span class="p">();</span>
	<span class="kt">void</span> <span class="nf">Clear</span><span class="p">();</span>

	<span class="kt">int</span> <span class="n">Width</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">TextX</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">TextY</span><span class="p">;</span>
	<span class="n">CFont</span> <span class="o">*</span><span class="n">Font</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>class CUITimer</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CUITimer</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">X</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">Y</span><span class="p">;</span>
	<span class="n">CFont</span> <span class="o">*</span><span class="n">Font</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>class CUserInterface</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CUserInterface</span>
<span class="p">{</span>
	<span class="n">string</span> <span class="n">NormalFontColor</span><span class="p">;</span>
	<span class="n">string</span> <span class="n">ReverseFontColor</span><span class="p">;</span>

	<span class="n">vector</span><span class="o">&lt;</span><span class="n">CFiller</span><span class="o">&gt;</span> <span class="n">Fillers</span><span class="p">;</span>

	<span class="n">CResourceInfo</span> <span class="n">Resources</span><span class="p">[</span><span class="n">MaxResourceInfo</span><span class="p">];</span>
	<span class="n">CInfoPanel</span> <span class="n">InfoPanel</span><span class="p">;</span>
	<span class="n">CUIButton</span> <span class="o">*</span><span class="n">SingleSelectedButton</span><span class="p">;</span>

	<span class="n">vector</span><span class="o">&lt;</span><span class="n">CUIButton</span><span class="o">&gt;</span> <span class="n">SelectedButtons</span><span class="p">;</span>
	<span class="n">CFont</span> <span class="o">*</span><span class="n">MaxSelectedFont</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">MaxSelectedTextX</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">MaxSelectedTextY</span><span class="p">;</span>

	<span class="n">CUIButton</span> <span class="o">*</span><span class="n">SingleTrainingButton</span><span class="p">;</span>
	<span class="n">vector</span><span class="o">&lt;</span><span class="n">CUIButton</span><span class="o">&gt;</span> <span class="n">TrainingButtons</span><span class="p">;</span>
	<span class="n">CUIButton</span> <span class="o">*</span><span class="n">UpgradingButton</span><span class="p">;</span>
	<span class="n">CUIButton</span> <span class="o">*</span><span class="n">ResearchingButton</span><span class="p">;</span>
	<span class="n">vector</span><span class="o">&lt;</span><span class="n">CUIButton</span><span class="o">&gt;</span> <span class="n">TransportingButtons</span><span class="p">;</span>

        <span class="n">vector</span><span class="o">&lt;</span><span class="n">string</span><span class="o">&gt;</span> <span class="n">LifeBarColorNames</span><span class="p">;</span>
        <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">LifeBarPercents</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">LifeBarYOffset</span><span class="p">;</span>
		<span class="kt">int</span> <span class="n">LifeBarPadding</span><span class="p">;</span>
        <span class="kt">bool</span> <span class="n">LifeBarBorder</span><span class="p">;</span>

	<span class="n">CColor</span> <span class="n">CompletedBarColorRGB</span><span class="p">;</span>
	<span class="kt">bool</span> <span class="n">CompletedBarShadow</span><span class="p">;</span>

	<span class="n">CButtonPanel</span> <span class="n">ButtonPanel</span><span class="p">;</span>

	<span class="n">CPieMenu</span> <span class="n">PieMenu</span><span class="p">;</span>

	<span class="n">CViewport</span> <span class="o">*</span><span class="n">MouseViewport</span><span class="p">;</span>
	<span class="n">CMapArea</span> <span class="n">MapArea</span><span class="p">;</span>

	<span class="n">CFont</span> <span class="o">*</span><span class="n">MessageFont</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">MessageScrollSpeed</span><span class="p">;</span>

	<span class="n">CUIButton</span> <span class="n">MenuButton</span><span class="p">;</span>
	<span class="n">CUIButton</span> <span class="n">NetworkMenuButton</span><span class="p">;</span>
	<span class="n">CUIButton</span> <span class="n">NetworkDiplomacyButton</span><span class="p">;</span>

	<span class="n">vector</span><span class="o">&lt;</span><span class="n">CUIUserButton</span><span class="o">&gt;</span> <span class="n">UserButtons</span><span class="p">;</span>

	<span class="n">CMinimap</span> <span class="n">Minimap</span><span class="p">;</span>
	<span class="n">CStatusLine</span> <span class="n">StatusLine</span><span class="p">;</span>
	<span class="n">CUITimer</span> <span class="n">Timer</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>CUserInterface UI</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>class CIcon</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CIcon</span>
<span class="p">{</span>
	<span class="k">static</span> <span class="n">CIcon</span> <span class="o">*</span><span class="n">New</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">ident</span><span class="p">);</span>
	<span class="k">static</span> <span class="n">CIcon</span> <span class="o">*</span><span class="n">Get</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">ident</span><span class="p">);</span>

	<span class="n">tolua_readonly</span> <span class="n">tolua_property__s</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">Ident</span><span class="p">;</span>
	<span class="n">CPlayerColorGraphic</span> <span class="o">*</span><span class="n">G</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">Frame</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>ButtonStyle *FindButtonStyle(const std::string style)</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>bool GetMouseScroll(void)</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>SetMouseScroll(bool enabled)</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>bool GetKeyScroll(void)</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>SetKeyScroll(bool enabled)</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>bool GetGrabMouse(void)</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>SetGrabMouse(bool enabled)</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>bool GetLeaveStops(void)</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>SetLeaveStops(bool enabled)</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>int GetDoubleClickDelay(void)</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>SetDoubleClickDelay(int delay)</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>int GetHoldClickDelay(void)</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>SetHoldClickDelay(int delay)</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>PixelPos CursorScreenPos</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>class Color</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Color</span>
<span class="p">{</span>
	<span class="n">Color</span><span class="p">(</span><span class="kt">int</span> <span class="n">r</span><span class="p">,</span> <span class="kt">int</span> <span class="n">g</span><span class="p">,</span> <span class="kt">int</span> <span class="n">b</span><span class="p">,</span> <span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">255</span><span class="p">);</span>
	<span class="kt">int</span> <span class="n">r</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">g</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">b</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">a</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>class Graphics</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Graphics</span>
<span class="p">{</span>
	<span class="k">enum</span> <span class="p">{</span>
		<span class="n">LEFT</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
		<span class="n">CENTER</span><span class="p">,</span>
		<span class="n">RIGHT</span>
	<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>class Widget</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Widget</span>
<span class="p">{</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">setWidth</span><span class="p">(</span><span class="kt">int</span> <span class="n">width</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="kt">int</span> <span class="n">getWidth</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">setHeight</span><span class="p">(</span><span class="kt">int</span> <span class="n">height</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="kt">int</span> <span class="n">getHeight</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">setSize</span><span class="p">(</span><span class="kt">int</span> <span class="n">width</span><span class="p">,</span> <span class="kt">int</span> <span class="n">height</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">setX</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="kt">int</span> <span class="n">getX</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">setY</span><span class="p">(</span><span class="kt">int</span> <span class="n">y</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="kt">int</span> <span class="n">getY</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">setPosition</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">setBorderSize</span><span class="p">(</span><span class="kt">int</span> <span class="n">width</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">getBorderSize</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">setEnabled</span><span class="p">(</span><span class="kt">bool</span> <span class="n">enabled</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="kt">bool</span> <span class="n">isEnabled</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">setVisible</span><span class="p">(</span><span class="kt">bool</span> <span class="n">visible</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="kt">bool</span> <span class="n">isVisible</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>

	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">setBaseColor</span><span class="p">(</span><span class="k">const</span> <span class="n">Color</span> <span class="n">color</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="k">const</span> <span class="n">Color</span> <span class="o">&amp;</span><span class="n">getBaseColor</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">setForegroundColor</span><span class="p">(</span><span class="k">const</span> <span class="n">Color</span> <span class="n">color</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="k">const</span> <span class="n">Color</span> <span class="o">&amp;</span><span class="n">getForegroundColor</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">setBackgroundColor</span><span class="p">(</span><span class="k">const</span> <span class="n">Color</span> <span class="n">color</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="k">const</span> <span class="n">Color</span> <span class="o">&amp;</span><span class="n">getBackgroundColor</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">setDisabledColor</span><span class="p">(</span><span class="k">const</span> <span class="n">Color</span> <span class="n">color</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="k">const</span> <span class="n">Color</span> <span class="o">&amp;</span><span class="n">getDisabledColor</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>

	<span class="k">static</span> <span class="kt">void</span> <span class="n">setGlobalFont</span><span class="p">(</span><span class="n">CFont</span> <span class="o">*</span><span class="n">font</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">setForegroundColor</span><span class="p">(</span><span class="k">const</span> <span class="n">Color</span> <span class="n">color</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">setBackgroundColor</span><span class="p">(</span><span class="k">const</span> <span class="n">Color</span> <span class="n">color</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">setBaseColor</span><span class="p">(</span><span class="k">const</span> <span class="n">Color</span> <span class="n">color</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">setSize</span><span class="p">(</span><span class="kt">int</span> <span class="n">width</span><span class="p">,</span> <span class="kt">int</span> <span class="n">height</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">setBorderSize</span><span class="p">(</span><span class="kt">int</span> <span class="n">width</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">setFont</span><span class="p">(</span><span class="n">CFont</span> <span class="o">*</span><span class="n">font</span><span class="p">);</span>

	<span class="k">virtual</span> <span class="kt">int</span> <span class="n">getHotKey</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">setHotKey</span><span class="p">(</span><span class="k">const</span> <span class="kt">int</span> <span class="n">key</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">setHotKey</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">key</span><span class="p">);</span>

        <span class="k">virtual</span> <span class="kt">void</span> <span class="n">requestFocus</span><span class="p">();</span>

	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">addActionListener</span><span class="p">(</span><span class="n">LuaActionListener</span> <span class="o">*</span><span class="n">actionListener</span><span class="p">);</span>
        <span class="k">virtual</span> <span class="kt">void</span> <span class="n">addMouseListener</span><span class="p">(</span><span class="n">LuaActionListener</span> <span class="o">*</span><span class="n">actionListener</span><span class="p">);</span>
        <span class="k">virtual</span> <span class="kt">void</span> <span class="n">addKeyListener</span><span class="p">(</span><span class="n">LuaActionListener</span> <span class="o">*</span><span class="n">actionListener</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>class BasicContainer : public Widget</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">BasicContainer</span> <span class="o">:</span> <span class="k">public</span> <span class="n">Widget</span>
<span class="p">{</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>class ScrollArea : public BasicContainer</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ScrollArea</span> <span class="o">:</span> <span class="k">public</span> <span class="n">BasicContainer</span>
<span class="p">{</span>
	<span class="n">ScrollArea</span><span class="p">();</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">setContent</span><span class="p">(</span><span class="n">Widget</span> <span class="o">*</span><span class="n">widget</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="n">Widget</span> <span class="o">*</span><span class="n">getContent</span><span class="p">();</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">setScrollbarWidth</span><span class="p">(</span><span class="kt">int</span> <span class="n">width</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="kt">int</span> <span class="n">getScrollbarWidth</span><span class="p">();</span>
        <span class="k">virtual</span> <span class="kt">void</span> <span class="n">scrollToBottom</span><span class="p">();</span>
        <span class="k">virtual</span> <span class="kt">void</span> <span class="n">scrollToTop</span><span class="p">();</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>class ImageWidget : public Widget</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ImageWidget</span> <span class="o">:</span> <span class="k">public</span> <span class="n">Widget</span>
<span class="p">{</span>
	<span class="n">ImageWidget</span><span class="p">(</span><span class="n">CGraphic</span> <span class="o">*</span><span class="n">image</span><span class="p">);</span>
        <span class="n">ImageWidget</span><span class="p">(</span><span class="n">Mng</span> <span class="o">*</span><span class="n">image</span><span class="p">);</span>
        <span class="n">ImageWidget</span><span class="p">(</span><span class="n">Movie</span> <span class="o">*</span><span class="n">image</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>class Button : public Widget</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Button</span> <span class="o">:</span> <span class="k">public</span> <span class="n">Widget</span>
<span class="p">{</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>class ButtonWidget : public Button</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ButtonWidget</span> <span class="o">:</span> <span class="k">public</span> <span class="n">Button</span>
<span class="p">{</span>
	<span class="n">ButtonWidget</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">caption</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">setCaption</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">caption</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">getCaption</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">adjustSize</span><span class="p">();</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>class ImageButton : public Button</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ImageButton</span> <span class="o">:</span> <span class="k">public</span> <span class="n">Button</span>
<span class="p">{</span>
	<span class="n">ImageButton</span><span class="p">();</span>
	<span class="n">ImageButton</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">caption</span><span class="p">);</span>

	<span class="kt">void</span> <span class="nf">setNormalImage</span><span class="p">(</span><span class="n">CGraphic</span> <span class="o">*</span><span class="n">image</span><span class="p">);</span>
	<span class="kt">void</span> <span class="nf">setPressedImage</span><span class="p">(</span><span class="n">CGraphic</span> <span class="o">*</span><span class="n">image</span><span class="p">);</span>
	<span class="kt">void</span> <span class="nf">setDisabledImage</span><span class="p">(</span><span class="n">CGraphic</span> <span class="o">*</span><span class="n">image</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>class RadioButton : public Widget</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">RadioButton</span> <span class="o">:</span> <span class="k">public</span> <span class="n">Widget</span>
<span class="p">{</span>
	<span class="n">RadioButton</span><span class="p">();</span>
	<span class="n">RadioButton</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">caption</span><span class="p">,</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">group</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">marked</span> <span class="o">=</span> <span class="nb">false</span><span class="p">);</span>

	<span class="k">virtual</span> <span class="kt">bool</span> <span class="n">isMarked</span><span class="p">();</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">setMarked</span><span class="p">(</span><span class="kt">bool</span> <span class="n">marked</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">getCaption</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">setCaption</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">caption</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">setGroup</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">group</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">getGroup</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">adjustSize</span><span class="p">();</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>class ImageRadioButton : public RadioButton</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ImageRadioButton</span> <span class="o">:</span> <span class="k">public</span> <span class="n">RadioButton</span>
<span class="p">{</span>
	<span class="n">ImageRadioButton</span><span class="p">();</span>
	<span class="n">ImageRadioButton</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">caption</span><span class="p">,</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">group</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">marked</span> <span class="o">=</span> <span class="nb">false</span><span class="p">);</span>

	<span class="kt">void</span> <span class="nf">setUncheckedNormalImage</span><span class="p">(</span><span class="n">CGraphic</span> <span class="o">*</span><span class="n">image</span><span class="p">);</span>
	<span class="kt">void</span> <span class="nf">setUncheckedPressedImage</span><span class="p">(</span><span class="n">CGraphic</span> <span class="o">*</span><span class="n">image</span><span class="p">);</span>
	<span class="kt">void</span> <span class="nf">setUncheckedDisabledImage</span><span class="p">(</span><span class="n">CGraphic</span> <span class="o">*</span><span class="n">image</span><span class="p">);</span>
	<span class="kt">void</span> <span class="nf">setCheckedNormalImage</span><span class="p">(</span><span class="n">CGraphic</span> <span class="o">*</span><span class="n">image</span><span class="p">);</span>
	<span class="kt">void</span> <span class="nf">setCheckedPressedImage</span><span class="p">(</span><span class="n">CGraphic</span> <span class="o">*</span><span class="n">image</span><span class="p">);</span>
	<span class="kt">void</span> <span class="nf">setCheckedDisabledImage</span><span class="p">(</span><span class="n">CGraphic</span> <span class="o">*</span><span class="n">image</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>class CheckBox : public Widget</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CheckBox</span> <span class="o">:</span> <span class="k">public</span> <span class="n">Widget</span>
<span class="p">{</span>
	<span class="n">CheckBox</span><span class="p">();</span>
	<span class="n">CheckBox</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">caption</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">marked</span> <span class="o">=</span> <span class="nb">false</span><span class="p">);</span>

	<span class="k">virtual</span> <span class="kt">bool</span> <span class="n">isMarked</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">setMarked</span><span class="p">(</span><span class="kt">bool</span> <span class="n">marked</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">getCaption</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">setCaption</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">caption</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">adjustSize</span><span class="p">();</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>class ImageCheckBox : public CheckBox</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ImageCheckBox</span> <span class="o">:</span> <span class="k">public</span> <span class="n">CheckBox</span>
<span class="p">{</span>
	<span class="n">ImageCheckBox</span><span class="p">();</span>
	<span class="n">ImageCheckBox</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">caption</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">marked</span> <span class="o">=</span> <span class="nb">false</span><span class="p">);</span>

	<span class="kt">void</span> <span class="nf">setUncheckedNormalImage</span><span class="p">(</span><span class="n">CGraphic</span> <span class="o">*</span><span class="n">image</span><span class="p">);</span>
	<span class="kt">void</span> <span class="nf">setUncheckedPressedImage</span><span class="p">(</span><span class="n">CGraphic</span> <span class="o">*</span><span class="n">image</span><span class="p">);</span>
	<span class="kt">void</span> <span class="nf">setUncheckedDisabledImage</span><span class="p">(</span><span class="n">CGraphic</span> <span class="o">*</span><span class="n">image</span><span class="p">);</span>
	<span class="kt">void</span> <span class="nf">setCheckedNormalImage</span><span class="p">(</span><span class="n">CGraphic</span> <span class="o">*</span><span class="n">image</span><span class="p">);</span>
	<span class="kt">void</span> <span class="nf">setCheckedPressedImage</span><span class="p">(</span><span class="n">CGraphic</span> <span class="o">*</span><span class="n">image</span><span class="p">);</span>
	<span class="kt">void</span> <span class="nf">setCheckedDisabledImage</span><span class="p">(</span><span class="n">CGraphic</span> <span class="o">*</span><span class="n">image</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>class Slider : public Widget</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Slider</span> <span class="o">:</span> <span class="k">public</span> <span class="n">Widget</span>
<span class="p">{</span>
	<span class="n">Slider</span><span class="p">(</span><span class="kt">double</span> <span class="n">scaleEnd</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">);</span>
	<span class="n">Slider</span><span class="p">(</span><span class="kt">double</span> <span class="n">scaleStart</span><span class="p">,</span> <span class="kt">double</span> <span class="n">scaleEnd</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">setScale</span><span class="p">(</span><span class="kt">double</span> <span class="n">scaleStart</span><span class="p">,</span> <span class="kt">double</span> <span class="n">scaleEnd</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="kt">double</span> <span class="n">getScaleStart</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">setScaleStart</span><span class="p">(</span><span class="kt">double</span> <span class="n">scaleStart</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="kt">double</span> <span class="n">getScaleEnd</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">setScaleEnd</span><span class="p">(</span><span class="kt">double</span> <span class="n">scaleEnd</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="kt">double</span> <span class="n">getValue</span><span class="p">();</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">setValue</span><span class="p">(</span><span class="kt">double</span> <span class="n">value</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">setMarkerLength</span><span class="p">(</span><span class="kt">int</span> <span class="n">length</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="kt">int</span> <span class="n">getMarkerLength</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">setOrientation</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">orientation</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">getOrientation</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">setStepLength</span><span class="p">(</span><span class="kt">double</span> <span class="n">length</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="kt">double</span> <span class="n">getStepLength</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>

	<span class="k">enum</span> <span class="p">{</span> <span class="n">HORIZONTAL</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">VERTICAL</span> <span class="p">};</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>class ImageSlider : public Slider</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ImageSlider</span> <span class="o">:</span> <span class="k">public</span> <span class="n">Slider</span>
<span class="p">{</span>
	<span class="n">ImageSlider</span><span class="p">(</span><span class="kt">double</span> <span class="n">scaleEnd</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">);</span>
	<span class="n">ImageSlider</span><span class="p">(</span><span class="kt">double</span> <span class="n">scaleStart</span><span class="p">,</span> <span class="kt">double</span> <span class="n">scaleEnd</span><span class="p">);</span>
	<span class="kt">void</span> <span class="nf">setMarkerImage</span><span class="p">(</span><span class="n">CGraphic</span> <span class="o">*</span><span class="n">image</span><span class="p">);</span>
	<span class="kt">void</span> <span class="nf">setBackgroundImage</span><span class="p">(</span><span class="n">CGraphic</span> <span class="o">*</span><span class="n">image</span><span class="p">);</span>
	<span class="kt">void</span> <span class="nf">setDisabledBackgroundImage</span><span class="p">(</span><span class="n">CGraphic</span> <span class="o">*</span><span class="n">image</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>class Label : public Widget</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Label</span> <span class="o">:</span> <span class="k">public</span> <span class="n">Widget</span>
<span class="p">{</span>
	<span class="n">Label</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">caption</span><span class="p">);</span>
	<span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">getCaption</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>
	<span class="kt">void</span> <span class="nf">setCaption</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">caption</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">setAlignment</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">alignment</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">getAlignment</span><span class="p">();</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">adjustSize</span><span class="p">();</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>class MultiLineLabel : public Widget</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MultiLineLabel</span> <span class="o">:</span> <span class="k">public</span> <span class="n">Widget</span>
<span class="p">{</span>
	<span class="n">MultiLineLabel</span><span class="p">();</span>
	<span class="n">MultiLineLabel</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">caption</span><span class="p">);</span>

	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">setCaption</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">caption</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">getCaption</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">setAlignment</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">alignment</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">getAlignment</span><span class="p">();</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">setVerticalAlignment</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">alignment</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">getVerticalAlignment</span><span class="p">();</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">setLineWidth</span><span class="p">(</span><span class="kt">int</span> <span class="n">width</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="kt">int</span> <span class="n">getLineWidth</span><span class="p">();</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">adjustSize</span><span class="p">();</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">draw</span><span class="p">(</span><span class="n">gcn</span><span class="o">::</span><span class="n">Graphics</span> <span class="o">*</span><span class="n">graphics</span><span class="p">);</span>

	<span class="k">enum</span> <span class="p">{</span>
		<span class="n">LEFT</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
		<span class="n">CENTER</span><span class="p">,</span>
		<span class="n">RIGHT</span><span class="p">,</span>
		<span class="n">TOP</span><span class="p">,</span>
		<span class="n">BOTTOM</span>
	<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>class TextField : public Widget</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">TextField</span> <span class="o">:</span> <span class="k">public</span> <span class="n">Widget</span>
<span class="p">{</span>
	<span class="n">TextField</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">text</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">setText</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">text</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">getText</span><span class="p">();</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>class ImageTextField : public Widget</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ImageTextField</span> <span class="o">:</span> <span class="k">public</span> <span class="n">Widget</span>
<span class="p">{</span>
	<span class="n">ImageTextField</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">text</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">setText</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">text</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">getText</span><span class="p">();</span>
	<span class="kt">void</span> <span class="nf">setItemImage</span><span class="p">(</span><span class="n">CGraphic</span> <span class="o">*</span><span class="n">image</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>class ListBox : public Widget</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ListBox</span> <span class="o">:</span> <span class="k">public</span> <span class="n">Widget</span>
<span class="p">{</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>class ImageListBox : public ListBox</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ImageListBox</span> <span class="o">:</span> <span class="k">public</span> <span class="n">ListBox</span>
<span class="p">{</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>class ListBoxWidget : public ScrollArea</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ListBoxWidget</span> <span class="o">:</span> <span class="k">public</span> <span class="n">ScrollArea</span>
<span class="p">{</span>
	<span class="n">ListBoxWidget</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">width</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">height</span><span class="p">);</span>
	<span class="kt">void</span> <span class="nf">setList</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">lua</span><span class="p">,</span> <span class="n">lua_Object</span> <span class="o">*</span><span class="n">lo</span><span class="p">);</span>
	<span class="kt">void</span> <span class="nf">setSelected</span> <span class="p">(</span><span class="kt">int</span> <span class="n">selected</span><span class="p">);</span>
	<span class="kt">int</span> <span class="nf">getSelected</span><span class="p">();</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>class ImageListBoxWidget : public ListBoxWidget</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ImageListBoxWidget</span> <span class="o">:</span> <span class="k">public</span> <span class="n">ListBoxWidget</span>
<span class="p">{</span>
	<span class="n">ImageListBoxWidget</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">width</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">height</span><span class="p">);</span>
	<span class="kt">void</span> <span class="nf">setList</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">lua</span><span class="p">,</span> <span class="n">lua_Object</span> <span class="o">*</span><span class="n">lo</span><span class="p">);</span>
	<span class="kt">void</span> <span class="nf">setSelected</span> <span class="p">(</span><span class="kt">int</span> <span class="n">selected</span><span class="p">);</span>
	<span class="kt">int</span> <span class="nf">getSelected</span><span class="p">();</span>
	<span class="kt">void</span> <span class="nf">setItemImage</span><span class="p">(</span><span class="n">CGraphic</span> <span class="o">*</span><span class="n">image</span><span class="p">);</span>
	<span class="kt">void</span> <span class="nf">setUpButtonImage</span><span class="p">(</span><span class="n">CGraphic</span> <span class="o">*</span><span class="n">image</span><span class="p">);</span>
	<span class="kt">void</span> <span class="nf">setUpPressedButtonImage</span><span class="p">(</span><span class="n">CGraphic</span> <span class="o">*</span><span class="n">image</span><span class="p">);</span>
	<span class="kt">void</span> <span class="nf">setDownButtonImage</span><span class="p">(</span><span class="n">CGraphic</span> <span class="o">*</span><span class="n">image</span><span class="p">);</span>
	<span class="kt">void</span> <span class="nf">setDownPressedButtonImage</span><span class="p">(</span><span class="n">CGraphic</span> <span class="o">*</span><span class="n">image</span><span class="p">);</span>
	<span class="kt">void</span> <span class="nf">setLeftButtonImage</span><span class="p">(</span><span class="n">CGraphic</span> <span class="o">*</span><span class="n">image</span><span class="p">);</span>
	<span class="kt">void</span> <span class="nf">setLeftPressedButtonImage</span><span class="p">(</span><span class="n">CGraphic</span> <span class="o">*</span><span class="n">image</span><span class="p">);</span>
	<span class="kt">void</span> <span class="nf">setRightButtonImage</span><span class="p">(</span><span class="n">CGraphic</span> <span class="o">*</span><span class="n">image</span><span class="p">);</span>
	<span class="kt">void</span> <span class="nf">setRightPressedButtonImage</span><span class="p">(</span><span class="n">CGraphic</span> <span class="o">*</span><span class="n">image</span><span class="p">);</span>
	<span class="kt">void</span> <span class="nf">setHBarImage</span><span class="p">(</span><span class="n">CGraphic</span> <span class="o">*</span><span class="n">image</span><span class="p">);</span>
	<span class="kt">void</span> <span class="nf">setVBarImage</span><span class="p">(</span><span class="n">CGraphic</span> <span class="o">*</span><span class="n">image</span><span class="p">);</span>
	<span class="kt">void</span> <span class="nf">setMarkerImage</span><span class="p">(</span><span class="n">CGraphic</span> <span class="o">*</span><span class="n">image</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>class Window : public BasicContainer</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Window</span> <span class="o">:</span> <span class="k">public</span> <span class="n">BasicContainer</span>
<span class="p">{</span>
	<span class="n">Window</span><span class="p">();</span>
	<span class="n">Window</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">caption</span><span class="p">);</span>
	<span class="n">Window</span><span class="p">(</span><span class="n">Widget</span> <span class="o">*</span><span class="n">content</span><span class="p">,</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">caption</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">);</span>

	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">setCaption</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">caption</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">getCaption</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">setAlignment</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">alignment</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">getAlignment</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">setContent</span><span class="p">(</span><span class="n">Widget</span><span class="o">*</span> <span class="n">widget</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="n">Widget</span><span class="o">*</span> <span class="n">getContent</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">setPadding</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">padding</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">getPadding</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">setTitleBarHeight</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">height</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">getTitleBarHeight</span><span class="p">();</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">setMovable</span><span class="p">(</span><span class="kt">bool</span> <span class="n">movable</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="kt">bool</span> <span class="n">isMovable</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">resizeToContent</span><span class="p">();</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">setOpaque</span><span class="p">(</span><span class="kt">bool</span> <span class="n">opaque</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="kt">bool</span> <span class="n">isOpaque</span><span class="p">();</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>class Windows : public Window</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Windows</span> <span class="o">:</span> <span class="k">public</span> <span class="n">Window</span>
<span class="p">{</span>
	<span class="n">Windows</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">text</span><span class="p">,</span> <span class="kt">int</span> <span class="n">width</span><span class="p">,</span> <span class="kt">int</span> <span class="n">height</span><span class="p">);</span>
	<span class="kt">void</span> <span class="nf">add</span><span class="p">(</span><span class="n">Widget</span> <span class="o">*</span><span class="n">widget</span><span class="p">,</span> <span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>class ScrollingWidget : public ScrollArea</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ScrollingWidget</span> <span class="o">:</span> <span class="k">public</span> <span class="n">ScrollArea</span>
<span class="p">{</span>
	<span class="n">ScrollingWidget</span><span class="p">(</span><span class="kt">int</span> <span class="n">width</span><span class="p">,</span> <span class="kt">int</span> <span class="n">height</span><span class="p">);</span>
	<span class="kt">void</span> <span class="nf">add</span><span class="p">(</span><span class="n">Widget</span> <span class="o">*</span><span class="n">widget</span><span class="p">,</span> <span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">);</span>
	<span class="kt">void</span> <span class="nf">restart</span><span class="p">();</span>
	<span class="kt">void</span> <span class="nf">setSpeed</span><span class="p">(</span><span class="kt">float</span> <span class="n">speed</span><span class="p">);</span>
	<span class="kt">float</span> <span class="nf">getSpeed</span><span class="p">();</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>class DropDown : public BasicContainer</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">DropDown</span> <span class="o">:</span> <span class="k">public</span> <span class="n">BasicContainer</span>
<span class="p">{</span>
	<span class="k">virtual</span> <span class="kt">int</span> <span class="n">getSelected</span><span class="p">();</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">setSelected</span><span class="p">(</span><span class="kt">int</span> <span class="n">selected</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">setScrollArea</span><span class="p">(</span><span class="n">ScrollArea</span><span class="o">*</span> <span class="n">scrollArea</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="n">ScrollArea</span> <span class="o">*</span><span class="n">getScrollArea</span><span class="p">();</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">setListBox</span><span class="p">(</span><span class="n">ListBox</span><span class="o">*</span> <span class="n">listBox</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="n">ListBox</span> <span class="o">*</span><span class="n">getListBox</span><span class="p">();</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>class DropDownWidget : public DropDown</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">DropDownWidget</span> <span class="o">:</span> <span class="k">public</span> <span class="n">DropDown</span>
<span class="p">{</span>
	<span class="n">DropDownWidget</span><span class="p">();</span>
	<span class="kt">void</span> <span class="nf">setList</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">lua</span><span class="p">,</span> <span class="n">lua_Object</span> <span class="o">*</span><span class="n">lo</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="n">ListBox</span> <span class="o">*</span><span class="n">getListBox</span><span class="p">();</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">setSize</span><span class="p">(</span><span class="kt">int</span> <span class="n">width</span><span class="p">,</span> <span class="kt">int</span> <span class="n">height</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>class ImageDropDownWidget : public DropDown</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ImageDropDownWidget</span> <span class="o">:</span> <span class="k">public</span> <span class="n">DropDown</span>
<span class="p">{</span>
	<span class="n">ImageDropDownWidget</span><span class="p">();</span>
	<span class="kt">void</span> <span class="nf">setList</span><span class="p">(</span><span class="n">lua_State</span> <span class="o">*</span><span class="n">lua</span><span class="p">,</span> <span class="n">lua_Object</span> <span class="o">*</span><span class="n">lo</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="n">ListBox</span> <span class="o">*</span><span class="n">getListBox</span><span class="p">();</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">setSize</span><span class="p">(</span><span class="kt">int</span> <span class="n">width</span><span class="p">,</span> <span class="kt">int</span> <span class="n">height</span><span class="p">);</span>
	<span class="kt">void</span> <span class="nf">setItemImage</span><span class="p">(</span><span class="n">CGraphic</span> <span class="o">*</span><span class="n">image</span><span class="p">);</span>
	<span class="kt">void</span> <span class="nf">setDownNormalImage</span><span class="p">(</span><span class="n">CGraphic</span> <span class="o">*</span><span class="n">image</span><span class="p">);</span>
	<span class="kt">void</span> <span class="nf">setDownPressedImage</span><span class="p">(</span><span class="n">CGraphic</span> <span class="o">*</span><span class="n">image</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>class StatBoxWidget : public Widget</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">StatBoxWidget</span> <span class="o">:</span> <span class="k">public</span> <span class="n">Widget</span>
<span class="p">{</span>
	<span class="n">StatBoxWidget</span><span class="p">(</span><span class="kt">int</span> <span class="n">width</span><span class="p">,</span> <span class="kt">int</span> <span class="n">height</span><span class="p">);</span>

	<span class="kt">void</span> <span class="nf">setCaption</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">s</span><span class="p">);</span>
	<span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">getCaption</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>
	<span class="kt">void</span> <span class="nf">setPercent</span><span class="p">(</span><span class="k">const</span> <span class="kt">int</span> <span class="n">percent</span><span class="p">);</span>
	<span class="kt">int</span> <span class="nf">getPercent</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>class Container : public BasicContainer</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Container</span> <span class="o">:</span> <span class="k">public</span> <span class="n">BasicContainer</span>
<span class="p">{</span>
	<span class="n">Container</span><span class="p">();</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">setOpaque</span><span class="p">(</span><span class="kt">bool</span> <span class="n">opaque</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="kt">bool</span> <span class="n">isOpaque</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">add</span><span class="p">(</span><span class="n">Widget</span> <span class="o">*</span><span class="n">widget</span><span class="p">,</span> <span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">remove</span><span class="p">(</span><span class="n">Widget</span> <span class="o">*</span><span class="n">widget</span><span class="p">);</span>
	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">clear</span><span class="p">();</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>class MenuScreen : public Container</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MenuScreen</span> <span class="o">:</span> <span class="k">public</span> <span class="n">Container</span>
<span class="p">{</span>
	<span class="n">MenuScreen</span><span class="p">();</span>

	<span class="kt">int</span> <span class="nf">run</span><span class="p">(</span><span class="kt">bool</span> <span class="n">loop</span> <span class="o">=</span> <span class="nb">true</span><span class="p">);</span>
	<span class="kt">void</span> <span class="nf">stop</span><span class="p">(</span><span class="kt">int</span> <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">);</span>
	<span class="kt">void</span> <span class="nf">stopAll</span><span class="p">(</span><span class="kt">int</span> <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">);</span>
	<span class="kt">void</span> <span class="nf">addLogicCallback</span><span class="p">(</span><span class="n">LuaActionListener</span> <span class="o">*</span><span class="n">actionListener</span><span class="p">);</span>
	<span class="kt">void</span> <span class="nf">setDrawMenusUnder</span><span class="p">(</span><span class="kt">bool</span> <span class="n">drawunder</span><span class="p">);</span>
	<span class="kt">bool</span> <span class="nf">getDrawMenusUnder</span><span class="p">();</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>CycleViewportMode(int step)</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>SetNewViewportMode(ViewportModeType new_mode)</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>SetDefaultTextColors(const std::string &normal, const std::string &reverse)</summary>
                    <p></p>
                    </details>
                    <hr>/tolua/unit.pkg<hr>
                    <details>
                    <summary>class Vec2i</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Vec2i</span>
<span class="p">{</span>
	<span class="kt">short</span> <span class="kt">int</span> <span class="n">x</span><span class="p">;</span>
	<span class="kt">short</span> <span class="kt">int</span> <span class="n">y</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>class CUnit</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CUnit</span>
<span class="p">{</span>
	<span class="n">tolua_readonly</span> <span class="n">Vec2i</span> <span class="n">tilePos</span><span class="p">;</span>

	<span class="n">tolua_readonly</span> <span class="n">CUnitType</span> <span class="o">*</span><span class="n">Type</span><span class="p">;</span>
	<span class="n">tolua_readonly</span> <span class="n">CPlayer</span> <span class="o">*</span><span class="n">Player</span><span class="p">;</span>
	<span class="n">CUnit</span> <span class="o">*</span><span class="n">Goal</span><span class="p">;</span>
	<span class="kt">bool</span> <span class="n">Active</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">ResourcesHeld</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>class CPreference</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CPreference</span>
<span class="p">{</span>
	<span class="kt">bool</span> <span class="n">ShowSightRange</span><span class="p">;</span>
	<span class="kt">bool</span> <span class="n">ShowReactionRange</span><span class="p">;</span>
	<span class="kt">bool</span> <span class="n">ShowAttackRange</span><span class="p">;</span>
	<span class="kt">bool</span> <span class="n">ShowMessages</span><span class="p">;</span>
	<span class="kt">bool</span> <span class="n">BigScreen</span><span class="p">;</span>
	<span class="kt">bool</span> <span class="n">PauseOnLeave</span><span class="p">;</span>
	<span class="kt">bool</span> <span class="n">AiExplores</span><span class="p">;</span>
	<span class="kt">bool</span> <span class="n">GrayscaleIcons</span><span class="p">;</span>
	<span class="kt">bool</span> <span class="n">IconsShift</span><span class="p">;</span>
	<span class="kt">bool</span> <span class="n">StereoSound</span><span class="p">;</span>
	<span class="kt">bool</span> <span class="n">MineNotifications</span><span class="p">;</span>
	<span class="kt">bool</span> <span class="n">DeselectInMine</span><span class="p">;</span>
	<span class="kt">bool</span> <span class="n">NoStatusLineTooltips</span><span class="p">;</span>
	<span class="kt">bool</span> <span class="n">SimplifiedAutoTargeting</span><span class="p">;</span>
	<span class="kt">bool</span> <span class="n">AiChecksDependencies</span><span class="p">;</span>

	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">ShowOrders</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">ShowNameDelay</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">ShowNameTime</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">AutosaveMinutes</span><span class="p">;</span>

	<span class="n">CGraphic</span> <span class="o">*</span><span class="n">IconFrameG</span><span class="p">;</span>
	<span class="n">CGraphic</span> <span class="o">*</span><span class="n">PressedIconFrameG</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>class CUnitManager</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CUnitManager</span>
<span class="p">{</span>
	<span class="n">CUnit</span> <span class="o">&amp;</span><span class="nf">GetSlotUnit</span><span class="p">(</span><span class="kt">int</span> <span class="n">index</span><span class="p">)</span> <span class="k">const</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>CUnitManager UnitManager</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>CPreference Preference</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>int UnitNumber(CUnit &unit)</summary>
                    <p></p>
                    </details>
                    <hr>/tolua/map.pkg<hr>
                    <details>
                    <summary>class CMapInfo</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CMapInfo</span>
<span class="p">{</span>
	<span class="n">string</span> <span class="n">Description</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">MapWidth</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">MapHeight</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">PlayerType</span><span class="p">[</span><span class="n">PlayerMax</span><span class="p">];</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>class CTileset</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CTileset</span>
<span class="p">{</span>
	<span class="n">string</span> <span class="n">Name</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>class CMap</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CMap</span>
<span class="p">{</span>
	<span class="n">CMapInfo</span> <span class="n">Info</span><span class="p">;</span>
	<span class="n">CTileset</span> <span class="o">*</span><span class="n">Tileset</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>CMap Map</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>SetTile(int tile, int w, int h, int value = 0)</summary>
                    <p></p>
                    </details>
                    <hr>/tolua/player.pkg<hr>
                    <details>
                    <summary>enum PlayerTypes {</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">enum</span> <span class="nc">PlayerTypes</span> <span class="p">{</span>
	<span class="n">PlayerNeutral</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">PlayerNobody</span>  <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
	<span class="n">PlayerComputer</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
	<span class="n">PlayerPerson</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
	<span class="n">PlayerRescuePassive</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
	<span class="n">PlayerRescueActive</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>class CPlayer</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CPlayer</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">Index</span><span class="p">;</span>
	<span class="n">string</span> <span class="n">Name</span><span class="p">;</span>

	<span class="kt">int</span> <span class="n">Type</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">Race</span><span class="p">;</span>
	<span class="n">string</span> <span class="n">AiName</span><span class="p">;</span>

	<span class="n">Vec2i</span> <span class="n">StartPos</span><span class="p">;</span>

	<span class="kt">void</span> <span class="nf">SetStartView</span><span class="p">(</span><span class="k">const</span> <span class="n">Vec2i</span> <span class="o">&amp;</span><span class="n">pos</span><span class="p">);</span>

	<span class="kt">int</span> <span class="n">Resources</span><span class="p">[</span><span class="n">MaxCosts</span><span class="p">];</span>
	<span class="kt">int</span> <span class="n">StoredResources</span><span class="p">[</span><span class="n">MaxCosts</span><span class="p">];</span>
	<span class="kt">int</span> <span class="n">Incomes</span><span class="p">[</span><span class="n">MaxCosts</span><span class="p">];</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">Revenue</span><span class="p">[</span><span class="n">MaxCosts</span><span class="p">];</span>

	<span class="k">const</span> <span class="kt">int</span> <span class="n">UnitTypesCount</span><span class="p">[</span><span class="n">UnitTypeMax</span><span class="p">];</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">UnitTypesAiActiveCount</span><span class="p">[</span><span class="n">UnitTypeMax</span><span class="p">];</span>
	<span class="kt">bool</span> <span class="n">AiEnabled</span><span class="p">;</span>

	<span class="kt">int</span> <span class="n">NumBuildings</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">Supply</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">Demand</span><span class="p">;</span>

	<span class="kt">int</span> <span class="n">UnitLimit</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">BuildingLimit</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">TotalUnitLimit</span><span class="p">;</span>

	<span class="kt">int</span> <span class="n">Score</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">TotalUnits</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">TotalBuildings</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">TotalResources</span><span class="p">[</span><span class="n">MaxCosts</span><span class="p">];</span>
	<span class="kt">int</span> <span class="n">TotalRazings</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">TotalKills</span><span class="p">;</span>

	<span class="kt">int</span> <span class="n">SpeedResourcesHarvest</span><span class="p">[</span><span class="n">MaxCosts</span><span class="p">];</span>
	<span class="kt">int</span> <span class="n">SpeedResourcesReturn</span><span class="p">[</span><span class="n">MaxCosts</span><span class="p">];</span>
	<span class="kt">int</span> <span class="n">SpeedBuild</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">SpeedTrain</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">SpeedUpgrade</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">SpeedResearch</span><span class="p">;</span>

	<span class="n">CUnit</span><span class="o">&amp;</span> <span class="nf">GetUnit</span><span class="p">(</span><span class="kt">int</span> <span class="n">index</span><span class="p">)</span> <span class="k">const</span><span class="p">;</span>
	<span class="kt">int</span> <span class="nf">GetUnitCount</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>

	<span class="kt">bool</span> <span class="nf">IsEnemy</span><span class="p">(</span><span class="k">const</span> <span class="n">CPlayer</span> <span class="o">&amp;</span><span class="n">player</span><span class="p">)</span> <span class="k">const</span><span class="p">;</span>
	<span class="kt">bool</span> <span class="nf">IsEnemy</span><span class="p">(</span><span class="k">const</span> <span class="n">CUnit</span> <span class="o">&amp;</span><span class="n">unit</span><span class="p">)</span> <span class="k">const</span><span class="p">;</span>
	<span class="kt">bool</span> <span class="nf">IsAllied</span><span class="p">(</span><span class="k">const</span> <span class="n">CPlayer</span> <span class="o">&amp;</span><span class="n">player</span><span class="p">)</span> <span class="k">const</span><span class="p">;</span>
	<span class="kt">bool</span> <span class="nf">IsAllied</span><span class="p">(</span><span class="k">const</span> <span class="n">CUnit</span> <span class="o">&amp;</span><span class="n">unit</span><span class="p">)</span> <span class="k">const</span><span class="p">;</span>
	<span class="kt">bool</span> <span class="nf">HasSharedVisionWith</span><span class="p">(</span><span class="k">const</span> <span class="n">CPlayer</span> <span class="o">&amp;</span><span class="n">player</span><span class="p">)</span> <span class="k">const</span><span class="p">;</span>
	<span class="kt">bool</span> <span class="nf">HasSharedVisionWith</span><span class="p">(</span><span class="k">const</span> <span class="n">CUnit</span> <span class="o">&amp;</span><span class="n">unit</span><span class="p">)</span> <span class="k">const</span><span class="p">;</span>
	<span class="kt">bool</span> <span class="nf">HasMutualSharedVisionWith</span><span class="p">(</span><span class="k">const</span> <span class="n">CPlayer</span> <span class="o">&amp;</span><span class="n">player</span><span class="p">)</span> <span class="k">const</span><span class="p">;</span>
	<span class="kt">bool</span> <span class="nf">HasMutualSharedVisionWith</span><span class="p">(</span><span class="k">const</span> <span class="n">CUnit</span> <span class="o">&amp;</span><span class="n">unit</span><span class="p">)</span> <span class="k">const</span><span class="p">;</span>
	<span class="kt">bool</span> <span class="nf">IsTeamed</span><span class="p">(</span><span class="k">const</span> <span class="n">CPlayer</span> <span class="o">&amp;</span><span class="n">player</span><span class="p">)</span> <span class="k">const</span><span class="p">;</span>
	<span class="kt">bool</span> <span class="nf">IsTeamed</span><span class="p">(</span><span class="k">const</span> <span class="n">CUnit</span> <span class="o">&amp;</span><span class="n">unit</span><span class="p">)</span> <span class="k">const</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>CPlayer Players[PlayerMax]</summary>
                    <p></p>
                    </details>
                    
                    <details>
                    <summary>CPlayer *ThisPlayer</summary>
                    <p></p>
                    </details>
                    <hr>/tolua/font.pkg<hr>
                    <details>
                    <summary>class CFont</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CFont</span>
<span class="p">{</span>
	<span class="k">static</span> <span class="n">CFont</span> <span class="o">*</span><span class="n">New</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">ident</span><span class="p">,</span> <span class="n">CGraphic</span> <span class="o">*</span><span class="n">g</span><span class="p">);</span>
	<span class="k">static</span> <span class="n">CFont</span> <span class="o">*</span><span class="n">Get</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">ident</span><span class="p">);</span>

	<span class="kt">int</span> <span class="nf">Height</span><span class="p">();</span>
	<span class="kt">int</span> <span class="nf">Width</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">text</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
                    <details>
                    <summary>class CFontColor</summary>
                    <p></p>
                    <p><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CFontColor</span>
<span class="p">{</span>
	<span class="k">static</span> <span class="n">CFontColor</span> <span class="o">*</span><span class="n">New</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">ident</span><span class="p">);</span>
	<span class="k">static</span> <span class="n">CFontColor</span> <span class="o">*</span><span class="n">Get</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">ident</span><span class="p">);</span>

	<span class="n">CColor</span> <span class="n">Colors</span><span class="p">[</span><span class="n">MaxFontColors</span><span class="p">];</span>
<span class="p">};</span>
</pre></div>
</p>
                    </details>
                    
        </body>
        </html>
        